(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))i(u);new MutationObserver(u=>{for(const o of u)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(u){const o={};return u.integrity&&(o.integrity=u.integrity),u.referrerPolicy&&(o.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?o.credentials="include":u.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(u){if(u.ep)return;u.ep=!0;const o=n(u);fetch(u.href,o)}})();var xr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Xl(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var n=function i(){var u=!1;try{u=this instanceof i}catch{}return u?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(i){var u=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(n,i,u.get?u:{enumerable:!0,get:function(){return e[i]}})}),n}var ii,sf;function Wl(){if(sf)return ii;sf=1,ii=e;function e(t,n){if(t)try{var i=document.querySelector(t);i&&i.scrollIntoView(n)}catch{}}return ii}var ui,df;function Yl(){if(df)return ui;df=1,ui=e;function e(t){if(typeof document>"u")throw new Error("document-ready only runs in the browser");var n=document.readyState;if(n==="complete"||n==="interactive")return setTimeout(t,0);document.addEventListener("DOMContentLoaded",function(){t()})}return ui}var oi,cf;function qt(){if(cf)return oi;cf=1,i.notEqual=t,i.notOk=n,i.equal=e,i.ok=i,oi=i;function e(u,o,c){i(u==o,c)}function t(u,o,c){i(u!=o,c)}function n(u,o){i(!u,o)}function i(u,o){if(!u)throw new Error(o||"AssertionError")}return oi}var fi,lf;function Kl(){if(lf)return fi;lf=1;var e=qt(),t=typeof window<"u";function n(){var u;return t?(window._nanoScheduler||(window._nanoScheduler=new i(!0)),u=window._nanoScheduler):u=new i,u}function i(u){this.hasWindow=u,this.hasIdle=this.hasWindow&&window.requestIdleCallback,this.method=this.hasIdle?window.requestIdleCallback.bind(window):this.setTimeout,this.scheduled=!1,this.queue=[]}return i.prototype.push=function(u){e.equal(typeof u,"function","nanoscheduler.push: cb should be type function"),this.queue.push(u),this.schedule()},i.prototype.schedule=function(){if(!this.scheduled){this.scheduled=!0;var u=this;this.method(function(o){for(var c;u.queue.length&&o.timeRemaining()>0;)c=u.queue.shift(),c(o);u.scheduled=!1,u.queue.length&&u.schedule()})}},i.prototype.setTimeout=function(u){setTimeout(u,0,{timeRemaining:function(){return 1}})},fi=n,fi}var si,hf;function Ji(){if(hf)return si;hf=1;var e=Kl()(),t=qt(),n;i.disabled=!0;try{n=window.performance,i.disabled=window.localStorage.DISABLE_NANOTIMING==="true"||!n.mark}catch{}si=i;function i(o){if(t.equal(typeof o,"string","nanotiming: name should be type string"),i.disabled)return u;var c=(n.now()*1e4).toFixed()%Number.MAX_SAFE_INTEGER,g="start-"+c+"-"+o;n.mark(g);function S(b){var G="end-"+c+"-"+o;n.mark(G),e.push(function(){var k=null;try{var R=o+" ["+c+"]";n.measure(R,g,G),n.clearMarks(g),n.clearMarks(G)}catch(A){k=A}b&&b(k,o)})}return S.uuid=c,S}function u(o){o&&e.push(function(){o(new Error("nanotiming: performance API unavailable"))})}return si}var di,mf;function Ql(){if(mf)return di;mf=1;var e=qt();di=t;function t(){if(!(this instanceof t))return new t;this.trie={nodes:{}}}t.prototype.create=function(i){e.equal(typeof i,"string","route should be a string");var u=i.replace(/^\//,"").split("/");function o(c,g){var S=n(u,c)&&u[c];if(S===!1)return g;var b=null;return/^:|^\*/.test(S)?(n(g.nodes,"$$")?b=g.nodes.$$:(b={nodes:{}},g.nodes.$$=b),S[0]==="*"&&(g.wildcard=!0),g.name=S.replace(/^:|^\*/,"")):n(g.nodes,S)?b=g.nodes[S]:(b={nodes:{}},g.nodes[S]=b),o(c+1,b)}return o(0,this.trie)},t.prototype.match=function(i){e.equal(typeof i,"string","route should be a string");var u=i.replace(/^\//,"").split("/"),o={};function c(S,b){if(b!==void 0){var G=u[S];if(G===void 0)return b;if(n(b.nodes,G))return c(S+1,b.nodes[G]);if(b.name){try{o[b.name]=decodeURIComponent(G)}catch{return c(S,void 0)}return c(S+1,b.nodes.$$)}else if(b.wildcard){try{o.wildcard=decodeURIComponent(u.slice(S).join("/"))}catch{return c(S,void 0)}return b.nodes.$$}else return c(S+1)}}var g=c(0,this.trie);if(g)return g=Object.assign({},g),g.params=o,g},t.prototype.mount=function(i,u){e.equal(typeof i,"string","route should be a string"),e.equal(typeof u,"object","trie should be a object");var o=i.replace(/^\//,"").split("/"),c=null,g=null;if(o.length===1)g=o[0],c=this.create(g);else{var S=o.join("/");g=o[0],c=this.create(S)}Object.assign(c.nodes,u.nodes),u.name&&(c.name=u.name),c.nodes[""]&&(Object.keys(c.nodes[""]).forEach(function(b){b!=="nodes"&&(c[b]=c.nodes[""][b])}),Object.assign(c.nodes,c.nodes[""].nodes),delete c.nodes[""].nodes)};function n(i,u){return Object.prototype.hasOwnProperty.call(i,u)}return di}var ci,pf;function Zl(){if(pf)return ci;pf=1;var e=qt(),t=Ql();ci=n;function n(i){if(!(this instanceof n))return new n(i);var u=(i||"").replace(/^\//,""),o=t();return g._trie=o,g.on=c,g.emit=g,g.match=S,g._wayfarer=!0,g;function c(G,k){if(e.equal(typeof G,"string"),e.equal(typeof k,"function"),G=G||"/",k._wayfarer&&k._trie)o.mount(G,k._trie.trie);else{var R=o.create(G);R.cb=k,R.route=G}return g}function g(G){var k=S(G),R=new Array(arguments.length);R[0]=k.params;for(var A=1;A<R.length;A++)R[A]=arguments[A];return k.cb.apply(k.cb,R)}function S(G){e.notEqual(G,void 0,"'route' must be defined");var k=o.match(G);if(k&&k.cb)return new b(k);var R=o.match(u);if(R&&R.cb)return new b(R);throw new Error("route '"+G+"' did not match")}function b(G){this.cb=G.cb,this.route=G.route,this.params=G.params}}return ci}var li,vf;function Jl(){if(vf)return li;vf=1;var e=qt(),t=Zl(),n=/file:\/\//.test(typeof window=="object"&&window.location&&window.location.origin),i="^(file://|/)(.*.html?/?)?",u="^(http(s)?(://))?(www.)?",o="[a-zA-Z0-9-_.]+(:[0-9]{1,5})?(/{1})?",c="[?].*$",g=new RegExp(i),S=new RegExp(u+o),b=new RegExp("#"),G=new RegExp(c);li=k;function k(A){if(!(this instanceof k))return new k(A);A=A||{},this.router=t(A.default||"/404")}k.prototype.on=function(A,O){e.equal(typeof A,"string"),A=A.replace(/^[#/]/,""),this.router.on(A,O)},k.prototype.emit=function(A){return e.equal(typeof A,"string"),A=R(A,n),this.router.emit(A)},k.prototype.match=function(A){return e.equal(typeof A,"string"),A=R(A,n),this.router.match(A)};function R(A,O){return O?A=A.replace(g,""):A=A.replace(S,""),decodeURI(A.replace(G,"").replace(b,"/"))}return li}var hi,bf;function eh(){return bf||(bf=1,hi=["onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmousemove","onmouseout","onmouseenter","onmouseleave","ontouchcancel","ontouchend","ontouchmove","ontouchstart","ondragstart","ondrag","ondragenter","ondragleave","ondragover","ondrop","ondragend","onkeydown","onkeypress","onkeyup","onunload","onabort","onerror","onresize","onscroll","onselect","onchange","onsubmit","onreset","onfocus","onblur","oninput","onanimationend","onanimationiteration","onanimationstart","oncontextmenu","onfocusin","onfocusout"]),hi}var mi,yf;function th(){if(yf)return mi;yf=1;var e=eh(),t=e.length,n=1,i=3,u=8;mi=o;function o(R,A){var O=R.nodeType,q=R.nodeName;O===n&&c(R,A),(O===i||O===u)&&A.nodeValue!==R.nodeValue&&(A.nodeValue=R.nodeValue),q==="INPUT"?b(R,A):q==="OPTION"?S(R,A):q==="TEXTAREA"&&G(R,A),g(R,A)}function c(R,A){for(var O=A.attributes,q=R.attributes,ne=null,_e=null,me=null,Ee=null,Ve=null,rt=q.length-1;rt>=0;--rt)Ve=q[rt],Ee=Ve.name,ne=Ve.namespaceURI,_e=Ve.value,ne?(Ee=Ve.localName||Ee,me=A.getAttributeNS(ne,Ee),me!==_e&&A.setAttributeNS(ne,Ee,_e)):A.hasAttribute(Ee)?(me=A.getAttribute(Ee),me!==_e&&(_e==="null"||_e==="undefined"?A.removeAttribute(Ee):A.setAttribute(Ee,_e))):A.setAttribute(Ee,_e);for(var P=O.length-1;P>=0;--P)Ve=O[P],Ve.specified!==!1&&(Ee=Ve.name,ne=Ve.namespaceURI,ne?(Ee=Ve.localName||Ee,R.hasAttributeNS(ne,Ee)||A.removeAttributeNS(ne,Ee)):R.hasAttributeNS(null,Ee)||A.removeAttribute(Ee))}function g(R,A){for(var O=0;O<t;O++){var q=e[O];R[q]?A[q]=R[q]:A[q]&&(A[q]=void 0)}}function S(R,A){k(R,A,"selected")}function b(R,A){var O=R.value,q=A.value;k(R,A,"checked"),k(R,A,"disabled"),R.indeterminate!==A.indeterminate&&(A.indeterminate=R.indeterminate),A.type!=="file"&&(O!==q&&(A.setAttribute("value",O),A.value=O),O==="null"&&(A.value="",A.removeAttribute("value")),R.hasAttributeNS(null,"value")?A.type==="range"&&(A.value=O):A.removeAttribute("value"))}function G(R,A){var O=R.value;if(O!==A.value&&(A.value=O),A.firstChild&&A.firstChild.nodeValue!==O){if(O===""&&A.firstChild.nodeValue===A.placeholder)return;A.firstChild.nodeValue=O}}function k(R,A,O){R[O]!==A[O]&&(A[O]=R[O],R[O]?A.setAttribute(O,""):A.removeAttribute(O))}return mi}var pi,gf;function cs(){if(gf)return pi;gf=1;var e=qt(),t=th(),n=3;pi=i;function i(S,b,G){return e.equal(typeof S,"object","nanomorph: oldTree should be an object"),e.equal(typeof b,"object","nanomorph: newTree should be an object"),G&&G.childrenOnly?(c(b,S),S):(e.notEqual(b.nodeType,11,"nanomorph: newTree should have one root node (which is not a DocumentFragment)"),u(b,S))}function u(S,b){return b?S?S.isSameNode&&S.isSameNode(b)?b:S.tagName!==b.tagName||o(S)!==o(b)?S:(t(S,b),c(S,b),b):null:S}function o(S){return S.dataset?S.dataset.nanomorphComponentId:void 0}function c(S,b){for(var G,k,R,A,O=0,q=0;G=b.childNodes[q],k=S.childNodes[q-O],!(!G&&!k);q++)if(!k)b.removeChild(G),q--;else if(!G)b.appendChild(k),O++;else if(g(k,G))R=u(k,G),R!==G&&(b.replaceChild(R,G),O++);else{A=null;for(var ne=q;ne<b.childNodes.length;ne++)if(g(b.childNodes[ne],k)){A=b.childNodes[ne];break}A?(R=u(k,A),R!==A&&O++,b.insertBefore(R,G)):!k.id&&!G.id?(R=u(k,G),R!==G&&(b.replaceChild(R,G),O++)):(b.insertBefore(k,G),O++)}}function g(S,b){return S.id?S.id===b.id:S.isSameNode?S.isSameNode(b):S.tagName!==b.tagName?!1:S.type===n?S.nodeValue===b.nodeValue:!1}return pi}var vi,_f;function rh(){if(_f)return vi;_f=1;var e=/([^?=&]+)(=([^&]*))?/g,t=qt();vi=n;function n(i){t.equal(typeof i,"string","nanoquery: url should be type string");var u={};return i.replace(/^.*\?/,"").replace(e,function(o,c,g,S){var b=decodeURIComponent(S),G=decodeURIComponent(c);u.hasOwnProperty(G)?Array.isArray(u[G])?u[G].push(b):u[G]=[u[G],b]:u[G]=b}),u}return vi}var bi,xf;function nh(){if(xf)return bi;xf=1;var e=qt(),t=/(noopener|noreferrer) (noopener|noreferrer)/,n=/^[\w-_]+:/;bi=i;function i(u,o){e.notEqual(typeof window,"undefined","nanohref: expected window to exist"),o=o||window.document,e.equal(typeof u,"function","nanohref: cb should be type function"),e.equal(typeof o,"object","nanohref: root should be type object"),window.addEventListener("click",function(c){if(!(c.button&&c.button!==0||c.ctrlKey||c.metaKey||c.altKey||c.shiftKey||c.defaultPrevented)){var g=function S(b){if(!(!b||b===o))return b.localName!=="a"||b.href===void 0?S(b.parentNode):b}(c.target);g&&(window.location.protocol!==g.protocol||window.location.hostname!==g.hostname||window.location.port!==g.port||g.hasAttribute("data-nanohref-ignore")||g.hasAttribute("download")||g.getAttribute("target")==="_blank"&&t.test(g.getAttribute("rel"))||n.test(g.getAttribute("href"))||(c.preventDefault(),u(g)))}})}return bi}var yi,wf;function ah(){if(wf)return yi;wf=1;var e=qt();yi=t;function t(n,i){e.equal(typeof n,"function","nanoraf: render should be a function"),e.ok(typeof i=="function"||typeof i>"u","nanoraf: raf should be a function or undefined"),i||(i=window.requestAnimationFrame);var u=!1,o=null;return function(){o===null&&!u&&(u=!0,i(function(){u=!1;for(var S=o.length,b=new Array(S),G=0;G<S;G++)b[G]=o[G];n.apply(n,b),o=null})),o=arguments}}return yi}var gi,Ef;function ih(){return Ef||(Ef=1,gi=function(t,n,i){var u,o=t.length;if(!(n>=o||i===0)){i=n+i>o?o-n:i;var c=o-i;for(u=n;u<c;++u)t[u]=t[u+i];t.length=c}}),gi}var _i,Af;function uh(){if(Af)return _i;Af=1;var e=ih(),t=Ji(),n=qt();_i=i;function i(u){if(!(this instanceof i))return new i(u);this._name=u||"nanobus",this._starListeners=[],this._listeners={}}return i.prototype.emit=function(u){n.ok(typeof u=="string"||typeof u=="symbol","nanobus.emit: eventName should be type string or symbol");for(var o=[],c=1,g=arguments.length;c<g;c++)o.push(arguments[c]);var S=t(this._name+"('"+u.toString()+"')"),b=this._listeners[u];return b&&b.length>0&&this._emit(this._listeners[u],o),this._starListeners.length>0&&this._emit(this._starListeners,u,o,S.uuid),S(),this},i.prototype.on=i.prototype.addListener=function(u,o){return n.ok(typeof u=="string"||typeof u=="symbol","nanobus.on: eventName should be type string or symbol"),n.equal(typeof o,"function","nanobus.on: listener should be type function"),u==="*"?this._starListeners.push(o):(this._listeners[u]||(this._listeners[u]=[]),this._listeners[u].push(o)),this},i.prototype.prependListener=function(u,o){return n.ok(typeof u=="string"||typeof u=="symbol","nanobus.prependListener: eventName should be type string or symbol"),n.equal(typeof o,"function","nanobus.prependListener: listener should be type function"),u==="*"?this._starListeners.unshift(o):(this._listeners[u]||(this._listeners[u]=[]),this._listeners[u].unshift(o)),this},i.prototype.once=function(u,o){n.ok(typeof u=="string"||typeof u=="symbol","nanobus.once: eventName should be type string or symbol"),n.equal(typeof o,"function","nanobus.once: listener should be type function");var c=this;this.on(u,g);function g(){o.apply(c,arguments),c.removeListener(u,g)}return this},i.prototype.prependOnceListener=function(u,o){n.ok(typeof u=="string"||typeof u=="symbol","nanobus.prependOnceListener: eventName should be type string or symbol"),n.equal(typeof o,"function","nanobus.prependOnceListener: listener should be type function");var c=this;this.prependListener(u,g);function g(){o.apply(c,arguments),c.removeListener(u,g)}return this},i.prototype.removeListener=function(u,o){if(n.ok(typeof u=="string"||typeof u=="symbol","nanobus.removeListener: eventName should be type string or symbol"),n.equal(typeof o,"function","nanobus.removeListener: listener should be type function"),u==="*")return this._starListeners=this._starListeners.slice(),c(this._starListeners,o);return typeof this._listeners[u]<"u"&&(this._listeners[u]=this._listeners[u].slice()),c(this._listeners[u],o);function c(g,S){if(g){var b=g.indexOf(S);if(b!==-1)return e(g,b,1),!0}}},i.prototype.removeAllListeners=function(u){return u?u==="*"?this._starListeners=[]:this._listeners[u]=[]:(this._starListeners=[],this._listeners={}),this},i.prototype.listeners=function(u){var o=u!=="*"?this._listeners[u]:this._starListeners,c=[];if(o)for(var g=o.length,S=0;S<g;S++)c.push(o[S]);return c},i.prototype._emit=function(u,o,c,g){if(!(typeof u>"u")&&u.length!==0){c===void 0&&(c=o,o=null),o&&(g!==void 0?c=[o].concat(c,g):c=[o].concat(c));for(var S=u.length,b=0;b<S;b++){var G=u[b];G.apply(G,c)}}},_i}var xi,Tf;function oh(){if(Tf)return xi;Tf=1,xi=e;function e(t){if(!(this instanceof e))return new e(t);typeof t=="number"&&(t={max:t}),t||(t={}),this.cache={},this.head=this.tail=null,this.length=0,this.max=t.max||1e3,this.maxAge=t.maxAge||0}return Object.defineProperty(e.prototype,"keys",{get:function(){return Object.keys(this.cache)}}),e.prototype.clear=function(){this.cache={},this.head=this.tail=null,this.length=0},e.prototype.remove=function(t){if(typeof t!="string"&&(t=""+t),!!this.cache.hasOwnProperty(t)){var n=this.cache[t];return delete this.cache[t],this._unlink(t,n.prev,n.next),n.value}},e.prototype._unlink=function(t,n,i){this.length--,this.length===0?this.head=this.tail=null:this.head===t?(this.head=n,this.cache[this.head].next=null):this.tail===t?(this.tail=i,this.cache[this.tail].prev=null):(this.cache[n].next=i,this.cache[i].prev=n)},e.prototype.peek=function(t){if(this.cache.hasOwnProperty(t)){var n=this.cache[t];if(this._checkAge(t,n))return n.value}},e.prototype.set=function(t,n){typeof t!="string"&&(t=""+t);var i;if(this.cache.hasOwnProperty(t)){if(i=this.cache[t],i.value=n,this.maxAge&&(i.modified=Date.now()),t===this.head)return n;this._unlink(t,i.prev,i.next)}else i={value:n,modified:0,next:null,prev:null},this.maxAge&&(i.modified=Date.now()),this.cache[t]=i,this.length===this.max&&this.evict();return this.length++,i.next=null,i.prev=this.head,this.head&&(this.cache[this.head].next=t),this.head=t,this.tail||(this.tail=t),n},e.prototype._checkAge=function(t,n){return this.maxAge&&Date.now()-n.modified>this.maxAge?(this.remove(t),!1):!0},e.prototype.get=function(t){if(typeof t!="string"&&(t=""+t),!!this.cache.hasOwnProperty(t)){var n=this.cache[t];if(this._checkAge(t,n))return this.head!==t&&(t===this.tail?(this.tail=n.next,this.cache[this.tail].prev=null):this.cache[n.prev].next=n.next,this.cache[n.next].prev=n.prev,this.cache[this.head].next=t,n.prev=this.head,n.next=null,this.head=t),n.value}},e.prototype.evict=function(){this.tail&&this.remove(this.tail)},xi}var wi,Sf;function fh(){if(Sf)return wi;Sf=1;var e=qt(),t=oh();wi=n;function n(u,o,c){e.ok(this instanceof n,"ChooComponentCache should be created with `new`"),e.equal(typeof u,"object","ChooComponentCache: state should be type object"),e.equal(typeof o,"function","ChooComponentCache: emit should be type function"),typeof c=="number"?this.cache=new t(c):this.cache=c||new t(100),this.state=u,this.emit=o}n.prototype.render=function(u,o){e.equal(typeof u,"function","ChooComponentCache.render: Component should be type function"),e.ok(typeof o=="string"||typeof o=="number","ChooComponentCache.render: id should be type string or type number");var c=this.cache.get(o);if(!c){for(var g=[],S=2,b=arguments.length;S<b;S++)g.push(arguments[S]);g.unshift(u,o,this.state,this.emit),c=i.apply(i,g),this.cache.set(o,c)}return c};function i(u){return new(u.bind.apply(u,arguments))}return wi}var Ei,Rf;function sh(){if(Rf)return Ei;Rf=1;var e=Wl(),t=Yl(),n=Ji(),i=Jl(),u=cs(),o=rh(),c=nh(),g=ah(),S=uh(),b=qt(),G=fh();Ei=R;var k={};function R(A){var O=n("choo.constructor");if(!(this instanceof R))return new R(A);A=A||{},b.equal(typeof A,"object","choo: opts should be type object");var q=this;this._events={DOMCONTENTLOADED:"DOMContentLoaded",DOMTITLECHANGE:"DOMTitleChange",REPLACESTATE:"replaceState",PUSHSTATE:"pushState",NAVIGATE:"navigate",POPSTATE:"popState",RENDER:"render"},this._historyEnabled=A.history===void 0?!0:A.history,this._hrefEnabled=A.href===void 0?!0:A.href,this._hashEnabled=A.hash===void 0?!1:A.hash,this._hasWindow=typeof window<"u",this._cache=A.cache,this._loaded=!1,this._stores=[_e],this._tree=null;var ne={events:this._events,components:{}};this._hasWindow?(this.state=window.initialState?Object.assign({},window.initialState,ne):ne,delete window.initialState):this.state=ne,this.router=i({curry:!0}),this.emitter=S("choo.emit"),this.emit=this.emitter.emit.bind(this.emitter),this._hasWindow&&(this.state.title=document.title);function _e(me){q.emitter.prependListener(q._events.DOMTITLECHANGE,function(Ee){b.equal(typeof Ee,"string","events.DOMTitleChange: title should be type string"),me.title=Ee,q._hasWindow&&(document.title=Ee)})}O()}return R.prototype.route=function(A,O){var q=n("choo.route('"+A+"')");b.equal(typeof A,"string","choo.route: route should be type string"),b.equal(typeof O,"function","choo.handler: route should be type function"),this.router.on(A,O),q()},R.prototype.use=function(A){b.equal(typeof A,"function","choo.use: cb should be type function");var O=this;this._stores.push(function(q){var ne="choo.use";ne=A.storeName?ne+"("+A.storeName+")":ne;var _e=n(ne);A(q,O.emitter,O),_e()})},R.prototype.start=function(){b.equal(typeof window,"object","choo.start: window was not found. .start() must be called in a browser, use .toString() if running in Node");var A=n("choo.start"),O=this;return this._historyEnabled&&(this.emitter.prependListener(this._events.NAVIGATE,function(){O._matchRoute(O.state),O._loaded&&(O.emitter.emit(O._events.RENDER),setTimeout(e.bind(null,window.location.hash),0))}),this.emitter.prependListener(this._events.POPSTATE,function(){O.emitter.emit(O._events.NAVIGATE)}),this.emitter.prependListener(this._events.PUSHSTATE,function(q){b.equal(typeof q,"string","events.pushState: href should be type string"),window.history.pushState(k,null,q),O.emitter.emit(O._events.NAVIGATE)}),this.emitter.prependListener(this._events.REPLACESTATE,function(q){b.equal(typeof q,"string","events.replaceState: href should be type string"),window.history.replaceState(k,null,q),O.emitter.emit(O._events.NAVIGATE)}),window.onpopstate=function(){O.emitter.emit(O._events.POPSTATE)},O._hrefEnabled&&c(function(q){var ne=q.href,_e=q.hash;if(ne===window.location.href){!O._hashEnabled&&_e&&e(_e);return}O.emitter.emit(O._events.PUSHSTATE,ne)})),this._setCache(this.state),this._matchRoute(this.state),this._stores.forEach(function(q){q(O.state)}),this._tree=this._prerender(this.state),b.ok(this._tree,"choo.start: no valid DOM node returned for location "+this.state.href),this.emitter.prependListener(O._events.RENDER,g(function(){var q=n("choo.render"),ne=O._prerender(O.state);b.ok(ne,"choo.render: no valid DOM node returned for location "+O.state.href),b.equal(O._tree.nodeName,ne.nodeName,"choo.render: The target node <"+O._tree.nodeName.toLowerCase()+"> is not the same type as the new node <"+ne.nodeName.toLowerCase()+">.");var _e=n("choo.morph");u(O._tree,ne),_e(),q()})),t(function(){O.emitter.emit(O._events.DOMCONTENTLOADED),O._loaded=!0}),A(),this._tree},R.prototype.mount=function(O){var q=n("choo.mount('"+O+"')");if(typeof window!="object")return b.ok(typeof O=="string","choo.mount: selector should be type String"),this.selector=O,q(),this;b.ok(typeof O=="string"||typeof O=="object","choo.mount: selector should be type String or HTMLElement");var ne=this;t(function(){var _e=n("choo.render"),me=ne.start();typeof O=="string"?ne._tree=document.querySelector(O):ne._tree=O,b.ok(ne._tree,"choo.mount: could not query selector: "+O),b.equal(ne._tree.nodeName,me.nodeName,"choo.mount: The target node <"+ne._tree.nodeName.toLowerCase()+"> is not the same type as the new node <"+me.nodeName.toLowerCase()+">.");var Ee=n("choo.morph");u(ne._tree,me),Ee(),_e()}),q()},R.prototype.toString=function(A,O){O=O||{},O.components=O.components||{},O.events=Object.assign({},O.events,this._events),b.notEqual(typeof window,"object","choo.mount: window was found. .toString() must be called in Node, use .start() or .mount() if running in the browser"),b.equal(typeof A,"string","choo.toString: location should be type string"),b.equal(typeof O,"object","choo.toString: state should be type object"),this._setCache(O),this._matchRoute(O,A),this.emitter.removeAllListeners(),this._stores.forEach(function(ne){ne(O)});var q=this._prerender(O);return b.ok(q,"choo.toString: no valid value returned for the route "+A),b(!Array.isArray(q),"choo.toString: return value was an array for the route "+A),typeof q.outerHTML=="string"?q.outerHTML:q.toString()},R.prototype._matchRoute=function(A,O){var q,ne;O?(q=O.replace(/\?.+$/,"").replace(/\/$/,""),this._hashEnabled||(q=q.replace(/#.+$/,"")),ne=O):(q=window.location.pathname.replace(/\/$/,""),this._hashEnabled&&(q+=window.location.hash.replace(/^#/,"/")),ne=window.location.search);var _e=this.router.match(q);this._handler=_e.cb,A.href=q,A.query=o(ne),A.route=_e.route,A.params=_e.params},R.prototype._prerender=function(A){var O=n("choo.prerender('"+A.route+"')"),q=this._handler(A,this.emit);return O(),q},R.prototype._setCache=function(A){var O=new G(A,this.emitter.emit.bind(this.emitter),this._cache);A.cache=q;function q(ne,_e){b.equal(typeof ne,"function","choo.state.cache: Component should be type function");for(var me=[],Ee=0,Ve=arguments.length;Ee<Ve;Ee++)me.push(arguments[Ee]);return O.render.apply(O,me)}q.toJSON=function(){return null}},Ei}var dh=sh();const ch=wr(dh);var Ai,Lf;function lh(){if(Lf)return Ai;Lf=1,Ai=t;var e={class:"className",for:"htmlFor","http-equiv":"httpEquiv"};function t(n){return function(i,u,o){for(var c in u)c in e&&(u[e[c]]=u[c],delete u[c]);return n(i,u,o)}}return Ai}var Ti,Cf;function hh(){if(Cf)return Ti;Cf=1;var e=lh(),t=0,n=1,i=2,u=3,o=4,c=5,g=6,S=7,b=8,G=9,k=10,R=11,A=12,O=13;Ti=function(me,Ee){Ee||(Ee={});var Ve=Ee.concat||function(P,p){return String(P)+String(p)};return Ee.attrToProp!==!1&&(me=e(me)),function(P){for(var p=n,C="",$=arguments.length,W=[],re=0;re<P.length;re++)if(re<$-1){var Ie=arguments[re+1],Oe=Rt(P[re]),Se=p;Se===k&&(Se=b),Se===G&&(Se=b),Se===S&&(Se=b),Se===o&&(Se=c),Se===i?C==="/"?(Oe.push([i,"/",Ie]),C=""):Oe.push([i,Ie]):Se===O&&Ee.comments?C+=String(Ie):Se!==O&&Oe.push([t,Se,Ie]),W.push.apply(W,Oe)}else W.push.apply(W,Rt(P[re]));for(var Le=[null,{},[]],Ge=[[Le,-1]],re=0;re<W.length;re++){var Ue=Ge[Ge.length-1][0],Oe=W[re],Me=Oe[0];if(Me===i&&/^\//.test(Oe[1])){var Ct=Ge[Ge.length-1][1];Ge.length>1&&(Ge.pop(),Ge[Ge.length-1][0][2][Ct]=me(Ue[0],Ue[1],Ue[2].length?Ue[2]:void 0))}else if(Me===i){var ot=[Oe[1],{},[]];Ue[2].push(ot),Ge.push([ot,Ue[2].length-1])}else if(Me===c||Me===t&&Oe[1]===c){for(var Je="",Mt;re<W.length;re++)if(W[re][0]===c)Je=Ve(Je,W[re][1]);else if(W[re][0]===t&&W[re][1]===c)if(typeof W[re][2]=="object"&&!Je)for(Mt in W[re][2])W[re][2].hasOwnProperty(Mt)&&!Ue[1][Mt]&&(Ue[1][Mt]=W[re][2][Mt]);else Je=Ve(Je,W[re][2]);else break;W[re][0]===R&&re++;for(var ft=re;re<W.length;re++)if(W[re][0]===b||W[re][0]===c)Ue[1][Je]?W[re][1]===""||(Ue[1][Je]=Ve(Ue[1][Je],W[re][1])):Ue[1][Je]=rt(W[re][1]);else if(W[re][0]===t&&(W[re][1]===b||W[re][1]===c))Ue[1][Je]?W[re][2]===""||(Ue[1][Je]=Ve(Ue[1][Je],W[re][2])):Ue[1][Je]=rt(W[re][2]);else{Je.length&&!Ue[1][Je]&&re===ft&&(W[re][0]===u||W[re][0]===A)&&(Ue[1][Je]=Je.toLowerCase()),W[re][0]===u&&re--;break}}else if(Me===c)Ue[1][Oe[1]]=!0;else if(Me===t&&Oe[1]===c)Ue[1][Oe[2]]=!0;else if(Me===u){if(_e(Ue[0])&&Ge.length){var Ct=Ge[Ge.length-1][1];Ge.pop(),Ge[Ge.length-1][0][2][Ct]=me(Ue[0],Ue[1],Ue[2].length?Ue[2]:void 0)}}else if(Me===t&&Oe[1]===n)Oe[2]===void 0||Oe[2]===null?Oe[2]="":Oe[2]||(Oe[2]=Ve("",Oe[2])),Array.isArray(Oe[2][0])?Ue[2].push.apply(Ue[2],Oe[2]):Ue[2].push(Oe[2]);else if(Me===n)Ue[2].push(Oe[1]);else if(!(Me===R||Me===A))throw new Error("unhandled: "+Me)}if(Le[2].length>1&&/^\s*$/.test(Le[2][0])&&Le[2].shift(),Le[2].length>2||Le[2].length===2&&/\S/.test(Le[2][1])){if(Ee.createFragment)return Ee.createFragment(Le[2]);throw new Error("multiple root elements must be wrapped in an enclosing tag")}return Array.isArray(Le[2][0])&&typeof Le[2][0][0]=="string"&&Array.isArray(Le[2][0][2])&&(Le[2][0]=me(Le[2][0][0],Le[2][0][1],Le[2][0][2])),Le[2][0];function Rt(Ft){var tt=[];p===S&&(p=o);for(var Ar=0;Ar<Ft.length;Ar++){var ut=Ft.charAt(Ar);p===n&&ut==="<"?(C.length&&tt.push([n,C]),C="",p=i):ut===">"&&!q(p)&&p!==O?(p===i&&C.length?tt.push([i,C]):p===c?tt.push([c,C]):p===b&&C.length&&tt.push([b,C]),tt.push([u]),C="",p=n):p===O&&/-$/.test(C)&&ut==="-"?(Ee.comments&&tt.push([b,C.substr(0,C.length-1)]),C="",p=n):p===i&&/^!--$/.test(C)?(Ee.comments&&tt.push([i,C],[c,"comment"],[R]),C=ut,p=O):p===n||p===O?C+=ut:p===i&&ut==="/"&&C.length||(p===i&&/\s/.test(ut)?(C.length&&tt.push([i,C]),C="",p=o):p===i?C+=ut:p===o&&/[^\s"'=/]/.test(ut)?(p=c,C=ut):p===o&&/\s/.test(ut)?(C.length&&tt.push([c,C]),tt.push([A])):p===c&&/\s/.test(ut)?(tt.push([c,C]),C="",p=g):p===c&&ut==="="?(tt.push([c,C],[R]),C="",p=S):p===c?C+=ut:(p===g||p===o)&&ut==="="?(tt.push([R]),p=S):(p===g||p===o)&&!/\s/.test(ut)?(tt.push([A]),/[\w-]/.test(ut)?(C+=ut,p=c):p=o):p===S&&ut==='"'?p=k:p===S&&ut==="'"?p=G:p===k&&ut==='"'?(tt.push([b,C],[A]),C="",p=o):p===G&&ut==="'"?(tt.push([b,C],[A]),C="",p=o):p===S&&!/\s/.test(ut)?(p=b,Ar--):p===b&&/\s/.test(ut)?(tt.push([b,C],[A]),C="",p=o):(p===b||p===G||p===k)&&(C+=ut))}return p===n&&C.length?(tt.push([n,C]),C=""):p===b&&C.length?(tt.push([b,C]),C=""):p===k&&C.length?(tt.push([b,C]),C=""):p===G&&C.length?(tt.push([b,C]),C=""):p===c&&(tt.push([c,C]),C=""),tt}};function rt(P){return typeof P=="function"||typeof P=="string"||P&&typeof P=="object"||P==null?P:Ve("",P)}};function q(me){return me===G||me===k}var ne=RegExp("^("+["area","base","basefont","bgsound","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr","!--","animate","animateTransform","circle","cursor","desc","ellipse","feBlend","feColorMatrix","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","font-face-format","font-face-name","font-face-uri","glyph","glyphRef","hkern","image","line","missing-glyph","mpath","path","polygon","polyline","rect","set","stop","tref","use","view","vkern"].join("|")+")(?:[.#][a-zA-Z0-9-ï¿¿_:-]+)*$");function _e(me){return ne.test(me)}return Ti}var Si,Of;function mh(){if(Of)return Si;Of=1;var e=/\n[\s]+$/,t=/^\n[\s]+/,n=/[\s]+$/,i=/^[\s]+/,u=/[\n\s]+/g,o=["a","abbr","b","bdi","bdo","br","cite","data","dfn","em","i","kbd","mark","q","rp","rt","rtc","ruby","s","amp","small","span","strong","sub","sup","time","u","var","wbr"],c=["code","pre","textarea"];return Si=function g(S,b){if(Array.isArray(b))for(var G=S.nodeName.toLowerCase(),k=!1,R,A,O=0,q=b.length;O<q;O++){var ne=b[O];if(Array.isArray(ne)){g(S,ne);continue}(typeof ne=="number"||typeof ne=="boolean"||typeof ne=="function"||ne instanceof Date||ne instanceof RegExp)&&(ne=ne.toString());var _e=S.childNodes[S.childNodes.length-1];if(typeof ne=="string")k=!0,_e&&_e.nodeName==="#text"?_e.nodeValue+=ne:(ne=S.ownerDocument.createTextNode(ne),S.appendChild(ne),_e=ne),O===q-1&&(k=!1,o.indexOf(G)===-1&&c.indexOf(G)===-1?(R=_e.nodeValue.replace(t,"").replace(n,"").replace(e,"").replace(u," "),R===""?S.removeChild(_e):_e.nodeValue=R):c.indexOf(G)===-1&&(A=O===0?"":" ",R=_e.nodeValue.replace(t,A).replace(i," ").replace(n,"").replace(e,"").replace(u," "),_e.nodeValue=R));else if(ne&&ne.nodeType){k&&(k=!1,o.indexOf(G)===-1&&c.indexOf(G)===-1?(R=_e.nodeValue.replace(t,"").replace(e," ").replace(u," "),R===""?S.removeChild(_e):_e.nodeValue=R):c.indexOf(G)===-1&&(R=_e.nodeValue.replace(i," ").replace(t,"").replace(e," ").replace(u," "),_e.nodeValue=R));var me=ne.nodeName;me&&(G=me.toLowerCase()),S.appendChild(ne)}}},Si}var Ri,Ff;function ph(){return Ff||(Ff=1,Ri=["svg","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","stop","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"]),Ri}var Li,Df;function vh(){return Df||(Df=1,Li=["async","autofocus","autoplay","checked","controls","default","defaultchecked","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","novalidate","open","playsinline","readonly","required","reversed","selected"]),Li}var Ci,kf;function bh(){return kf||(kf=1,Ci=["indeterminate"]),Ci}var Oi,Mf;function yh(){if(Mf)return Oi;Mf=1;var e=hh(),t=mh(),n=ph(),i=vh(),u=bh(),o="http://www.w3.org/2000/svg",c="http://www.w3.org/1999/xlink",g="!--";return Oi=function(S){function b(R,A,O){var q;n.indexOf(R)!==-1&&(A.namespace=o);var ne=!1;A.namespace&&(ne=A.namespace,delete A.namespace);var _e=!1;if(A.is&&(_e=A.is,delete A.is),ne)_e?q=S.createElementNS(ne,R,{is:_e}):q=S.createElementNS(ne,R);else{if(R===g)return S.createComment(A.comment);_e?q=S.createElement(R,{is:_e}):q=S.createElement(R)}for(var me in A)if(A.hasOwnProperty(me)){var Ee=me.toLowerCase(),Ve=A[me];if(Ee==="classname"&&(Ee="class",me="class"),me==="htmlFor"&&(me="for"),i.indexOf(Ee)!==-1){if(String(Ve)==="true")Ve=Ee;else if(String(Ve)==="false")continue}Ee.slice(0,2)==="on"||u.indexOf(Ee)!==-1?q[me]=Ve:ne?me==="xlink:href"?q.setAttributeNS(c,me,Ve):/^xmlns($|:)/i.test(me)||q.setAttributeNS(null,me,Ve):q.setAttribute(me,Ve)}return t(q,O),q}function G(R){for(var A=S.createDocumentFragment(),O=0;O<R.length;O++)R[O]!=null&&(Array.isArray(R[O])?A.appendChild(G(R[O])):(typeof R[O]=="string"&&(R[O]=S.createTextNode(R[O])),A.appendChild(R[O])));return A}var k=e(b,{comments:!0,createFragment:G});return k.default=k,k.createComment=b,k},Oi}var Fi,Gf;function gh(){return Gf||(Gf=1,Fi=yh()(document)),Fi}var Di,If;function _h(){return If||(If=1,Di=gh()),Di}var xh=_h();const _t=wr(xh);var ki,Nf;function wh(){if(Nf)return ki;Nf=1;function e(n){var i=document.createElement("div");return i.innerHTML=n,t(i.childNodes)}function t(n){return Array.isArray(n)?n:[].slice.call(n)}return ki=e,ki}var Mi,Bf;function Eh(){return Bf||(Bf=1,Mi=wh()),Mi}var Ah=Eh();const ls=wr(Ah),Th=(e,t)=>{function n(){const i=new Image;i.src="/xp.jpg",i.onload=()=>{s0.init({src:i}),src(o1).colorama(.015).modulate(osc(6,0,1.5).modulate(noise(3,.1).sub(gradient()),1).brightness(-.5),.01).layer(src(o1).mask(osc(30,.05).thresh(.2,0).modulate(src(s0).scale(1,()=>i.width/i.height*(window.innerHeight/window.innerWidth)).sub(gradient()),1))).layer(src(s0).scale(1,()=>i.width/i.height*(window.innerHeight/window.innerWidth)).mask(osc(1,.6).modulate(src(s0).scale(1,()=>i.width/i.height*(window.innerHeight/window.innerWidth)).sub(gradient()),1).thresh(()=>Math.min(time/3,.8),0))).out(o1),src(o1).out(o0)}}t.on("DOMContentLoaded",()=>{n()})};function Sh(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function Rh(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var Lh=function(){function e(n){var i=this;this._insertTag=function(u){var o;i.tags.length===0?i.insertionPoint?o=i.insertionPoint.nextSibling:i.prepend?o=i.container.firstChild:o=i.before:o=i.tags[i.tags.length-1].nextSibling,i.container.insertBefore(u,o),i.tags.push(u)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(i){i.forEach(this._insertTag)},t.insert=function(i){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Rh(this));var u=this.tags[this.tags.length-1];if(this.isSpeedy){var o=Sh(u);try{o.insertRule(i,o.cssRules.length)}catch{}}else u.appendChild(document.createTextNode(i));this.ctr++},t.flush=function(){this.tags.forEach(function(i){return i.parentNode&&i.parentNode.removeChild(i)}),this.tags=[],this.ctr=0},e}(),Ot="-ms-",ra="-moz-",nt="-webkit-",hs="comm",eu="rule",tu="decl",Ch="@import",ms="@keyframes",Oh="@layer",Fh=Math.abs,ia=String.fromCharCode,Dh=Object.assign;function kh(e,t){return Lt(e,0)^45?(((t<<2^Lt(e,0))<<2^Lt(e,1))<<2^Lt(e,2))<<2^Lt(e,3):0}function ps(e){return e.trim()}function Mh(e,t){return(e=t.exec(e))?e[0]:e}function at(e,t,n){return e.replace(t,n)}function Qi(e,t){return e.indexOf(t)}function Lt(e,t){return e.charCodeAt(t)|0}function pn(e,t,n){return e.slice(t,n)}function Qt(e){return e.length}function ru(e){return e.length}function Yn(e,t){return t.push(e),e}function Gh(e,t){return e.map(t).join("")}var ua=1,qr=1,vs=0,Nt=0,wt=0,Vr="";function oa(e,t,n,i,u,o,c){return{value:e,root:t,parent:n,type:i,props:u,children:o,line:ua,column:qr,length:c,return:""}}function cn(e,t){return Dh(oa("",null,null,"",null,null,0),e,{length:-e.length},t)}function Ih(){return wt}function Nh(){return wt=Nt>0?Lt(Vr,--Nt):0,qr--,wt===10&&(qr=1,ua--),wt}function jt(){return wt=Nt<vs?Lt(Vr,Nt++):0,qr++,wt===10&&(qr=1,ua++),wt}function Zt(){return Lt(Vr,Nt)}function Qn(){return Nt}function bn(e,t){return pn(Vr,e,t)}function vn(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function bs(e){return ua=qr=1,vs=Qt(Vr=e),Nt=0,[]}function ys(e){return Vr="",e}function Zn(e){return ps(bn(Nt-1,Zi(e===91?e+2:e===40?e+1:e)))}function Bh(e){for(;(wt=Zt())&&wt<33;)jt();return vn(e)>2||vn(wt)>3?"":" "}function Ph(e,t){for(;--t&&jt()&&!(wt<48||wt>102||wt>57&&wt<65||wt>70&&wt<97););return bn(e,Qn()+(t<6&&Zt()==32&&jt()==32))}function Zi(e){for(;jt();)switch(wt){case e:return Nt;case 34:case 39:e!==34&&e!==39&&Zi(wt);break;case 40:e===41&&Zi(e);break;case 92:jt();break}return Nt}function $h(e,t){for(;jt()&&e+wt!==57;)if(e+wt===84&&Zt()===47)break;return"/*"+bn(t,Nt-1)+"*"+ia(e===47?e:jt())}function jh(e){for(;!vn(Zt());)jt();return bn(e,Nt)}function zh(e){return ys(Jn("",null,null,null,[""],e=bs(e),0,[0],e))}function Jn(e,t,n,i,u,o,c,g,S){for(var b=0,G=0,k=c,R=0,A=0,O=0,q=1,ne=1,_e=1,me=0,Ee="",Ve=u,rt=o,P=i,p=Ee;ne;)switch(O=me,me=jt()){case 40:if(O!=108&&Lt(p,k-1)==58){Qi(p+=at(Zn(me),"&","&\f"),"&\f")!=-1&&(_e=-1);break}case 34:case 39:case 91:p+=Zn(me);break;case 9:case 10:case 13:case 32:p+=Bh(O);break;case 92:p+=Ph(Qn()-1,7);continue;case 47:switch(Zt()){case 42:case 47:Yn(Uh($h(jt(),Qn()),t,n),S);break;default:p+="/"}break;case 123*q:g[b++]=Qt(p)*_e;case 125*q:case 59:case 0:switch(me){case 0:case 125:ne=0;case 59+G:_e==-1&&(p=at(p,/\f/g,"")),A>0&&Qt(p)-k&&Yn(A>32?$f(p+";",i,n,k-1):$f(at(p," ","")+";",i,n,k-2),S);break;case 59:p+=";";default:if(Yn(P=Pf(p,t,n,b,G,u,g,Ee,Ve=[],rt=[],k),o),me===123)if(G===0)Jn(p,t,P,P,Ve,o,k,g,rt);else switch(R===99&&Lt(p,3)===110?100:R){case 100:case 108:case 109:case 115:Jn(e,P,P,i&&Yn(Pf(e,P,P,0,0,u,g,Ee,u,Ve=[],k),rt),u,rt,k,g,i?Ve:rt);break;default:Jn(p,P,P,P,[""],rt,0,g,rt)}}b=G=A=0,q=_e=1,Ee=p="",k=c;break;case 58:k=1+Qt(p),A=O;default:if(q<1){if(me==123)--q;else if(me==125&&q++==0&&Nh()==125)continue}switch(p+=ia(me),me*q){case 38:_e=G>0?1:(p+="\f",-1);break;case 44:g[b++]=(Qt(p)-1)*_e,_e=1;break;case 64:Zt()===45&&(p+=Zn(jt())),R=Zt(),G=k=Qt(Ee=p+=jh(Qn())),me++;break;case 45:O===45&&Qt(p)==2&&(q=0)}}return o}function Pf(e,t,n,i,u,o,c,g,S,b,G){for(var k=u-1,R=u===0?o:[""],A=ru(R),O=0,q=0,ne=0;O<i;++O)for(var _e=0,me=pn(e,k+1,k=Fh(q=c[O])),Ee=e;_e<A;++_e)(Ee=ps(q>0?R[_e]+" "+me:at(me,/&\f/g,R[_e])))&&(S[ne++]=Ee);return oa(e,t,n,u===0?eu:g,S,b,G)}function Uh(e,t,n){return oa(e,t,n,hs,ia(Ih()),pn(e,2,-2),0)}function $f(e,t,n,i){return oa(e,t,n,tu,pn(e,0,i),pn(e,i+1,-1),i)}function Ur(e,t){for(var n="",i=ru(e),u=0;u<i;u++)n+=t(e[u],u,e,t)||"";return n}function qh(e,t,n,i){switch(e.type){case Oh:if(e.children.length)break;case Ch:case tu:return e.return=e.return||e.value;case hs:return"";case ms:return e.return=e.value+"{"+Ur(e.children,i)+"}";case eu:e.value=e.props.join(",")}return Qt(n=Ur(e.children,i))?e.return=e.value+"{"+n+"}":""}function Vh(e){var t=ru(e);return function(n,i,u,o){for(var c="",g=0;g<t;g++)c+=e[g](n,i,u,o)||"";return c}}function Hh(e){return function(t){t.root||(t=t.return)&&e(t)}}function Xh(e){var t=Object.create(null);return function(n){return t[n]===void 0&&(t[n]=e(n)),t[n]}}var Wh=function(t,n,i){for(var u=0,o=0;u=o,o=Zt(),u===38&&o===12&&(n[i]=1),!vn(o);)jt();return bn(t,Nt)},Yh=function(t,n){var i=-1,u=44;do switch(vn(u)){case 0:u===38&&Zt()===12&&(n[i]=1),t[i]+=Wh(Nt-1,n,i);break;case 2:t[i]+=Zn(u);break;case 4:if(u===44){t[++i]=Zt()===58?"&\f":"",n[i]=t[i].length;break}default:t[i]+=ia(u)}while(u=jt());return t},Kh=function(t,n){return ys(Yh(bs(t),n))},jf=new WeakMap,Qh=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var n=t.value,i=t.parent,u=t.column===i.column&&t.line===i.line;i.type!=="rule";)if(i=i.parent,!i)return;if(!(t.props.length===1&&n.charCodeAt(0)!==58&&!jf.get(i))&&!u){jf.set(t,!0);for(var o=[],c=Kh(n,o),g=i.props,S=0,b=0;S<c.length;S++)for(var G=0;G<g.length;G++,b++)t.props[b]=o[S]?c[S].replace(/&\f/g,g[G]):g[G]+" "+c[S]}}},Zh=function(t){if(t.type==="decl"){var n=t.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(t.return="",t.value="")}};function gs(e,t){switch(kh(e,t)){case 5103:return nt+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return nt+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return nt+e+ra+e+Ot+e+e;case 6828:case 4268:return nt+e+Ot+e+e;case 6165:return nt+e+Ot+"flex-"+e+e;case 5187:return nt+e+at(e,/(\w+).+(:[^]+)/,nt+"box-$1$2"+Ot+"flex-$1$2")+e;case 5443:return nt+e+Ot+"flex-item-"+at(e,/flex-|-self/,"")+e;case 4675:return nt+e+Ot+"flex-line-pack"+at(e,/align-content|flex-|-self/,"")+e;case 5548:return nt+e+Ot+at(e,"shrink","negative")+e;case 5292:return nt+e+Ot+at(e,"basis","preferred-size")+e;case 6060:return nt+"box-"+at(e,"-grow","")+nt+e+Ot+at(e,"grow","positive")+e;case 4554:return nt+at(e,/([^-])(transform)/g,"$1"+nt+"$2")+e;case 6187:return at(at(at(e,/(zoom-|grab)/,nt+"$1"),/(image-set)/,nt+"$1"),e,"")+e;case 5495:case 3959:return at(e,/(image-set\([^]*)/,nt+"$1$`$1");case 4968:return at(at(e,/(.+:)(flex-)?(.*)/,nt+"box-pack:$3"+Ot+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+nt+e+e;case 4095:case 3583:case 4068:case 2532:return at(e,/(.+)-inline(.+)/,nt+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Qt(e)-1-t>6)switch(Lt(e,t+1)){case 109:if(Lt(e,t+4)!==45)break;case 102:return at(e,/(.+:)(.+)-([^]+)/,"$1"+nt+"$2-$3$1"+ra+(Lt(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~Qi(e,"stretch")?gs(at(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(Lt(e,t+1)!==115)break;case 6444:switch(Lt(e,Qt(e)-3-(~Qi(e,"!important")&&10))){case 107:return at(e,":",":"+nt)+e;case 101:return at(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+nt+(Lt(e,14)===45?"inline-":"")+"box$3$1"+nt+"$2$3$1"+Ot+"$2box$3")+e}break;case 5936:switch(Lt(e,t+11)){case 114:return nt+e+Ot+at(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return nt+e+Ot+at(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return nt+e+Ot+at(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return nt+e+Ot+e+e}return e}var Jh=function(t,n,i,u){if(t.length>-1&&!t.return)switch(t.type){case tu:t.return=gs(t.value,t.length);break;case ms:return Ur([cn(t,{value:at(t.value,"@","@"+nt)})],u);case eu:if(t.length)return Gh(t.props,function(o){switch(Mh(o,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Ur([cn(t,{props:[at(o,/:(read-\w+)/,":"+ra+"$1")]})],u);case"::placeholder":return Ur([cn(t,{props:[at(o,/:(plac\w+)/,":"+nt+"input-$1")]}),cn(t,{props:[at(o,/:(plac\w+)/,":"+ra+"$1")]}),cn(t,{props:[at(o,/:(plac\w+)/,Ot+"input-$1")]})],u)}return""})}},em=[Jh],tm=function(t){var n=t.key;if(n==="css"){var i=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(i,function(q){var ne=q.getAttribute("data-emotion");ne.indexOf(" ")!==-1&&(document.head.appendChild(q),q.setAttribute("data-s",""))})}var u=t.stylisPlugins||em,o={},c,g=[];c=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(q){for(var ne=q.getAttribute("data-emotion").split(" "),_e=1;_e<ne.length;_e++)o[ne[_e]]=!0;g.push(q)});var S,b=[Qh,Zh];{var G,k=[qh,Hh(function(q){G.insert(q)})],R=Vh(b.concat(u,k)),A=function(ne){return Ur(zh(ne),R)};S=function(ne,_e,me,Ee){G=me,A(ne?ne+"{"+_e.styles+"}":_e.styles),Ee&&(O.inserted[_e.name]=!0)}}var O={key:n,sheet:new Lh({key:n,container:c,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:o,registered:{},insert:S};return O.sheet.hydrate(g),O};function rm(e){for(var t=0,n,i=0,u=e.length;u>=4;++i,u-=4)n=e.charCodeAt(i)&255|(e.charCodeAt(++i)&255)<<8|(e.charCodeAt(++i)&255)<<16|(e.charCodeAt(++i)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,t=(n&65535)*1540483477+((n>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(u){case 3:t^=(e.charCodeAt(i+2)&255)<<16;case 2:t^=(e.charCodeAt(i+1)&255)<<8;case 1:t^=e.charCodeAt(i)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var nm={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},am=/[A-Z]|^ms/g,im=/_EMO_([^_]+?)_([^]*?)_EMO_/g,_s=function(t){return t.charCodeAt(1)===45},zf=function(t){return t!=null&&typeof t!="boolean"},Gi=Xh(function(e){return _s(e)?e:e.replace(am,"-$&").toLowerCase()}),Uf=function(t,n){switch(t){case"animation":case"animationName":if(typeof n=="string")return n.replace(im,function(i,u,o){return or={name:u,styles:o,next:or},u})}return nm[t]!==1&&!_s(t)&&typeof n=="number"&&n!==0?n+"px":n};function na(e,t,n){if(n==null)return"";if(n.__emotion_styles!==void 0)return n;switch(typeof n){case"boolean":return"";case"object":{if(n.anim===1)return or={name:n.name,styles:n.styles,next:or},n.name;if(n.styles!==void 0){var i=n.next;if(i!==void 0)for(;i!==void 0;)or={name:i.name,styles:i.styles,next:or},i=i.next;var u=n.styles+";";return u}return um(e,t,n)}}if(t==null)return n;var o=t[n];return o!==void 0?o:n}function um(e,t,n){var i="";if(Array.isArray(n))for(var u=0;u<n.length;u++)i+=na(e,t,n[u])+";";else for(var o in n){var c=n[o];if(typeof c!="object")t!=null&&t[c]!==void 0?i+=o+"{"+t[c]+"}":zf(c)&&(i+=Gi(o)+":"+Uf(o,c)+";");else if(Array.isArray(c)&&typeof c[0]=="string"&&(t==null||t[c[0]]===void 0))for(var g=0;g<c.length;g++)zf(c[g])&&(i+=Gi(o)+":"+Uf(o,c[g])+";");else{var S=na(e,t,c);switch(o){case"animation":case"animationName":{i+=Gi(o)+":"+S+";";break}default:i+=o+"{"+S+"}"}}}return i}var qf=/label:\s*([^\s;\n{]+)\s*(;|$)/g,or,Ii=function(t,n,i){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var u=!0,o="";or=void 0;var c=t[0];c==null||c.raw===void 0?(u=!1,o+=na(i,n,c)):o+=c[0];for(var g=1;g<t.length;g++)o+=na(i,n,t[g]),u&&(o+=c[g]);qf.lastIndex=0;for(var S="",b;(b=qf.exec(o))!==null;)S+="-"+b[1];var G=rm(o)+S;return{name:G,styles:o,next:or}};function xs(e,t,n){var i="";return n.split(" ").forEach(function(u){e[u]!==void 0?t.push(e[u]+";"):i+=u+" "}),i}var om=function(t,n,i){var u=t.key+"-"+n.name;t.registered[u]===void 0&&(t.registered[u]=n.styles)},fm=function(t,n,i){om(t,n);var u=t.key+"-"+n.name;if(t.inserted[n.name]===void 0){var o=n;do t.insert(n===o?"."+u:"",o,t.sheet,!0),o=o.next;while(o!==void 0)}};function Vf(e,t){if(e.inserted[t.name]===void 0)return e.insert("",t,e.sheet,!0)}function Hf(e,t,n){var i=[],u=xs(e,i,n);return i.length<2?n:u+t(i)}var sm=function(t){var n=tm(t);n.sheet.speedy=function(g){this.isSpeedy=g},n.compat=!0;var i=function(){for(var S=arguments.length,b=new Array(S),G=0;G<S;G++)b[G]=arguments[G];var k=Ii(b,n.registered,void 0);return fm(n,k),n.key+"-"+k.name},u=function(){for(var S=arguments.length,b=new Array(S),G=0;G<S;G++)b[G]=arguments[G];var k=Ii(b,n.registered),R="animation-"+k.name;return Vf(n,{name:k.name,styles:"@keyframes "+R+"{"+k.styles+"}"}),R},o=function(){for(var S=arguments.length,b=new Array(S),G=0;G<S;G++)b[G]=arguments[G];var k=Ii(b,n.registered);Vf(n,k)},c=function(){for(var S=arguments.length,b=new Array(S),G=0;G<S;G++)b[G]=arguments[G];return Hf(n.registered,i,dm(b))};return{css:i,cx:c,injectGlobal:o,keyframes:u,hydrate:function(S){S.forEach(function(b){n.inserted[b]=!0})},flush:function(){n.registered={},n.inserted={},n.sheet.flush()},sheet:n.sheet,cache:n,getRegisteredStyles:xs.bind(null,n.registered),merge:Hf.bind(null,n.registered,i)}},dm=function e(t){for(var n="",i=0;i<t.length;i++){var u=t[i];if(u!=null){var o=void 0;switch(typeof u){case"boolean":break;case"object":{if(Array.isArray(u))o=e(u);else{o="";for(var c in u)u[c]&&c&&(o&&(o+=" "),o+=c)}break}default:o=u}o&&(n&&(n+=" "),n+=o)}}return n},cm=sm({key:"css"}),ws=cm.css;/*! Copyright Twitter Inc. and other contributors. Licensed under MIT */var Es=function(){var e={base:"https://cdn.jsdelivr.net/gh/jdecked/twemoji@14.1.2/assets/",ext:".png",size:"72x72",className:"emoji",convert:{fromCodePoint:me,toCodePoint:P},onerror:function(){this.parentNode&&this.parentNode.replaceChild(S(this.alt,!1),this)},parse:Ee,replace:Ve,test:rt},t={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},n=/(?:\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffc-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb\udffd-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb-\udffd\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffc-\udfff]|\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb\udffd-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb-\udffd\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c[\udffc-\udfff]|\ud83e\udef1\ud83c\udffc\u200d\ud83e\udef2\ud83c[\udffb\udffd-\udfff]|\ud83e\udef1\ud83c\udffd\u200d\ud83e\udef2\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\udef1\ud83c\udffe\u200d\ud83e\udef2\ud83c[\udffb-\udffd\udfff]|\ud83e\udef1\ud83c\udfff\u200d\ud83e\udef2\ud83c[\udffb-\udffe]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1|\ud83d\udc6b\ud83c[\udffb-\udfff]|\ud83d\udc6c\ud83c[\udffb-\udfff]|\ud83d\udc6d\ud83c[\udffb-\udfff]|\ud83d\udc8f\ud83c[\udffb-\udfff]|\ud83d\udc91\ud83c[\udffb-\udfff]|\ud83e\udd1d\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d\udc8f\udc91]|\ud83e\udd1d)|(?:\ud83d[\udc68\udc69]|\ud83e\uddd1)(?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf7c\udf84\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|\u26f9)((?:\ud83c[\udffb-\udfff]|\ufe0f)\u200d[\u2640\u2642]\ufe0f)|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc70\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd4\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|(?:\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83d\ude36\u200d\ud83c\udf2b\ufe0f|\u2764\ufe0f\u200d\ud83d\udd25|\u2764\ufe0f\u200d\ud83e\ude79|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc15\u200d\ud83e\uddba|\ud83d\udc3b\u200d\u2744\ufe0f|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83d\ude2e\u200d\ud83d\udca8|\ud83d\ude35\u200d\ud83d\udcab|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f|\ud83d\udc08\u200d\u2b1b)|[#*0-9]\ufe0f?\u20e3|(?:[Â©Â®\u2122\u265f]\ufe0f)|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u203c\u2049\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2697\u2699\u269b\u269c\u26a0\u26a1\u26a7\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|(?:\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd0c\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\udd77\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd-\uddcf\uddd1-\udddd\udec3-\udec5\udef0-\udef6]|[\u270a\u270b]))(?:\ud83c[\udffb-\udfff])?|(?:\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udc8e\udc90\udc92-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5-\uded7\udedd-\udedf\udeeb\udeec\udef4-\udefc\udfe0-\udfeb\udff0]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd76\udd78-\uddb4\uddb7\uddba\uddbc-\uddcc\uddd0\uddde-\uddff\ude70-\ude74\ude78-\ude7c\ude80-\ude86\ude90-\udeac\udeb0-\udeba\udec0-\udec2\uded0-\uded9\udee0-\udee7]|[\u23e9-\u23ec\u23f0\u23f3\u267e\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a])|\ufe0f/g,i=/\uFE0F/g,u="â",o=/[&<>'"]/g,c=/^(?:iframe|noframes|noscript|script|select|style|textarea)$/,g=String.fromCharCode;return e;function S(p,C){return document.createTextNode(C?p.replace(i,""):p)}function b(p){return p.replace(o,q)}function G(p,C){return"".concat(C.base,C.size,"/",p,C.ext)}function k(p,C){for(var $=p.childNodes,W=$.length,re,Ie;W--;)re=$[W],Ie=re.nodeType,Ie===3?C.push(re):Ie===1&&!("ownerSVGElement"in re)&&!c.test(re.nodeName.toLowerCase())&&k(re,C);return C}function R(p){return P(p.indexOf(u)<0?p.replace(i,""):p)}function A(p,C){for(var $=k(p,[]),W=$.length,re,Ie,Oe,Se,Le,Ge,Ue,Me,Ct,ot,Je,Mt,ft;W--;){for(Oe=!1,Se=document.createDocumentFragment(),Le=$[W],Ge=Le.nodeValue,Me=0;Ue=n.exec(Ge);){if(Ct=Ue.index,Ct!==Me&&Se.appendChild(S(Ge.slice(Me,Ct),!0)),Je=Ue[0],Mt=R(Je),Me=Ct+Je.length,ft=C.callback(Mt,C),Mt&&ft){ot=new Image,ot.onerror=C.onerror,ot.setAttribute("draggable","false"),re=C.attributes(Je,Mt);for(Ie in re)re.hasOwnProperty(Ie)&&Ie.indexOf("on")!==0&&!ot.hasAttribute(Ie)&&ot.setAttribute(Ie,re[Ie]);ot.className=C.className,ot.alt=Je,ot.src=ft,Oe=!0,Se.appendChild(ot)}ot||Se.appendChild(S(Je,!1)),ot=null}Oe&&(Me<Ge.length&&Se.appendChild(S(Ge.slice(Me),!0)),Le.parentNode.replaceChild(Se,Le))}return p}function O(p,C){return Ve(p,function($){var W=$,re=R($),Ie=C.callback(re,C),Oe,Se;if(re&&Ie){W="<img ".concat('class="',C.className,'" ','draggable="false" ','alt="',$,'"',' src="',Ie,'"'),Oe=C.attributes($,re);for(Se in Oe)Oe.hasOwnProperty(Se)&&Se.indexOf("on")!==0&&W.indexOf(" "+Se+"=")===-1&&(W=W.concat(" ",Se,'="',b(Oe[Se]),'"'));W=W.concat("/>")}return W})}function q(p){return t[p]}function ne(){return null}function _e(p){return typeof p=="number"?p+"x"+p:p}function me(p){var C=typeof p=="string"?parseInt(p,16):p;return C<65536?g(C):(C-=65536,g(55296+(C>>10),56320+(C&1023)))}function Ee(p,C){return(!C||typeof C=="function")&&(C={callback:C}),(typeof p=="string"?O:A)(p,{callback:C.callback||G,attributes:typeof C.attributes=="function"?C.attributes:ne,base:typeof C.base=="string"?C.base:e.base,ext:C.ext||e.ext,size:C.folder||_e(C.size||e.size),className:C.className||e.className,onerror:C.onerror||e.onerror})}function Ve(p,C){return String(p).replace(n,C)}function rt(p){n.lastIndex=0;var C=n.test(p);return n.lastIndex=0,C}function P(p,C){for(var $=[],W=0,re=0,Ie=0;Ie<p.length;)W=p.charCodeAt(Ie++),re?($.push((65536+(re-55296<<10)+(W-56320)).toString(16)),re=0):55296<=W&&W<=56319?re=W:$.push(W.toString(16));return $.join(C||"-")}}();const lm={},hm=Object.freeze(Object.defineProperty({__proto__:null,default:lm},Symbol.toStringTag,{value:"Module"})),mm=Xl(hm);var Ni,Xf;function As(){if(Xf)return Ni;Xf=1;var e=typeof xr<"u"?xr:typeof window<"u"?window:{},t=mm,n;return typeof document<"u"?n=document:(n=e["__GLOBAL_DOCUMENT_CACHE@4"],n||(n=e["__GLOBAL_DOCUMENT_CACHE@4"]=t)),Ni=n,Ni}var ln={exports:{}},Bi,Wf;function pm(){if(Wf)return Bi;Wf=1;var e;return typeof window<"u"?e=window:typeof xr<"u"?e=xr:typeof self<"u"?e=self:e={},Bi=e,Bi}var Yf;function vm(){if(Yf)return ln.exports;Yf=1;var e=As(),t=pm(),n=Object.create(null),i="onloadid"+Math.random().toString(36).slice(2),u="data-"+i,o=0;if(t&&t.MutationObserver){var c=new MutationObserver(function(R){if(!(Object.keys(n).length<1))for(var A=0;A<R.length;A++){if(R[A].attributeName===u){b(R[A],g,S);continue}k(R[A].removedNodes,function(O,q){e.documentElement.contains(q)||S(O,q)}),k(R[A].addedNodes,function(O,q){e.documentElement.contains(q)&&g(O,q)})}});c.observe(e.documentElement,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,attributeFilter:[u]})}ln.exports=function R(A,O,q,ne){return O=O||function(){},q=q||function(){},A.setAttribute(u,"o"+o),n["o"+o]=[O,q,0,ne||R.caller],o+=1,A},ln.exports.KEY_ATTR=u,ln.exports.KEY_ID=i;function g(R,A){n[R][0]&&n[R][2]===0&&(n[R][0](A),n[R][2]=1)}function S(R,A){n[R][1]&&n[R][2]===1&&(n[R][1](A),n[R][2]=0)}function b(R,A,O){var q=R.target.getAttribute(u);if(G(R.oldValue,q)){n[q]=n[R.oldValue];return}n[R.oldValue]&&O(R.oldValue,R.target),n[q]&&A(q,R.target)}function G(R,A){return!R||!A?!1:n[R][3]===n[A][3]}function k(R,A){for(var O=Object.keys(n),q=0;q<R.length;q++){if(R[q]&&R[q].getAttribute&&R[q].getAttribute(u)){var ne=R[q].getAttribute(u);O.forEach(function(_e){ne===_e&&A(_e,R[q])})}R[q]&&R[q].childNodes.length>0&&k(R[q].childNodes,A)}}return ln.exports}var Pi,Kf;function bm(){if(Kf)return Pi;Kf=1,Pi=t;class e extends Error{}e.prototype.name="AssertionError";function t(n,i){if(!n){var u=new e(i);throw Error.captureStackTrace&&Error.captureStackTrace(u,t),u}}return Pi}var $i,Qf;function ym(){if(Qf)return $i;Qf=1;const e=As(),t=Ji(),n=cs(),i=vm(),u=bm(),o=i.KEY_ID,c=i.KEY_ATTR;$i=S;function g(){return"ncid-"+Math.floor((1+Math.random())*65536).toString(16).substring(1)}S.makeID=g;function S(b){this._hasWindow=typeof window<"u",this._id=null,this._ncID=null,this._olID=null,this._proxy=null,this._loaded=!1,this._rootNodeName=null,this._name=b||"nanocomponent",this._rerender=!1,this._handleLoad=this._handleLoad.bind(this),this._handleUnload=this._handleUnload.bind(this),this._arguments=[];const G=this;Object.defineProperty(this,"element",{get:function(){const k=e.getElementById(G._id);if(k)return k.dataset.nanocomponent===G._ncID?k:void 0}})}return S.prototype.render=function(){const b=t(this._name+".render"),G=this,k=new Array(arguments.length);let R;for(let A=0;A<arguments.length;A++)k[A]=arguments[A];if(this._hasWindow)if(this.element){R=this.element;const A=t(this._name+".update"),O=this._rerender||this.update.apply(this,k);if(A(),this._rerender&&(this._rerender=!1),O){const q=this._handleRender(k),ne=t(this._name+".morph");n(R,q),ne(),this.afterupdate&&this.afterupdate(R)}return this._proxy||(this._proxy=this._createProxy()),b(),this._proxy}else return this._reset(),R=this._handleRender(k),this.beforerender&&this.beforerender(R),(this.load||this.unload||this.afterreorder)&&(i(R,G._handleLoad,G._handleUnload,G._ncID),this._olID=R.dataset[o]),b(),R;else{const A=t(this._name+".create");return R=this.createElement.apply(this,k),A(),b(),R}},S.prototype.rerender=function(){u(this.element,"nanocomponent: cant rerender on an unmounted dom node"),this._rerender=!0,this.render.apply(this,this._arguments)},S.prototype._handleRender=function(b){const G=t(this._name+".createElement"),k=this.createElement.apply(this,b);return G(),this._rootNodeName||(this._rootNodeName=k.nodeName),u(k instanceof window.Element,"nanocomponent: createElement should return a single DOM node"),u(this._rootNodeName===k.nodeName,"nanocomponent: root node types cannot differ between re-renders"),this._arguments=b,this._brandNode(this._ensureID(k))},S.prototype._createProxy=function(){const b=e.createElement(this._rootNodeName),G=this;return this._brandNode(b),b.id=this._id,b.setAttribute("data-proxy",""),b.isSameNode=function(k){return k&&k.dataset.nanocomponent===G._ncID},b},S.prototype._reset=function(){this._ncID=S.makeID(),this._olID=null,this._id=null,this._proxy=null,this._rootNodeName=null},S.prototype._brandNode=function(b){return b.setAttribute("data-nanocomponent",this._ncID),this._olID&&b.setAttribute(c,this._olID),b},S.prototype._ensureID=function(b){return b.id?this._id=b.id:b.id=this._id=this._ncID,this._proxy&&this._proxy.id!==this._id&&(this._proxy.id=this._id),b},S.prototype._handleLoad=function(b){if(this._loaded){this.afterreorder&&this.afterreorder(b);return}this._loaded=!0,this.load&&this.load(b)},S.prototype._handleUnload=function(b){this.element||(this._loaded=!1,this.unload&&this.unload(b))},S.prototype.createElement=function(){throw new Error("nanocomponent: createElement should be implemented!")},S.prototype.update=function(){throw new Error("nanocomponent: update should be implemented!")},$i}var ji,Zf;function gm(){return Zf||(Zf=1,ji=ym()),ji}var _m=gm();const xm=wr(_m);var Er=function({regl:e,precision:t,label:n="",width:i,height:u}){this.regl=e,this.precision=t,this.label=n,this.positionBuffer=this.regl.buffer([[-2,0],[0,-2],[2,2]]),this.draw=()=>{},this.init(),this.pingPongIndex=0,this.fbos=Array(2).fill().map(()=>this.regl.framebuffer({color:this.regl.texture({mag:"nearest",width:i,height:u,format:"rgba"}),depthStencil:!1}))};Er.prototype.resize=function(e,t){this.fbos.forEach(n=>{n.resize(e,t)})};Er.prototype.getCurrent=function(){return this.fbos[this.pingPongIndex]};Er.prototype.getTexture=function(){var e=this.pingPongIndex?0:1;return this.fbos[e]};Er.prototype.init=function(){return this.transformIndex=0,this.fragHeader=`
  precision ${this.precision} float;

  uniform float time;
  varying vec2 uv;
  `,this.fragBody="",this.vert=`
  precision ${this.precision} float;
  attribute vec2 position;
  varying vec2 uv;

  void main () {
    uv = position;
    gl_Position = vec4(2.0 * position - 1.0, 0, 1);
  }`,this.attributes={position:this.positionBuffer},this.uniforms={time:this.regl.prop("time"),resolution:this.regl.prop("resolution")},this.frag=`
       ${this.fragHeader}

      void main () {
        vec4 c = vec4(0, 0, 0, 0);
        vec2 st = uv;
        ${this.fragBody}
        gl_FragColor = c;
      }
  `,this};Er.prototype.render=function(e){let t=e[0];var n=this,i=Object.assign(t.uniforms,{prevBuffer:()=>n.fbos[n.pingPongIndex]});n.draw=n.regl({frag:t.frag,vert:n.vert,attributes:n.attributes,uniforms:i,count:3,framebuffer:()=>(n.pingPongIndex=n.pingPongIndex?0:1,n.fbos[n.pingPongIndex])})};Er.prototype.tick=function(e){this.draw(e)};var Kn={exports:{}},Jf;function wm(){return Jf||(Jf=1,typeof Object.create=="function"?Kn.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:Kn.exports=function(t,n){if(n){t.super_=n;var i=function(){};i.prototype=n.prototype,t.prototype=new i,t.prototype.constructor=t}}),Kn.exports}var zi,es;function Em(){if(es)return zi;es=1;function e(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}zi=e,e.EventEmitter=e,e.prototype._events=void 0,e.prototype._maxListeners=void 0,e.defaultMaxListeners=10,e.prototype.setMaxListeners=function(o){if(!n(o)||o<0||isNaN(o))throw TypeError("n must be a positive number");return this._maxListeners=o,this},e.prototype.emit=function(o){var c,g,S,b,G,k;if(this._events||(this._events={}),o==="error"&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(c=arguments[1],c instanceof Error)throw c;var R=new Error('Uncaught, unspecified "error" event. ('+c+")");throw R.context=c,R}if(g=this._events[o],u(g))return!1;if(t(g))switch(arguments.length){case 1:g.call(this);break;case 2:g.call(this,arguments[1]);break;case 3:g.call(this,arguments[1],arguments[2]);break;default:b=Array.prototype.slice.call(arguments,1),g.apply(this,b)}else if(i(g))for(b=Array.prototype.slice.call(arguments,1),k=g.slice(),S=k.length,G=0;G<S;G++)k[G].apply(this,b);return!0},e.prototype.addListener=function(o,c){var g;if(!t(c))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",o,t(c.listener)?c.listener:c),this._events[o]?i(this._events[o])?this._events[o].push(c):this._events[o]=[this._events[o],c]:this._events[o]=c,i(this._events[o])&&!this._events[o].warned&&(u(this._maxListeners)?g=e.defaultMaxListeners:g=this._maxListeners,g&&g>0&&this._events[o].length>g&&(this._events[o].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[o].length),typeof console.trace=="function"&&console.trace())),this},e.prototype.on=e.prototype.addListener,e.prototype.once=function(o,c){if(!t(c))throw TypeError("listener must be a function");var g=!1;function S(){this.removeListener(o,S),g||(g=!0,c.apply(this,arguments))}return S.listener=c,this.on(o,S),this},e.prototype.removeListener=function(o,c){var g,S,b,G;if(!t(c))throw TypeError("listener must be a function");if(!this._events||!this._events[o])return this;if(g=this._events[o],b=g.length,S=-1,g===c||t(g.listener)&&g.listener===c)delete this._events[o],this._events.removeListener&&this.emit("removeListener",o,c);else if(i(g)){for(G=b;G-- >0;)if(g[G]===c||g[G].listener&&g[G].listener===c){S=G;break}if(S<0)return this;g.length===1?(g.length=0,delete this._events[o]):g.splice(S,1),this._events.removeListener&&this.emit("removeListener",o,c)}return this},e.prototype.removeAllListeners=function(o){var c,g;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[o]&&delete this._events[o],this;if(arguments.length===0){for(c in this._events)c!=="removeListener"&&this.removeAllListeners(c);return this.removeAllListeners("removeListener"),this._events={},this}if(g=this._events[o],t(g))this.removeListener(o,g);else if(g)for(;g.length;)this.removeListener(o,g[g.length-1]);return delete this._events[o],this},e.prototype.listeners=function(o){var c;return!this._events||!this._events[o]?c=[]:t(this._events[o])?c=[this._events[o]]:c=this._events[o].slice(),c},e.prototype.listenerCount=function(o){if(this._events){var c=this._events[o];if(t(c))return 1;if(c)return c.length}return 0},e.listenerCount=function(o,c){return o.listenerCount(c)};function t(o){return typeof o=="function"}function n(o){return typeof o=="number"}function i(o){return typeof o=="object"&&o!==null}function u(o){return o===void 0}return zi}var Ui,ts;function Am(){return ts||(ts=1,Ui=xr.performance&&xr.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}),Ui}var hn={exports:{}},_r={exports:{}},Tm=_r.exports,rs;function Sm(){return rs||(rs=1,(function(){var e,t,n,i,u,o;typeof performance<"u"&&performance!==null&&performance.now?_r.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(_r.exports=function(){return(e()-u)/1e6},t=process.hrtime,e=function(){var c;return c=t(),c[0]*1e9+c[1]},i=e(),o=process.uptime()*1e9,u=i-o):Date.now?(_r.exports=function(){return Date.now()-n},n=Date.now()):(_r.exports=function(){return new Date().getTime()-n},n=new Date().getTime())}).call(Tm)),_r.exports}var ns;function Rm(){if(ns)return hn.exports;ns=1;for(var e=Sm(),t=typeof window>"u"?xr:window,n=["moz","webkit"],i="AnimationFrame",u=t["request"+i],o=t["cancel"+i]||t["cancelRequest"+i],c=0;!u&&c<n.length;c++)u=t[n[c]+"Request"+i],o=t[n[c]+"Cancel"+i]||t[n[c]+"CancelRequest"+i];if(!u||!o){var g=0,S=0,b=[],G=1e3/60;u=function(k){if(b.length===0){var R=e(),A=Math.max(0,G-(R-g));g=A+R,setTimeout(function(){var O=b.slice(0);b.length=0;for(var q=0;q<O.length;q++)if(!O[q].cancelled)try{O[q].callback(g)}catch(ne){setTimeout(function(){throw ne},0)}},Math.round(A))}return b.push({handle:++S,callback:k,cancelled:!1}),S},o=function(k){for(var R=0;R<b.length;R++)b[R].handle===k&&(b[R].cancelled=!0)}}return hn.exports=function(k){return u.call(t,k)},hn.exports.cancel=function(){o.apply(t,arguments)},hn.exports.polyfill=function(k){k||(k=t),k.requestAnimationFrame=u,k.cancelAnimationFrame=o},hn.exports}var qi,as;function Lm(){if(as)return qi;as=1;var e=wm(),t=Em().EventEmitter,n=Am(),i=Rm();qi=u;function u(o){if(!(this instanceof u))return new u(o);this.running=!1,this.last=n(),this._frame=0,this._tick=this.tick.bind(this),o&&this.on("tick",o)}return e(u,t),u.prototype.start=function(){if(!this.running)return this.running=!0,this.last=n(),this._frame=i(this._tick),this},u.prototype.stop=function(){return this.running=!1,this._frame!==0&&i.cancel(this._frame),this._frame=0,this},u.prototype.tick=function(){this._frame=i(this._tick);var o=n(),c=o-this.last;this.emit("tick",c),this.last=o},qi}var Cm=Lm();const Om=wr(Cm);function Fm(e){return navigator.mediaDevices.enumerateDevices().then(t=>t.filter(n=>n.kind==="videoinput")).then(t=>{let n={audio:!1,video:!0};return t[e]&&(n.video={deviceId:{exact:t[e].deviceId}}),window.navigator.mediaDevices.getUserMedia(n)}).then(t=>{const n=document.createElement("video");return n.setAttribute("autoplay",""),n.setAttribute("muted",""),n.setAttribute("playsinline",""),n.srcObject=t,new Promise((i,u)=>{n.addEventListener("loadedmetadata",()=>{n.play().then(()=>i({video:n}))})})}).catch(console.log.bind(console))}function Dm(e){return new Promise(function(t,n){navigator.mediaDevices.getDisplayMedia(e).then(i=>{const u=document.createElement("video");u.srcObject=i,u.addEventListener("loadedmetadata",()=>{u.play(),t({video:u})})}).catch(i=>n(i))})}class km{constructor({regl:t,width:n,height:i,pb:u,label:o=""}){this.label=o,this.regl=t,this.src=null,this.dynamic=!0,this.width=n,this.height=i,this.tex=this.regl.texture({shape:[1,1]}),this.pb=u}init(t,n){"src"in t&&(this.src=t.src,this.tex=this.regl.texture({data:this.src,...n})),"dynamic"in t&&(this.dynamic=t.dynamic)}initCam(t,n){const i=this;Fm(t).then(u=>{i.src=u.video,i.dynamic=!0,i.tex=i.regl.texture({data:i.src,...n})}).catch(u=>console.log("could not get camera",u))}initVideo(t="",n){const i=document.createElement("video");i.crossOrigin="anonymous",i.autoplay=!0,i.loop=!0,i.muted=!0,i.addEventListener("loadeddata",()=>{this.src=i,i.play(),this.tex=this.regl.texture({data:this.src,...n}),this.dynamic=!0}),i.src=t}initImage(t="",n){const i=document.createElement("img");i.crossOrigin="anonymous",i.src=t,i.onload=()=>{this.src=i,this.dynamic=!1,this.tex=this.regl.texture({data:this.src,...n})}}initStream(t,n){let i=this;t&&this.pb&&(this.pb.initSource(t),this.pb.on("got video",function(u,o){u===t&&(i.src=o,i.dynamic=!0,i.tex=i.regl.texture({data:i.src,...n}))}))}initScreen(t=0,n){const i=this;Dm().then(function(u){i.src=u.video,i.tex=i.regl.texture({data:i.src,...n}),i.dynamic=!0}).catch(u=>console.log("could not get screen",u))}resize(t,n){this.width=t,this.height=n}clear(){this.src&&this.src.srcObject&&this.src.srcObject.getTracks&&this.src.srcObject.getTracks().forEach(t=>t.stop()),this.src=null,this.tex=this.regl.texture({shape:[1,1]})}tick(t){this.src!==null&&this.dynamic===!0&&(this.src.videoWidth&&this.src.videoWidth!==this.tex.width&&(console.log(this.src.videoWidth,this.src.videoHeight,this.tex.width,this.tex.height),this.tex.resize(this.src.videoWidth,this.src.videoHeight)),this.src.width&&this.src.width!==this.tex.width&&this.tex.resize(this.src.width,this.src.height),this.tex.subimage(this.src))}getTexture(){return this.tex}}const tr={};function Mm(e){if(typeof e=="object"){if("buttons"in e)return e.buttons;if("which"in e){var t=e.which;if(t===2)return 4;if(t===3)return 2;if(t>0)return 1<<t-1}else if("button"in e){var t=e.button;if(t===1)return 4;if(t===2)return 2;if(t>=0)return 1<<t}}return 0}tr.buttons=Mm;function Gm(e){return e.target||e.srcElement||window}tr.element=Gm;function Im(e){return typeof e=="object"&&"pageX"in e?e.pageX:0}tr.x=Im;function Nm(e){return typeof e=="object"&&"pageY"in e?e.pageY:0}tr.y=Nm;function Bm(e,t){t||(t=e,e=window);var n=0,i=0,u=0,o={shift:!1,alt:!1,control:!1,meta:!1},c=!1;function g(me){var Ee=!1;return"altKey"in me&&(Ee=Ee||me.altKey!==o.alt,o.alt=!!me.altKey),"shiftKey"in me&&(Ee=Ee||me.shiftKey!==o.shift,o.shift=!!me.shiftKey),"ctrlKey"in me&&(Ee=Ee||me.ctrlKey!==o.control,o.control=!!me.ctrlKey),"metaKey"in me&&(Ee=Ee||me.metaKey!==o.meta,o.meta=!!me.metaKey),Ee}function S(me,Ee){var Ve=tr.x(Ee),rt=tr.y(Ee);"buttons"in Ee&&(me=Ee.buttons|0),(me!==n||Ve!==i||rt!==u||g(Ee))&&(n=me|0,i=Ve||0,u=rt||0,t&&t(n,i,u,o))}function b(me){S(0,me)}function G(){(n||i||u||o.shift||o.alt||o.meta||o.control)&&(i=u=0,n=0,o.shift=o.alt=o.control=o.meta=!1,t&&t(0,0,0,o))}function k(me){g(me)&&t&&t(n,i,u,o)}function R(me){tr.buttons(me)===0?S(0,me):S(n,me)}function A(me){S(n|tr.buttons(me),me)}function O(me){S(n&~tr.buttons(me),me)}function q(){c||(c=!0,e.addEventListener("mousemove",R),e.addEventListener("mousedown",A),e.addEventListener("mouseup",O),e.addEventListener("mouseleave",b),e.addEventListener("mouseenter",b),e.addEventListener("mouseout",b),e.addEventListener("mouseover",b),e.addEventListener("blur",G),e.addEventListener("keyup",k),e.addEventListener("keydown",k),e.addEventListener("keypress",k),e!==window&&(window.addEventListener("blur",G),window.addEventListener("keyup",k),window.addEventListener("keydown",k),window.addEventListener("keypress",k)))}function ne(){c&&(c=!1,e.removeEventListener("mousemove",R),e.removeEventListener("mousedown",A),e.removeEventListener("mouseup",O),e.removeEventListener("mouseleave",b),e.removeEventListener("mouseenter",b),e.removeEventListener("mouseout",b),e.removeEventListener("mouseover",b),e.removeEventListener("blur",G),e.removeEventListener("keyup",k),e.removeEventListener("keydown",k),e.removeEventListener("keypress",k),e!==window&&(window.removeEventListener("blur",G),window.removeEventListener("keyup",k),window.removeEventListener("keydown",k),window.removeEventListener("keypress",k)))}q();var _e={element:e};return Object.defineProperties(_e,{enabled:{get:function(){return c},set:function(me){me?q():ne()},enumerable:!0},buttons:{get:function(){return n},enumerable:!0},x:{get:function(){return i},enumerable:!0},y:{get:function(){return u},enumerable:!0},mods:{get:function(){return o},enumerable:!0}}),_e}var ea={exports:{}},Vi,is;function Pm(){if(is)return Vi;is=1;var e=null,t=function(i){e=e||{},e[i]=new Array(i*i);for(var u=Math.PI/i,o=0;o<i;o++)for(var c=0;c<i;c++)e[i][c+o*i]=Math.cos(u*(c+.5)*o)};function n(i,u){var o=i.length;u=u||2,(!e||!e[o])&&t(o);var c=i.map(function(){return 0});return c.map(function(g,S){return u*i.reduce(function(b,G,k,R){return b+G*e[o][k+S*o]},0)})}return Vi=n,Vi}var Hi,us;function $m(){return us||(us=1,Hi=Pm()),Hi}var Xi,os;function jm(){if(os)return Xi;os=1;function e(G){if(Array.isArray(G)){for(var k=0,R=Array(G.length);k<G.length;k++)R[k]=G[k];return R}else return Array.from(G)}var t={},n={},i=function(k){var R={};R.real=k.real===void 0?k.slice():k.real.slice();var A=R.real.length;return n[A]===void 0&&(n[A]=Array.apply(null,Array(A)).map(Number.prototype.valueOf,0)),R.imag=n[A].slice(),R},u=function(k){if(t[k]===void 0){for(var R=(k-1).toString(2).length,A="0".repeat(R),O={},q=0;q<k;q++){var ne=q.toString(2);ne=A.substr(ne.length)+ne,ne=[].concat(e(ne)).reverse().join(""),O[q]=parseInt(ne,2)}t[k]=O}return t[k]},o=function(k,R){return{real:k.real*R.real-k.imag*R.imag,imag:k.real*R.imag+k.imag*R.real}},c=function(k,R){return{real:k.real+R.real,imag:k.imag+R.imag}},g=function(k,R){return{real:k.real-R.real,imag:k.imag-R.imag}},S=function(k,R){var A=-2*Math.PI*k/R;return{real:Math.cos(A),imag:Math.sin(A)}},b=function(k){return k.imag*=-1,k};return Xi={bitReverseArray:u,multiply:o,add:c,subtract:g,euler:S,conj:b,constructComplexArray:i},Xi}var Wi,fs;function zm(){if(fs)return Wi;fs=1;var e=jm(),t=function(u){var o={};u.real===void 0||u.imag===void 0?o=e.constructComplexArray(u):(o.real=u.real.slice(),o.imag=u.imag.slice());var c=o.real.length,g=Math.log2(c);if(Math.round(g)!=g)throw new Error("Input size must be a power of 2.");if(o.real.length!=o.imag.length)throw new Error("Real and imaginary components must have the same length.");for(var S=e.bitReverseArray(c),b={real:[],imag:[]},G=0;G<c;G++)b.real[S[G]]=o.real[G],b.imag[S[G]]=o.imag[G];for(var k=0;k<c;k++)o.real[k]=b.real[k],o.imag[k]=b.imag[k];for(var R=1;R<=g;R++)for(var A=Math.pow(2,R),O=0;O<A/2;O++)for(var q=e.euler(O,A),ne=0;ne<c/A;ne++){var _e=A*ne+O,me=A*ne+O+A/2,Ee={real:o.real[_e],imag:o.imag[_e]},Ve={real:o.real[me],imag:o.imag[me]},rt=e.multiply(q,Ve),P=e.subtract(Ee,rt);o.real[me]=P.real,o.imag[me]=P.imag;var p=e.add(rt,Ee);o.real[_e]=p.real,o.imag[_e]=p.imag}return o},n=function(u){if(u.real===void 0||u.imag===void 0)throw new Error("IFFT only accepts a complex input.");for(var o=u.real.length,c={real:[],imag:[]},g=0;g<o;g++){var S={real:u.real[g],imag:u.imag[g]},b=e.conj(S);c.real[g]=b.real,c.imag[g]=b.imag}var G=t(c);return c.real=G.real.map(function(k){return k/o}),c.imag=G.imag.map(function(k){return k/o}),c};return Wi={fft:t,ifft:n},Wi}var Um=ea.exports,ss;function qm(){return ss||(ss=1,function(e,t){(function(n,i){e.exports=i($m(),zm())})(Um,function(n,i){function u(P,p,C){for(var $,W=0,re=p.length;W<re;W++)!$&&W in p||($||($=Array.prototype.slice.call(p,0,W)),$[W]=p[W]);return P.concat($||Array.prototype.slice.call(p))}var o=Object.freeze({__proto__:null,blackman:function(P){for(var p=new Float32Array(P),C=2*Math.PI/(P-1),$=2*C,W=0;W<P/2;W++)p[W]=.42-.5*Math.cos(W*C)+.08*Math.cos(W*$);for(W=Math.ceil(P/2);W>0;W--)p[P-W]=p[W-1];return p},hamming:function(P){for(var p=new Float32Array(P),C=0;C<P;C++)p[C]=.54-.46*Math.cos(2*Math.PI*(C/P-1));return p},hanning:function(P){for(var p=new Float32Array(P),C=0;C<P;C++)p[C]=.5-.5*Math.cos(2*Math.PI*C/(P-1));return p},sine:function(P){for(var p=Math.PI/(P-1),C=new Float32Array(P),$=0;$<P;$++)C[$]=Math.sin(p*$);return C}}),c={};function g(P){for(;P%2==0&&P>1;)P/=2;return P===1}function S(P,p){if(p!=="rect"){if(p!==""&&p||(p="hanning"),c[p]||(c[p]={}),!c[p][P.length])try{c[p][P.length]=o[p](P.length)}catch{throw new Error("Invalid windowing function")}P=function(C,$){for(var W=[],re=0;re<Math.min(C.length,$.length);re++)W[re]=C[re]*$[re];return W}(P,c[p][P.length])}return P}function b(P,p,C){for(var $=new Float32Array(P),W=0;W<$.length;W++)$[W]=W*p/C,$[W]=13*Math.atan($[W]/1315.8)+3.5*Math.atan(Math.pow($[W]/7518,2));return $}function G(P){return Float32Array.from(P)}function k(P){return 1125*Math.log(1+P/700)}function R(P,p,C){for(var $,W=new Float32Array(P+2),re=new Float32Array(P+2),Ie=p/2,Oe=k(0),Se=(k(Ie)-Oe)/(P+1),Le=new Array(P+2),Ge=0;Ge<W.length;Ge++)W[Ge]=Ge*Se,re[Ge]=($=W[Ge],700*(Math.exp($/1125)-1)),Le[Ge]=Math.floor((C+1)*re[Ge]/p);for(var Ue=new Array(P),Me=0;Me<Ue.length;Me++){for(Ue[Me]=new Array(C/2+1).fill(0),Ge=Le[Me];Ge<Le[Me+1];Ge++)Ue[Me][Ge]=(Ge-Le[Me])/(Le[Me+1]-Le[Me]);for(Ge=Le[Me+1];Ge<Le[Me+2];Ge++)Ue[Me][Ge]=(Le[Me+2]-Ge)/(Le[Me+2]-Le[Me+1])}return Ue}function A(P,p,C,$,W,re,Ie){$===void 0&&($=5),W===void 0&&(W=2),re===void 0&&(re=!0),Ie===void 0&&(Ie=440);var Oe=Math.floor(C/2)+1,Se=new Array(C).fill(0).map(function(ft,Rt){return P*function(Ft,tt){return Math.log2(16*Ft/tt)}(p*Rt/C,Ie)});Se[0]=Se[1]-1.5*P;var Le,Ge,Ue,Me=Se.slice(1).map(function(ft,Rt){return Math.max(ft-Se[Rt])},1).concat([1]),Ct=Math.round(P/2),ot=new Array(P).fill(0).map(function(ft,Rt){return Se.map(function(Ft){return(10*P+Ct+Ft-Rt)%P-Ct})}),Je=ot.map(function(ft,Rt){return ft.map(function(Ft,tt){return Math.exp(-.5*Math.pow(2*ot[Rt][tt]/Me[tt],2))})});if(Ge=(Le=Je)[0].map(function(){return 0}),Ue=Le.reduce(function(ft,Rt){return Rt.forEach(function(Ft,tt){ft[tt]+=Math.pow(Ft,2)}),ft},Ge).map(Math.sqrt),Je=Le.map(function(ft,Rt){return ft.map(function(Ft,tt){return Ft/(Ue[tt]||1)})}),W){var Mt=Se.map(function(ft){return Math.exp(-.5*Math.pow((ft/P-$)/W,2))});Je=Je.map(function(ft){return ft.map(function(Rt,Ft){return Rt*Mt[Ft]})})}return re&&(Je=u(u([],Je.slice(3),!0),Je.slice(0,3))),Je.map(function(ft){return ft.slice(0,Oe)})}function O(P,p){for(var C=0,$=0,W=0;W<p.length;W++)C+=Math.pow(W,P)*Math.abs(p[W]),$+=p[W];return C/$}function q(P){var p=P.ampSpectrum,C=P.barkScale,$=P.numberOfBarkBands,W=$===void 0?24:$;if(typeof p!="object"||typeof C!="object")throw new TypeError;var re=W,Ie=new Float32Array(re),Oe=0,Se=p,Le=new Int32Array(re+1);Le[0]=0;for(var Ge=C[Se.length-1]/re,Ue=1,Me=0;Me<Se.length;Me++)for(;C[Me]>Ge;)Le[Ue++]=Me,Ge=Ue*C[Se.length-1]/re;for(Le[re]=Se.length-1,Me=0;Me<re;Me++){for(var Ct=0,ot=Le[Me];ot<Le[Me+1];ot++)Ct+=Se[ot];Ie[Me]=Math.pow(Ct,.23)}for(Me=0;Me<Ie.length;Me++)Oe+=Ie[Me];return{specific:Ie,total:Oe}}function ne(P){var p=P.ampSpectrum;if(typeof p!="object")throw new TypeError;for(var C=new Float32Array(p.length),$=0;$<C.length;$++)C[$]=Math.pow(p[$],2);return C}function _e(P){var p=P.ampSpectrum,C=P.melFilterBank,$=P.bufferSize;if(typeof p!="object")throw new TypeError("Valid ampSpectrum is required to generate melBands");if(typeof C!="object")throw new TypeError("Valid melFilterBank is required to generate melBands");for(var W=ne({ampSpectrum:p}),re=C.length,Ie=Array(re),Oe=new Float32Array(re),Se=0;Se<Oe.length;Se++){Ie[Se]=new Float32Array($/2),Oe[Se]=0;for(var Le=0;Le<$/2;Le++)Ie[Se][Le]=C[Se][Le]*W[Le],Oe[Se]+=Ie[Se][Le];Oe[Se]=Math.log(Oe[Se]+1)}return Array.prototype.slice.call(Oe)}var me=Object.freeze({__proto__:null,amplitudeSpectrum:function(P){return P.ampSpectrum},buffer:function(P){return P.signal},chroma:function(P){var p=P.ampSpectrum,C=P.chromaFilterBank;if(typeof p!="object")throw new TypeError("Valid ampSpectrum is required to generate chroma");if(typeof C!="object")throw new TypeError("Valid chromaFilterBank is required to generate chroma");var $=C.map(function(re,Ie){return p.reduce(function(Oe,Se,Le){return Oe+Se*re[Le]},0)}),W=Math.max.apply(Math,$);return W?$.map(function(re){return re/W}):$},complexSpectrum:function(P){return P.complexSpectrum},energy:function(P){var p=P.signal;if(typeof p!="object")throw new TypeError;for(var C=0,$=0;$<p.length;$++)C+=Math.pow(Math.abs(p[$]),2);return C},loudness:q,melBands:_e,mfcc:function(P){var p=P.ampSpectrum,C=P.melFilterBank,$=P.numberOfMFCCCoefficients,W=P.bufferSize,re=Math.min(40,Math.max(1,$||13));if(C.length<re)throw new Error("Insufficient filter bank for requested number of coefficients");var Ie=_e({ampSpectrum:p,melFilterBank:C,bufferSize:W});return n(Ie).slice(0,re)},perceptualSharpness:function(P){for(var p=q({ampSpectrum:P.ampSpectrum,barkScale:P.barkScale}),C=p.specific,$=0,W=0;W<C.length;W++)$+=W<15?(W+1)*C[W+1]:.066*Math.exp(.171*(W+1));return $*=.11/p.total},perceptualSpread:function(P){for(var p=q({ampSpectrum:P.ampSpectrum,barkScale:P.barkScale}),C=0,$=0;$<p.specific.length;$++)p.specific[$]>C&&(C=p.specific[$]);return Math.pow((p.total-C)/p.total,2)},powerSpectrum:ne,rms:function(P){var p=P.signal;if(typeof p!="object")throw new TypeError;for(var C=0,$=0;$<p.length;$++)C+=Math.pow(p[$],2);return C/=p.length,C=Math.sqrt(C)},spectralCentroid:function(P){var p=P.ampSpectrum;if(typeof p!="object")throw new TypeError;return O(1,p)},spectralCrest:function(P){var p=P.ampSpectrum;if(typeof p!="object")throw new TypeError;var C=0,$=-1/0;return p.forEach(function(W){C+=Math.pow(W,2),$=W>$?W:$}),C/=p.length,C=Math.sqrt(C),$/C},spectralFlatness:function(P){var p=P.ampSpectrum;if(typeof p!="object")throw new TypeError;for(var C=0,$=0,W=0;W<p.length;W++)C+=Math.log(p[W]),$+=p[W];return Math.exp(C/p.length)*p.length/$},spectralFlux:function(P){var p=P.signal,C=P.previousSignal,$=P.bufferSize;if(typeof p!="object"||typeof C!="object")throw new TypeError;for(var W=0,re=-$/2;re<p.length/2-1;re++)x=Math.abs(p[re])-Math.abs(C[re]),W+=(x+Math.abs(x))/2;return W},spectralKurtosis:function(P){var p=P.ampSpectrum;if(typeof p!="object")throw new TypeError;var C=p,$=O(1,C),W=O(2,C),re=O(3,C),Ie=O(4,C);return(-3*Math.pow($,4)+6*$*W-4*$*re+Ie)/Math.pow(Math.sqrt(W-Math.pow($,2)),4)},spectralRolloff:function(P){var p=P.ampSpectrum,C=P.sampleRate;if(typeof p!="object")throw new TypeError;for(var $=p,W=C/(2*($.length-1)),re=0,Ie=0;Ie<$.length;Ie++)re+=$[Ie];for(var Oe=.99*re,Se=$.length-1;re>Oe&&Se>=0;)re-=$[Se],--Se;return(Se+1)*W},spectralSkewness:function(P){var p=P.ampSpectrum;if(typeof p!="object")throw new TypeError;var C=O(1,p),$=O(2,p),W=O(3,p);return(2*Math.pow(C,3)-3*C*$+W)/Math.pow(Math.sqrt($-Math.pow(C,2)),3)},spectralSlope:function(P){var p=P.ampSpectrum,C=P.sampleRate,$=P.bufferSize;if(typeof p!="object")throw new TypeError;for(var W=0,re=0,Ie=new Float32Array(p.length),Oe=0,Se=0,Le=0;Le<p.length;Le++){W+=p[Le];var Ge=Le*C/$;Ie[Le]=Ge,Oe+=Ge*Ge,re+=Ge,Se+=Ge*p[Le]}return(p.length*Se-re*W)/(W*(Oe-Math.pow(re,2)))},spectralSpread:function(P){var p=P.ampSpectrum;if(typeof p!="object")throw new TypeError;return Math.sqrt(O(2,p)-Math.pow(O(1,p),2))},zcr:function(P){var p=P.signal;if(typeof p!="object")throw new TypeError;for(var C=0,$=1;$<p.length;$++)(p[$-1]>=0&&p[$]<0||p[$-1]<0&&p[$]>=0)&&C++;return C}}),Ee=function(){function P(p,C){var $=this;if(this._m=C,!p.audioContext)throw this._m.errors.noAC;if(p.bufferSize&&!g(p.bufferSize))throw this._m._errors.notPow2;if(!p.source)throw this._m._errors.noSource;this._m.audioContext=p.audioContext,this._m.bufferSize=p.bufferSize||this._m.bufferSize||256,this._m.hopSize=p.hopSize||this._m.hopSize||this._m.bufferSize,this._m.sampleRate=p.sampleRate||this._m.audioContext.sampleRate||44100,this._m.callback=p.callback,this._m.windowingFunction=p.windowingFunction||"hanning",this._m.featureExtractors=me,this._m.EXTRACTION_STARTED=p.startImmediately||!1,this._m.channel=typeof p.channel=="number"?p.channel:0,this._m.inputs=p.inputs||1,this._m.outputs=p.outputs||1,this._m.numberOfMFCCCoefficients=p.numberOfMFCCCoefficients||this._m.numberOfMFCCCoefficients||13,this._m.numberOfBarkBands=p.numberOfBarkBands||this._m.numberOfBarkBands||24,this._m.spn=this._m.audioContext.createScriptProcessor(this._m.bufferSize,this._m.inputs,this._m.outputs),this._m.spn.connect(this._m.audioContext.destination),this._m._featuresToExtract=p.featureExtractors||[],this._m.barkScale=b(this._m.bufferSize,this._m.sampleRate,this._m.bufferSize),this._m.melFilterBank=R(Math.max(this._m.melBands,this._m.numberOfMFCCCoefficients),this._m.sampleRate,this._m.bufferSize),this._m.inputData=null,this._m.previousInputData=null,this._m.frame=null,this._m.previousFrame=null,this.setSource(p.source),this._m.spn.onaudioprocess=function(W){var re;$._m.inputData!==null&&($._m.previousInputData=$._m.inputData),$._m.inputData=W.inputBuffer.getChannelData($._m.channel),$._m.previousInputData?((re=new Float32Array($._m.previousInputData.length+$._m.inputData.length-$._m.hopSize)).set($._m.previousInputData.slice($._m.hopSize)),re.set($._m.inputData,$._m.previousInputData.length-$._m.hopSize)):re=$._m.inputData;var Ie=function(Oe,Se,Le){if(Oe.length<Se)throw new Error("Buffer is too short for frame length");if(Le<1)throw new Error("Hop length cannot be less that 1");if(Se<1)throw new Error("Frame length cannot be less that 1");var Ge=1+Math.floor((Oe.length-Se)/Le);return new Array(Ge).fill(0).map(function(Ue,Me){return Oe.slice(Me*Le,Me*Le+Se)})}(re,$._m.bufferSize,$._m.hopSize);Ie.forEach(function(Oe){$._m.frame=Oe;var Se=$._m.extract($._m._featuresToExtract,$._m.frame,$._m.previousFrame);typeof $._m.callback=="function"&&$._m.EXTRACTION_STARTED&&$._m.callback(Se),$._m.previousFrame=$._m.frame})}}return P.prototype.start=function(p){this._m._featuresToExtract=p||this._m._featuresToExtract,this._m.EXTRACTION_STARTED=!0},P.prototype.stop=function(){this._m.EXTRACTION_STARTED=!1},P.prototype.setSource=function(p){this._m.source&&this._m.source.disconnect(this._m.spn),this._m.source=p,this._m.source.connect(this._m.spn)},P.prototype.setChannel=function(p){p<=this._m.inputs?this._m.channel=p:console.error("Channel ".concat(p," does not exist. Make sure you've provided a value for 'inputs' that is greater than ").concat(p," when instantiating the MeydaAnalyzer"))},P.prototype.get=function(p){return this._m.inputData?this._m.extract(p||this._m._featuresToExtract,this._m.inputData,this._m.previousInputData):null},P}(),Ve={audioContext:null,spn:null,bufferSize:512,sampleRate:44100,melBands:26,chromaBands:12,callback:null,windowingFunction:"hanning",featureExtractors:me,EXTRACTION_STARTED:!1,numberOfMFCCCoefficients:13,numberOfBarkBands:24,_featuresToExtract:[],windowing:S,_errors:{notPow2:new Error("Meyda: Buffer size must be a power of 2, e.g. 64 or 512"),featureUndef:new Error("Meyda: No features defined."),invalidFeatureFmt:new Error("Meyda: Invalid feature format"),invalidInput:new Error("Meyda: Invalid input."),noAC:new Error("Meyda: No AudioContext specified."),noSource:new Error("Meyda: No source node specified.")},createMeydaAnalyzer:function(P){return new Ee(P,Object.assign({},Ve))},listAvailableFeatureExtractors:function(){return Object.keys(this.featureExtractors)},extract:function(P,p,C){var $=this;if(!p)throw this._errors.invalidInput;if(typeof p!="object")throw this._errors.invalidInput;if(!P)throw this._errors.featureUndef;if(!g(p.length))throw this._errors.notPow2;this.barkScale!==void 0&&this.barkScale.length==this.bufferSize||(this.barkScale=b(this.bufferSize,this.sampleRate,this.bufferSize)),this.melFilterBank!==void 0&&this.barkScale.length==this.bufferSize&&this.melFilterBank.length==this.melBands||(this.melFilterBank=R(Math.max(this.melBands,this.numberOfMFCCCoefficients),this.sampleRate,this.bufferSize)),this.chromaFilterBank!==void 0&&this.chromaFilterBank.length==this.chromaBands||(this.chromaFilterBank=A(this.chromaBands,this.sampleRate,this.bufferSize)),"buffer"in p&&p.buffer===void 0?this.signal=G(p):this.signal=p;var W=rt(p,this.windowingFunction,this.bufferSize);if(this.signal=W.windowedSignal,this.complexSpectrum=W.complexSpectrum,this.ampSpectrum=W.ampSpectrum,C){var re=rt(C,this.windowingFunction,this.bufferSize);this.previousSignal=re.windowedSignal,this.previousComplexSpectrum=re.complexSpectrum,this.previousAmpSpectrum=re.ampSpectrum}var Ie=function(Oe){return $.featureExtractors[Oe]({ampSpectrum:$.ampSpectrum,chromaFilterBank:$.chromaFilterBank,complexSpectrum:$.complexSpectrum,signal:$.signal,bufferSize:$.bufferSize,sampleRate:$.sampleRate,barkScale:$.barkScale,melFilterBank:$.melFilterBank,previousSignal:$.previousSignal,previousAmpSpectrum:$.previousAmpSpectrum,previousComplexSpectrum:$.previousComplexSpectrum,numberOfMFCCCoefficients:$.numberOfMFCCCoefficients,numberOfBarkBands:$.numberOfBarkBands})};if(typeof P=="object")return P.reduce(function(Oe,Se){var Le;return Object.assign({},Oe,((Le={})[Se]=Ie(Se),Le))},{});if(typeof P=="string")return Ie(P);throw this._errors.invalidFeatureFmt}},rt=function(P,p,C){var $={};P.buffer===void 0?$.signal=G(P):$.signal=P,$.windowedSignal=S($.signal,p),$.complexSpectrum=i.fft($.windowedSignal),$.ampSpectrum=new Float32Array(C/2);for(var W=0;W<C/2;W++)$.ampSpectrum[W]=Math.sqrt(Math.pow($.complexSpectrum.real[W],2)+Math.pow($.complexSpectrum.imag[W],2));return $};return typeof window<"u"&&(window.Meyda=Ve),Ve})}(ea)),ea.exports}var Vm=qm();const Hm=wr(Vm);class Xm{constructor({numBins:t=4,cutoff:n=2,smooth:i=.4,max:u=15,scale:o=10,isDrawing:c=!1,parentEl:g=document.body}){this.vol=0,this.scale=o,this.max=u,this.cutoff=n,this.smooth=i,this.setBins(t),this.beat={holdFrames:20,threshold:40,_cutoff:0,decay:.98,_framesSinceBeat:0},this.onBeat=()=>{},this.canvas=document.createElement("canvas"),this.canvas.width=100,this.canvas.height=80,this.canvas.style.width="100px",this.canvas.style.height="80px",this.canvas.style.position="absolute",this.canvas.style.right="0px",this.canvas.style.bottom="0px",g.appendChild(this.canvas),this.isDrawing=c,this.ctx=this.canvas.getContext("2d"),this.ctx.fillStyle="#DFFFFF",this.ctx.strokeStyle="#0ff",this.ctx.lineWidth=.5,window.navigator.mediaDevices&&window.navigator.mediaDevices.getUserMedia({video:!1,audio:!0}).then(S=>{this.stream=S,this.context=new AudioContext;let b=this.context.createMediaStreamSource(S);this.meyda=Hm.createMeydaAnalyzer({audioContext:this.context,source:b,featureExtractors:["loudness"]})}).catch(S=>console.log("ERROR",S))}detectBeat(t){t>this.beat._cutoff&&t>this.beat.threshold?(this.onBeat(),this.beat._cutoff=t*1.2,this.beat._framesSinceBeat=0):this.beat._framesSinceBeat<=this.beat.holdFrames?this.beat._framesSinceBeat++:(this.beat._cutoff*=this.beat.decay,this.beat._cutoff=Math.max(this.beat._cutoff,this.beat.threshold))}tick(){if(this.meyda){var t=this.meyda.get();if(t&&t!==null){this.vol=t.loudness.total,this.detectBeat(this.vol);const n=(u,o)=>u+o;let i=Math.floor(t.loudness.specific.length/this.bins.length);this.prevBins=this.bins.slice(0),this.bins=this.bins.map((u,o)=>t.loudness.specific.slice(o*i,(o+1)*i).reduce(n)).map((u,o)=>u*(1-this.settings[o].smooth)+this.prevBins[o]*this.settings[o].smooth),this.fft=this.bins.map((u,o)=>Math.max(0,(u-this.settings[o].cutoff)/this.settings[o].scale)),this.isDrawing&&this.draw()}}}setCutoff(t){this.cutoff=t,this.settings=this.settings.map(n=>(n.cutoff=t,n))}setSmooth(t){this.smooth=t,this.settings=this.settings.map(n=>(n.smooth=t,n))}setBins(t){this.bins=Array(t).fill(0),this.prevBins=Array(t).fill(0),this.fft=Array(t).fill(0),this.settings=Array(t).fill(0).map(()=>({cutoff:this.cutoff,scale:this.scale,smooth:this.smooth})),this.bins.forEach((n,i)=>{window["a"+i]=(u=1,o=0)=>()=>a.fft[i]*u+o})}setScale(t){this.scale=t,this.settings=this.settings.map(n=>(n.scale=t,n))}setMax(t){this.max=t,console.log("set max is deprecated")}hide(){this.isDrawing=!1,this.canvas.style.display="none"}show(){this.isDrawing=!0,this.canvas.style.display="block"}draw(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);var t=this.canvas.width/this.bins.length,n=this.canvas.height/(this.max*2);this.bins.forEach((i,u)=>{var o=i*n;this.ctx.fillRect(u*t,this.canvas.height-o,t,o);var c=this.canvas.height-n*this.settings[u].cutoff;this.ctx.beginPath(),this.ctx.moveTo(u*t,c),this.ctx.lineTo((u+1)*t,c),this.ctx.stroke();var g=this.canvas.height-n*(this.settings[u].scale+this.settings[u].cutoff);this.ctx.beginPath(),this.ctx.moveTo(u*t,g),this.ctx.lineTo((u+1)*t,g),this.ctx.stroke()})}}class Wm{constructor(t){this.mediaSource=new MediaSource,this.stream=t,this.output=document.createElement("video"),this.output.autoplay=!0,this.output.loop=!0;let n=this;this.mediaSource.addEventListener("sourceopen",()=>{console.log("MediaSource opened"),n.sourceBuffer=n.mediaSource.addSourceBuffer('video/webm; codecs="vp8"'),console.log("Source buffer: ",sourceBuffer)})}start(){let t={mimeType:"video/webm;codecs=vp9"};this.recordedBlobs=[];try{this.mediaRecorder=new MediaRecorder(this.stream,t)}catch(n){console.log("Unable to create MediaRecorder with options Object: ",n);try{t={mimeType:"video/webm,codecs=vp9"},this.mediaRecorder=new MediaRecorder(this.stream,t)}catch(i){console.log("Unable to create MediaRecorder with options Object: ",i);try{t="video/vp8",this.mediaRecorder=new MediaRecorder(this.stream,t)}catch(u){alert(`MediaRecorder is not supported by this browser.

Try Firefox 29 or later, or Chrome 47 or later, with Enable experimental Web Platform features enabled from chrome://flags.`),console.error("Exception while creating MediaRecorder:",u);return}}}console.log("Created MediaRecorder",this.mediaRecorder,"with options",t),this.mediaRecorder.onstop=this._handleStop.bind(this),this.mediaRecorder.ondataavailable=this._handleDataAvailable.bind(this),this.mediaRecorder.start(100),console.log("MediaRecorder started",this.mediaRecorder)}stop(){this.mediaRecorder.stop()}_handleStop(){const t=new Blob(this.recordedBlobs,{type:this.mediaRecorder.mimeType}),n=window.URL.createObjectURL(t);this.output.src=n;const i=document.createElement("a");i.style.display="none",i.href=n;let u=new Date;i.download=`hydra-${u.getFullYear()}-${u.getMonth()+1}-${u.getDate()}-${u.getHours()}.${u.getMinutes()}.${u.getSeconds()}.webm`,document.body.appendChild(i),i.click(),setTimeout(()=>{document.body.removeChild(i),window.URL.revokeObjectURL(n)},300)}_handleDataAvailable(t){t.data&&t.data.size>0&&this.recordedBlobs.push(t.data)}}const Yi={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return e*(2-e)},easeInOutQuad:function(e){return e<.5?2*e*e:-1+(4-2*e)*e},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return--e*e*e+1},easeInOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1- --e*e*e*e},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1+--e*e*e*e*e},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e},sin:function(e){return(1+Math.sin(Math.PI*e-Math.PI/2))/2}};var Ym=(e,t,n,i,u)=>(e-t)*(u-i)/(n-t)+i;const Ts={init:()=>{Array.prototype.fast=function(e=1){return this._speed=e,this},Array.prototype.smooth=function(e=1){return this._smooth=e,this},Array.prototype.ease=function(e="linear"){return typeof e=="function"?(this._smooth=1,this._ease=e):Yi[e]&&(this._smooth=1,this._ease=Yi[e]),this},Array.prototype.offset=function(e=.5){return this._offset=e%1,this},Array.prototype.fit=function(e=0,t=1){let n=Math.min(...this),i=Math.max(...this);var u=this.map(o=>Ym(o,n,i,e,t));return u._speed=this._speed,u._smooth=this._smooth,u._ease=this._ease,u}},getValue:(e=[])=>({time:t,bpm:n})=>{let i=e._speed?e._speed:1,u=e._smooth?e._smooth:0,o=t*i*(n/60)+(e._offset||0);if(u!==0){let c=e._ease?e._ease:Yi.linear,g=o-u/2,S=e[Math.floor(g%e.length)],b=e[Math.floor((g+1)%e.length)],G=Math.min(g%1/u,1);return c(G)*(b-S)+S}else return e[Math.floor(o%e.length)],e[Math.floor(o%e.length)]}},Km=e=>{var t="",n=u(t),i=(o,c)=>{t+=`
      var ${o} = ${c}
    `,n=u(t)};return{addToContext:i,eval:o=>n.eval(o)};function u(o){globalThis.eval(o);var c=function(g){globalThis.eval(g)};return{eval:c}}};class Qm{constructor(t,n,i=[]){this.makeGlobal=n,this.sandbox=Km(),this.parent=t;var u=Object.keys(t);u.forEach(o=>this.add(o)),this.userProps=i}add(t){this.makeGlobal&&(window[t]=this.parent[t])}set(t,n){this.makeGlobal&&(window[t]=n),this.parent[t]=n}tick(){this.makeGlobal&&this.userProps.forEach(t=>{this.parent[t]=window[t]})}eval(t){this.sandbox.eval(t)}}const Zm={float:{vec4:{name:"sum",args:[[1,1,1,1]]},vec2:{name:"sum",args:[[1,1]]}}},Ki=e=>(e=e.toString(),e.indexOf(".")<0&&(e+="."),e);function Jm(e,t,n){const i=e.transform.inputs,u=e.userArgs,{generators:o}=e.synth,{src:c}=o;return i.map((g,S)=>{const b={value:g.default,type:g.type,isUniform:!1,name:g.name,vecLen:0};if(b.type==="float"&&(b.value=Ki(g.default)),g.type.startsWith("vec"))try{b.vecLen=Number.parseInt(g.type.substr(3))}catch{console.log(`Error determining length of vector input type ${g.type} (${g.name})`)}if(u.length>S&&(b.value=u[S],typeof u[S]=="function"?(b.value=(R,A,O)=>{try{const q=u[S](A);return typeof q=="number"?q:(console.warn("function does not return a number",u[S]),g.default)}catch(q){return console.warn("ERROR",q),g.default}},b.isUniform=!0):u[S].constructor===Array&&(b.value=(R,A,O)=>Ts.getValue(u[S])(A),b.isUniform=!0)),!(t<0)){if(b.value&&b.value.transforms){const R=b.value.transforms[b.value.transforms.length-1];if(R.transform.glsl_return_type!==g.type){const A=Zm[g.type];if(typeof A<"u"){const O=A[R.transform.glsl_return_type];if(typeof O<"u"){const{name:q,args:ne}=O;b.value=b.value[q](...ne)}}}b.isUniform=!1}else if(b.type==="float"&&typeof b.value=="number")b.value=Ki(b.value);else if(b.type.startsWith("vec")&&typeof b.value=="object"&&Array.isArray(b.value))b.isUniform=!1,b.value=`${b.type}(${b.value.map(Ki).join(", ")})`;else if(g.type==="sampler2D"){var G=b.value;b.value=()=>G.getTexture(),b.isUniform=!0}else if(b.value.getTexture&&g.type==="vec4"){var k=b.value;b.value=c(k),b.isUniform=!1}b.isUniform&&(b.name+=t)}return b})}function ep(e){var t={uniforms:[],glslFunctions:[],fragColor:""},n=aa(e,t)("st");t.fragColor=n;let i={};return t.uniforms.forEach(u=>i[u.name]=u),t.uniforms=Object.values(i),t}function aa(e,t){var n=()=>"";return e.forEach(i=>{var u=Jm(i,t.uniforms.length);u.forEach(g=>{g.isUniform&&t.uniforms.push(g)}),tp(i,t.glslFunctions)||t.glslFunctions.push(i);var o=n;if(i.transform.type==="src")n=g=>`${mn(g,i.name,u,t)}`;else if(i.transform.type==="coord")n=g=>`${o(`${mn(g,i.name,u,t)}`)}`;else if(i.transform.type==="color")n=g=>`${mn(`${o(g)}`,i.name,u,t)}`;else if(i.transform.type==="combine"){var c=u[0].value&&u[0].value.transforms?g=>`${aa(u[0].value.transforms,t)(g)}`:u[0].isUniform?()=>u[0].name:()=>u[0].value;n=g=>`${mn(`${o(g)}, ${c(g)}`,i.name,u.slice(1),t)}`}else if(i.transform.type==="combineCoord"){var c=u[0].value&&u[0].value.transforms?S=>`${aa(u[0].value.transforms,t)(S)}`:u[0].isUniform?()=>u[0].name:()=>u[0].value;n=S=>`${o(`${mn(`${S}, ${c(S)}`,i.name,u.slice(1),t)}`)}`}}),n}function mn(e,t,n,i){const u=n.map(o=>o.isUniform?o.name:o.value&&o.value.transforms?`${aa(o.value.transforms,i)("st")}`:o.value).reduce((o,c)=>`${o}, ${c}`,"");return`${t}(${e}${u})`}function tp(e,t){for(var n=0;n<t.length;n++)if(e.name==t[n].name)return!0;return!1}const rp={_luminance:{type:"util",glsl:`float _luminance(vec3 rgb){
      const vec3 W = vec3(0.2125, 0.7154, 0.0721);
      return dot(rgb, W);
    }`},_noise:{type:"util",glsl:`
    //	Simplex 3D Noise
    //	by Ian McEwan, Ashima Arts
    vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}
  vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}

  float _noise(vec3 v){
    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);

  // First corner
    vec3 i  = floor(v + dot(v, C.yyy) );
    vec3 x0 =   v - i + dot(i, C.xxx) ;

  // Other corners
    vec3 g = step(x0.yzx, x0.xyz);
    vec3 l = 1.0 - g;
    vec3 i1 = min( g.xyz, l.zxy );
    vec3 i2 = max( g.xyz, l.zxy );

    //  x0 = x0 - 0. + 0.0 * C
    vec3 x1 = x0 - i1 + 1.0 * C.xxx;
    vec3 x2 = x0 - i2 + 2.0 * C.xxx;
    vec3 x3 = x0 - 1. + 3.0 * C.xxx;

  // Permutations
    i = mod(i, 289.0 );
    vec4 p = permute( permute( permute(
               i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
             + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))
             + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));

  // Gradients
  // ( N*N points uniformly over a square, mapped onto an octahedron.)
    float n_ = 1.0/7.0; // N=7
    vec3  ns = n_ * D.wyz - D.xzx;

    vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)

    vec4 x_ = floor(j * ns.z);
    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)

    vec4 x = x_ *ns.x + ns.yyyy;
    vec4 y = y_ *ns.x + ns.yyyy;
    vec4 h = 1.0 - abs(x) - abs(y);

    vec4 b0 = vec4( x.xy, y.xy );
    vec4 b1 = vec4( x.zw, y.zw );

    vec4 s0 = floor(b0)*2.0 + 1.0;
    vec4 s1 = floor(b1)*2.0 + 1.0;
    vec4 sh = -step(h, vec4(0.0));

    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;

    vec3 p0 = vec3(a0.xy,h.x);
    vec3 p1 = vec3(a0.zw,h.y);
    vec3 p2 = vec3(a1.xy,h.z);
    vec3 p3 = vec3(a1.zw,h.w);

  //Normalise gradients
    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
    p0 *= norm.x;
    p1 *= norm.y;
    p2 *= norm.z;
    p3 *= norm.w;

  // Mix final noise value
    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
    m = m * m;
    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),
                                  dot(p2,x2), dot(p3,x3) ) );
  }
    `},_rgbToHsv:{type:"util",glsl:`vec3 _rgbToHsv(vec3 c){
            vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
            vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));
            vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));

            float d = q.x - min(q.w, q.y);
            float e = 1.0e-10;
            return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);
        }`},_hsvToRgb:{type:"util",glsl:`vec3 _hsvToRgb(vec3 c){
        vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
        vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
        return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
    }`}};var yn=function(e){return this.transforms=[],this.transforms.push(e),this.defaultOutput=e.defaultOutput,this.synth=e.synth,this.type="GlslSource",this.defaultUniforms=e.defaultUniforms,this};yn.prototype.addTransform=function(e){this.transforms.push(e)};yn.prototype.out=function(e){var t=e||this.defaultOutput,n=this.glsl(t);if(this.synth.currentFunctions=[],t)try{t.render(n)}catch(i){console.log("shader could not compile",i)}};yn.prototype.glsl=function(){var e=[],t=[];return this.transforms.forEach(n=>{n.transform.type==="renderpass"?console.warn("no support for renderpass"):t.push(n)}),t.length>0&&e.push(this.compile(t)),e};yn.prototype.compile=function(e){var t=ep(e,this.synth),n={};t.uniforms.forEach(u=>{n[u.name]=u.value});var i=`
  precision ${this.defaultOutput.precision} float;
  ${Object.values(t.uniforms).map(u=>{let o=u.type;switch(u.type){case"texture":o="sampler2D";break}return`
      uniform ${o} ${u.name};`}).join("")}
  uniform float time;
  uniform vec2 resolution;
  varying vec2 uv;
  uniform sampler2D prevBuffer;

  ${Object.values(rp).map(u=>`
            ${u.glsl}
          `).join("")}

  ${t.glslFunctions.map(u=>`
            ${u.transform.glsl}
          `).join("")}

  void main () {
    vec4 c = vec4(1, 0, 0, 1);
    vec2 st = gl_FragCoord.xy/resolution.xy;
    gl_FragColor = ${t.fragColor};
  }
  `;return{frag:i,uniforms:Object.assign({},this.defaultUniforms,n)}};const np=()=>[{name:"noise",type:"src",inputs:[{type:"float",name:"scale",default:10},{type:"float",name:"offset",default:.1}],glsl:"   return vec4(vec3(_noise(vec3(_st*scale, offset*time))), 1.0);"},{name:"voronoi",type:"src",inputs:[{type:"float",name:"scale",default:5},{type:"float",name:"speed",default:.3},{type:"float",name:"blending",default:.3}],glsl:`   vec3 color = vec3(.0);
   // Scale
   _st *= scale;
   // Tile the space
   vec2 i_st = floor(_st);
   vec2 f_st = fract(_st);
   float m_dist = 10.;  // minimun distance
   vec2 m_point;        // minimum point
   for (int j=-1; j<=1; j++ ) {
   for (int i=-1; i<=1; i++ ) {
   vec2 neighbor = vec2(float(i),float(j));
   vec2 p = i_st + neighbor;
   vec2 point = fract(sin(vec2(dot(p,vec2(127.1,311.7)),dot(p,vec2(269.5,183.3))))*43758.5453);
   point = 0.5 + 0.5*sin(time*speed + 6.2831*point);
   vec2 diff = neighbor + point - f_st;
   float dist = length(diff);
   if( dist < m_dist ) {
   m_dist = dist;
   m_point = point;
   }
   }
   }
   // Assign a color using the closest point position
   color += dot(m_point,vec2(.3,.6));
   color *= 1.0 - blending*m_dist;
   return vec4(color, 1.0);`},{name:"osc",type:"src",inputs:[{type:"float",name:"frequency",default:60},{type:"float",name:"sync",default:.1},{type:"float",name:"offset",default:0}],glsl:`   vec2 st = _st;
   float r = sin((st.x-offset/frequency+time*sync)*frequency)*0.5  + 0.5;
   float g = sin((st.x+time*sync)*frequency)*0.5 + 0.5;
   float b = sin((st.x+offset/frequency+time*sync)*frequency)*0.5  + 0.5;
   return vec4(r, g, b, 1.0);`},{name:"shape",type:"src",inputs:[{type:"float",name:"sides",default:3},{type:"float",name:"radius",default:.3},{type:"float",name:"smoothing",default:.01}],glsl:`   vec2 st = _st * 2. - 1.;
   // Angle and radius from the current pixel
   float a = atan(st.x,st.y)+3.1416;
   float r = (2.*3.1416)/sides;
   float d = cos(floor(.5+a/r)*r-a)*length(st);
   return vec4(vec3(1.0-smoothstep(radius,radius + smoothing + 0.0000001,d)), 1.0);`},{name:"gradient",type:"src",inputs:[{type:"float",name:"speed",default:0}],glsl:"   return vec4(_st, sin(time*speed), 1.0);"},{name:"src",type:"src",inputs:[{type:"sampler2D",name:"tex",default:NaN}],glsl:`   //  vec2 uv = gl_FragCoord.xy/vec2(1280., 720.);
   return texture2D(tex, fract(_st));`},{name:"solid",type:"src",inputs:[{type:"float",name:"r",default:0},{type:"float",name:"g",default:0},{type:"float",name:"b",default:0},{type:"float",name:"a",default:1}],glsl:"   return vec4(r, g, b, a);"},{name:"rotate",type:"coord",inputs:[{type:"float",name:"angle",default:10},{type:"float",name:"speed",default:0}],glsl:`   vec2 xy = _st - vec2(0.5);
   float ang = angle + speed *time;
   xy = mat2(cos(ang),-sin(ang), sin(ang),cos(ang))*xy;
   xy += 0.5;
   return xy;`},{name:"scale",type:"coord",inputs:[{type:"float",name:"amount",default:1.5},{type:"float",name:"xMult",default:1},{type:"float",name:"yMult",default:1},{type:"float",name:"offsetX",default:.5},{type:"float",name:"offsetY",default:.5}],glsl:`   vec2 xy = _st - vec2(offsetX, offsetY);
   xy*=(1.0/vec2(amount*xMult, amount*yMult));
   xy+=vec2(offsetX, offsetY);
   return xy;
   `},{name:"pixelate",type:"coord",inputs:[{type:"float",name:"pixelX",default:20},{type:"float",name:"pixelY",default:20}],glsl:`   vec2 xy = vec2(pixelX, pixelY);
   return (floor(_st * xy) + 0.5)/xy;`},{name:"posterize",type:"color",inputs:[{type:"float",name:"bins",default:3},{type:"float",name:"gamma",default:.6}],glsl:`   vec4 c2 = pow(_c0, vec4(gamma));
   c2 *= vec4(bins);
   c2 = floor(c2);
   c2/= vec4(bins);
   c2 = pow(c2, vec4(1.0/gamma));
   return vec4(c2.xyz, _c0.a);`},{name:"shift",type:"color",inputs:[{type:"float",name:"r",default:.5},{type:"float",name:"g",default:0},{type:"float",name:"b",default:0},{type:"float",name:"a",default:0}],glsl:`   vec4 c2 = vec4(_c0);
   c2.r = fract(c2.r + r);
   c2.g = fract(c2.g + g);
   c2.b = fract(c2.b + b);
   c2.a = fract(c2.a + a);
   return vec4(c2.rgba);`},{name:"repeat",type:"coord",inputs:[{type:"float",name:"repeatX",default:3},{type:"float",name:"repeatY",default:3},{type:"float",name:"offsetX",default:0},{type:"float",name:"offsetY",default:0}],glsl:`   vec2 st = _st * vec2(repeatX, repeatY);
   st.x += step(1., mod(st.y,2.0)) * offsetX;
   st.y += step(1., mod(st.x,2.0)) * offsetY;
   return fract(st);`},{name:"modulateRepeat",type:"combineCoord",inputs:[{type:"float",name:"repeatX",default:3},{type:"float",name:"repeatY",default:3},{type:"float",name:"offsetX",default:.5},{type:"float",name:"offsetY",default:.5}],glsl:`   vec2 st = _st * vec2(repeatX, repeatY);
   st.x += step(1., mod(st.y,2.0)) + _c0.r * offsetX;
   st.y += step(1., mod(st.x,2.0)) + _c0.g * offsetY;
   return fract(st);`},{name:"repeatX",type:"coord",inputs:[{type:"float",name:"reps",default:3},{type:"float",name:"offset",default:0}],glsl:`   vec2 st = _st * vec2(reps, 1.0);
   //  float f =  mod(_st.y,2.0);
   st.y += step(1., mod(st.x,2.0))* offset;
   return fract(st);`},{name:"modulateRepeatX",type:"combineCoord",inputs:[{type:"float",name:"reps",default:3},{type:"float",name:"offset",default:.5}],glsl:`   vec2 st = _st * vec2(reps, 1.0);
   //  float f =  mod(_st.y,2.0);
   st.y += step(1., mod(st.x,2.0)) + _c0.r * offset;
   return fract(st);`},{name:"repeatY",type:"coord",inputs:[{type:"float",name:"reps",default:3},{type:"float",name:"offset",default:0}],glsl:`   vec2 st = _st * vec2(1.0, reps);
   //  float f =  mod(_st.y,2.0);
   st.x += step(1., mod(st.y,2.0))* offset;
   return fract(st);`},{name:"modulateRepeatY",type:"combineCoord",inputs:[{type:"float",name:"reps",default:3},{type:"float",name:"offset",default:.5}],glsl:`   vec2 st = _st * vec2(reps, 1.0);
   //  float f =  mod(_st.y,2.0);
   st.x += step(1., mod(st.y,2.0)) + _c0.r * offset;
   return fract(st);`},{name:"kaleid",type:"coord",inputs:[{type:"float",name:"nSides",default:4}],glsl:`   vec2 st = _st;
   st -= 0.5;
   float r = length(st);
   float a = atan(st.y, st.x);
   float pi = 2.*3.1416;
   a = mod(a,pi/nSides);
   a = abs(a-pi/nSides/2.);
   return r*vec2(cos(a), sin(a));`},{name:"modulateKaleid",type:"combineCoord",inputs:[{type:"float",name:"nSides",default:4}],glsl:`   vec2 st = _st - 0.5;
   float r = length(st);
   float a = atan(st.y, st.x);
   float pi = 2.*3.1416;
   a = mod(a,pi/nSides);
   a = abs(a-pi/nSides/2.);
   return (_c0.r+r)*vec2(cos(a), sin(a));`},{name:"scroll",type:"coord",inputs:[{type:"float",name:"scrollX",default:.5},{type:"float",name:"scrollY",default:.5},{type:"float",name:"speedX",default:0},{type:"float",name:"speedY",default:0}],glsl:`
   _st.x += scrollX + time*speedX;
   _st.y += scrollY + time*speedY;
   return fract(_st);`},{name:"scrollX",type:"coord",inputs:[{type:"float",name:"scrollX",default:.5},{type:"float",name:"speed",default:0}],glsl:`   _st.x += scrollX + time*speed;
   return fract(_st);`},{name:"modulateScrollX",type:"combineCoord",inputs:[{type:"float",name:"scrollX",default:.5},{type:"float",name:"speed",default:0}],glsl:`   _st.x += _c0.r*scrollX + time*speed;
   return fract(_st);`},{name:"scrollY",type:"coord",inputs:[{type:"float",name:"scrollY",default:.5},{type:"float",name:"speed",default:0}],glsl:`   _st.y += scrollY + time*speed;
   return fract(_st);`},{name:"modulateScrollY",type:"combineCoord",inputs:[{type:"float",name:"scrollY",default:.5},{type:"float",name:"speed",default:0}],glsl:`   _st.y += _c0.r*scrollY + time*speed;
   return fract(_st);`},{name:"add",type:"combine",inputs:[{type:"float",name:"amount",default:1}],glsl:"   return (_c0+_c1)*amount + _c0*(1.0-amount);"},{name:"sub",type:"combine",inputs:[{type:"float",name:"amount",default:1}],glsl:"   return (_c0-_c1)*amount + _c0*(1.0-amount);"},{name:"layer",type:"combine",inputs:[],glsl:"   return vec4(mix(_c0.rgb, _c1.rgb, _c1.a), clamp(_c0.a + _c1.a, 0.0, 1.0));"},{name:"blend",type:"combine",inputs:[{type:"float",name:"amount",default:.5}],glsl:"   return _c0*(1.0-amount)+_c1*amount;"},{name:"mult",type:"combine",inputs:[{type:"float",name:"amount",default:1}],glsl:"   return _c0*(1.0-amount)+(_c0*_c1)*amount;"},{name:"diff",type:"combine",inputs:[],glsl:"   return vec4(abs(_c0.rgb-_c1.rgb), max(_c0.a, _c1.a));"},{name:"modulate",type:"combineCoord",inputs:[{type:"float",name:"amount",default:.1}],glsl:`   //  return fract(st+(_c0.xy-0.5)*amount);
   return _st + _c0.xy*amount;`},{name:"modulateScale",type:"combineCoord",inputs:[{type:"float",name:"multiple",default:1},{type:"float",name:"offset",default:1}],glsl:`   vec2 xy = _st - vec2(0.5);
   xy*=(1.0/vec2(offset + multiple*_c0.r, offset + multiple*_c0.g));
   xy+=vec2(0.5);
   return xy;`},{name:"modulatePixelate",type:"combineCoord",inputs:[{type:"float",name:"multiple",default:10},{type:"float",name:"offset",default:3}],glsl:`   vec2 xy = vec2(offset + _c0.x*multiple, offset + _c0.y*multiple);
   return (floor(_st * xy) + 0.5)/xy;`},{name:"modulateRotate",type:"combineCoord",inputs:[{type:"float",name:"multiple",default:1},{type:"float",name:"offset",default:0}],glsl:`   vec2 xy = _st - vec2(0.5);
   float angle = offset + _c0.x * multiple;
   xy = mat2(cos(angle),-sin(angle), sin(angle),cos(angle))*xy;
   xy += 0.5;
   return xy;`},{name:"modulateHue",type:"combineCoord",inputs:[{type:"float",name:"amount",default:1}],glsl:"   return _st + (vec2(_c0.g - _c0.r, _c0.b - _c0.g) * amount * 1.0/resolution);"},{name:"invert",type:"color",inputs:[{type:"float",name:"amount",default:1}],glsl:"   return vec4((1.0-_c0.rgb)*amount + _c0.rgb*(1.0-amount), _c0.a);"},{name:"contrast",type:"color",inputs:[{type:"float",name:"amount",default:1.6}],glsl:`   vec4 c = (_c0-vec4(0.5))*vec4(amount) + vec4(0.5);
   return vec4(c.rgb, _c0.a);`},{name:"brightness",type:"color",inputs:[{type:"float",name:"amount",default:.4}],glsl:"   return vec4(_c0.rgb + vec3(amount), _c0.a);"},{name:"mask",type:"combine",inputs:[],glsl:`   float a = _luminance(_c1.rgb);
  return vec4(_c0.rgb*a, a*_c0.a);`},{name:"luma",type:"color",inputs:[{type:"float",name:"threshold",default:.5},{type:"float",name:"tolerance",default:.1}],glsl:`   float a = smoothstep(threshold-(tolerance+0.0000001), threshold+(tolerance+0.0000001), _luminance(_c0.rgb));
   return vec4(_c0.rgb*a, a);`},{name:"thresh",type:"color",inputs:[{type:"float",name:"threshold",default:.5},{type:"float",name:"tolerance",default:.04}],glsl:"   return vec4(vec3(smoothstep(threshold-(tolerance+0.0000001), threshold+(tolerance+0.0000001), _luminance(_c0.rgb))), _c0.a);"},{name:"color",type:"color",inputs:[{type:"float",name:"r",default:1},{type:"float",name:"g",default:1},{type:"float",name:"b",default:1},{type:"float",name:"a",default:1}],glsl:`   vec4 c = vec4(r, g, b, a);
   vec4 pos = step(0.0, c); // detect whether negative
   // if > 0, return r * _c0
   // if < 0 return (1.0-r) * _c0
   return vec4(mix((1.0-_c0)*abs(c), c*_c0, pos));`},{name:"saturate",type:"color",inputs:[{type:"float",name:"amount",default:2}],glsl:`   const vec3 W = vec3(0.2125, 0.7154, 0.0721);
   vec3 intensity = vec3(dot(_c0.rgb, W));
   return vec4(mix(intensity, _c0.rgb, amount), _c0.a);`},{name:"hue",type:"color",inputs:[{type:"float",name:"hue",default:.4}],glsl:`   vec3 c = _rgbToHsv(_c0.rgb);
   c.r += hue;
   //  c.r = fract(c.r);
   return vec4(_hsvToRgb(c), _c0.a);`},{name:"colorama",type:"color",inputs:[{type:"float",name:"amount",default:.005}],glsl:`   vec3 c = _rgbToHsv(_c0.rgb);
   c += vec3(amount);
   c = _hsvToRgb(c);
   c = fract(c);
   return vec4(c, _c0.a);`},{name:"prev",type:"src",inputs:[],glsl:"   return texture2D(prevBuffer, fract(_st));"},{name:"sum",type:"color",inputs:[{type:"vec4",name:"scale",default:1}],glsl:`   vec4 v = _c0 * s;
   return v.r + v.g + v.b + v.a;
   }
   float sum(vec2 _st, vec4 s) { // vec4 is not a typo, because argument type is not overloaded
   vec2 v = _st.xy * s.xy;
   return v.x + v.y;`},{name:"r",type:"color",inputs:[{type:"float",name:"scale",default:1},{type:"float",name:"offset",default:0}],glsl:"   return vec4(_c0.r * scale + offset);"},{name:"g",type:"color",inputs:[{type:"float",name:"scale",default:1},{type:"float",name:"offset",default:0}],glsl:"   return vec4(_c0.g * scale + offset);"},{name:"b",type:"color",inputs:[{type:"float",name:"scale",default:1},{type:"float",name:"offset",default:0}],glsl:"   return vec4(_c0.b * scale + offset);"},{name:"a",type:"color",inputs:[{type:"float",name:"scale",default:1},{type:"float",name:"offset",default:0}],glsl:"   return vec4(_c0.a * scale + offset);"}];class ap{constructor({defaultUniforms:t,defaultOutput:n,extendTransforms:i=[],changeListener:u=()=>{}}={}){this.defaultOutput=n,this.defaultUniforms=t,this.changeListener=u,this.extendTransforms=i,this.generators={},this.init()}init(){const t=np();return this.glslTransforms={},this.generators=Object.entries(this.generators).reduce((n,[i,u])=>(this.changeListener({type:"remove",synth:this,method:i}),n),{}),this.sourceClass=class extends yn{},Array.isArray(this.extendTransforms)?t.concat(this.extendTransforms):typeof this.extendTransforms=="object"&&this.extendTransforms.type&&t.push(this.extendTransforms),t.map(n=>this.setFunction(n))}_addMethod(t,n){const i=this;if(this.glslTransforms[t]=n,n.type==="src"){const u=(...o)=>new this.sourceClass({name:t,transform:n,userArgs:o,defaultOutput:this.defaultOutput,defaultUniforms:this.defaultUniforms,synth:i});return this.generators[t]=u,this.changeListener({type:"add",synth:this,method:t}),u}else this.sourceClass.prototype[t]=function(...u){return this.transforms.push({name:t,transform:n,userArgs:u,synth:i}),this}}setFunction(t){var n=up(t);n&&this._addMethod(t.name,n)}}const ip={src:{returnType:"vec4",args:["vec2 _st"]},coord:{returnType:"vec2",args:["vec2 _st"]},color:{returnType:"vec4",args:["vec4 _c0"]},combine:{returnType:"vec4",args:["vec4 _c0","vec4 _c1"]},combineCoord:{returnType:"vec2",args:["vec2 _st","vec4 _c0"]}};function up(e){let t=ip[e.type];if(t){let n=t.args.map(c=>c).join(", "),i=e.inputs.map(c=>`${c.type} ${c.name}`).join(", "),u=`${n}${i.length>0?", "+i:""}`,o=`
  ${t.returnType} ${e.name}(${u}) {
      ${e.glsl}
  }
`;return(e.type==="combine"||e.type==="combineCoord")&&e.inputs.unshift({name:"color",type:"vec4"}),Object.assign({},e,{glsl:o})}else console.warn(`type ${e.type} not recognized`,e)}var ta={exports:{}},op=ta.exports,ds;function fp(){return ds||(ds=1,function(e,t){(function(n,i){e.exports=i()})(op,function(){var n=function(r){return r instanceof Uint8Array||r instanceof Uint16Array||r instanceof Uint32Array||r instanceof Int8Array||r instanceof Int16Array||r instanceof Int32Array||r instanceof Float32Array||r instanceof Float64Array||r instanceof Uint8ClampedArray},i=function(r,s){for(var y=Object.keys(s),z=0;z<y.length;++z)r[y[z]]=s[y[z]];return r},u=`
`;function o(r){return typeof atob<"u"?atob(r):"base64:"+r}function c(r){var s=new Error("(regl) "+r);throw console.error(s),s}function g(r,s){r||c(s)}function S(r){return r?": "+r:""}function b(r,s,y){r in s||c("unknown parameter ("+r+")"+S(y)+". possible values: "+Object.keys(s).join())}function G(r,s){n(r)||c("invalid parameter type"+S(s)+". must be a typed array")}function k(r,s){switch(s){case"number":return typeof r=="number";case"object":return typeof r=="object";case"string":return typeof r=="string";case"boolean":return typeof r=="boolean";case"function":return typeof r=="function";case"undefined":return typeof r>"u";case"symbol":return typeof r=="symbol"}}function R(r,s,y){k(r,s)||c("invalid parameter type"+S(y)+". expected "+s+", got "+typeof r)}function A(r,s){r>=0&&(r|0)===r||c("invalid parameter type, ("+r+")"+S(s)+". must be a nonnegative integer")}function O(r,s,y){s.indexOf(r)<0&&c("invalid value"+S(y)+". must be one of: "+s)}var q=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function ne(r){Object.keys(r).forEach(function(s){q.indexOf(s)<0&&c('invalid regl constructor argument "'+s+'". must be one of '+q)})}function _e(r,s){for(r=r+"";r.length<s;)r=" "+r;return r}function me(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function Ee(r,s){this.number=r,this.line=s,this.errors=[]}function Ve(r,s,y){this.file=r,this.line=s,this.message=y}function rt(){var r=new Error,s=(r.stack||r).toString(),y=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(s);if(y)return y[1];var z=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(s);return z?z[1]:"unknown"}function P(){var r=new Error,s=(r.stack||r).toString(),y=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(s);if(y)return y[1];var z=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(s);return z?z[1]:"unknown"}function p(r,s){var y=r.split(`
`),z=1,K=0,j={unknown:new me,0:new me};j.unknown.name=j[0].name=s||rt(),j.unknown.lines.push(new Ee(0,""));for(var V=0;V<y.length;++V){var ae=y[V],ue=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(ae);if(ue)switch(ue[1]){case"line":var de=/(\d+)(\s+\d+)?/.exec(ue[2]);de&&(z=de[1]|0,de[2]&&(K=de[2]|0,K in j||(j[K]=new me)));break;case"define":var oe=/SHADER_NAME(_B64)?\s+(.*)$/.exec(ue[2]);oe&&(j[K].name=oe[1]?o(oe[2]):oe[2]);break}j[K].lines.push(new Ee(z++,ae))}return Object.keys(j).forEach(function(le){var be=j[le];be.lines.forEach(function(ie){be.index[ie.number]=ie})}),j}function C(r){var s=[];return r.split(`
`).forEach(function(y){if(!(y.length<5)){var z=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(y);z?s.push(new Ve(z[1]|0,z[2]|0,z[3].trim())):y.length>0&&s.push(new Ve("unknown",0,y))}}),s}function $(r,s){s.forEach(function(y){var z=r[y.file];if(z){var K=z.index[y.line];if(K){K.errors.push(y),z.hasErrors=!0;return}}r.unknown.hasErrors=!0,r.unknown.lines[0].errors.push(y)})}function W(r,s,y,z,K){if(!r.getShaderParameter(s,r.COMPILE_STATUS)){var j=r.getShaderInfoLog(s),V=z===r.FRAGMENT_SHADER?"fragment":"vertex";Ue(y,"string",V+" shader source must be a string",K);var ae=p(y,K),ue=C(j);$(ae,ue),Object.keys(ae).forEach(function(de){var oe=ae[de];if(!oe.hasErrors)return;var le=[""],be=[""];function ie(he,M){le.push(he),be.push(M||"")}ie("file number "+de+": "+oe.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),oe.lines.forEach(function(he){if(he.errors.length>0){ie(_e(he.number,4)+"|  ","background-color:yellow; font-weight:bold"),ie(he.line+u,"color:red; background-color:yellow; font-weight:bold");var M=0;he.errors.forEach(function(H){var se=H.message,ge=/^\s*'(.*)'\s*:\s*(.*)$/.exec(se);if(ge){var J=ge[1];switch(se=ge[2],J){case"assign":J="=";break}M=Math.max(he.line.indexOf(J,M),0)}else M=0;ie(_e("| ",6)),ie(_e("^^^",M+3)+u,"font-weight:bold"),ie(_e("| ",6)),ie(se+u,"font-weight:bold")}),ie(_e("| ",6)+u)}else ie(_e(he.number,4)+"|  "),ie(he.line+u,"color:red")}),typeof document<"u"&&!window.chrome?(be[0]=le.join("%c"),console.log.apply(console,be)):console.log(le.join(""))}),g.raise("Error compiling "+V+" shader, "+ae[0].name)}}function re(r,s,y,z,K){if(!r.getProgramParameter(s,r.LINK_STATUS)){var j=r.getProgramInfoLog(s),V=p(y,K),ae=p(z,K),ue='Error linking program with vertex shader, "'+ae[0].name+'", and fragment shader "'+V[0].name+'"';typeof document<"u"?console.log("%c"+ue+u+"%c"+j,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(ue+u+j),g.raise(ue)}}function Ie(r){r._commandRef=rt()}function Oe(r,s,y,z){Ie(r);function K(ue){return ue?z.id(ue):0}r._fragId=K(r.static.frag),r._vertId=K(r.static.vert);function j(ue,de){Object.keys(de).forEach(function(oe){ue[z.id(oe)]=!0})}var V=r._uniformSet={};j(V,s.static),j(V,s.dynamic);var ae=r._attributeSet={};j(ae,y.static),j(ae,y.dynamic),r._hasCount="count"in r.static||"count"in r.dynamic||"elements"in r.static||"elements"in r.dynamic}function Se(r,s){var y=P();c(r+" in command "+(s||rt())+(y==="unknown"?"":" called from "+y))}function Le(r,s,y){r||Se(s,y||rt())}function Ge(r,s,y,z){r in s||Se("unknown parameter ("+r+")"+S(y)+". possible values: "+Object.keys(s).join(),z||rt())}function Ue(r,s,y,z){k(r,s)||Se("invalid parameter type"+S(y)+". expected "+s+", got "+typeof r,z||rt())}function Me(r){r()}function Ct(r,s,y){r.texture?O(r.texture._texture.internalformat,s,"unsupported texture format for attachment"):O(r.renderbuffer._renderbuffer.format,y,"unsupported renderbuffer format for attachment")}var ot=33071,Je=9728,Mt=9984,ft=9985,Rt=9986,Ft=9987,tt=5120,Ar=5121,ut=5122,Ss=5123,Rs=5124,Ls=5125,nu=5126,au=32819,iu=32820,uu=33635,ou=34042,Cs=36193,Bt={};Bt[tt]=Bt[Ar]=1,Bt[ut]=Bt[Ss]=Bt[Cs]=Bt[uu]=Bt[au]=Bt[iu]=2,Bt[Rs]=Bt[Ls]=Bt[nu]=Bt[ou]=4;function fu(r,s){return r===iu||r===au||r===uu?2:r===ou?4:Bt[r]*s}function gn(r){return!(r&r-1)&&!!r}function Os(r,s,y){var z,K=s.width,j=s.height,V=s.channels;g(K>0&&K<=y.maxTextureSize&&j>0&&j<=y.maxTextureSize,"invalid texture shape"),(r.wrapS!==ot||r.wrapT!==ot)&&g(gn(K)&&gn(j),"incompatible wrap mode for texture, both width and height must be power of 2"),s.mipmask===1?K!==1&&j!==1&&g(r.minFilter!==Mt&&r.minFilter!==Rt&&r.minFilter!==ft&&r.minFilter!==Ft,"min filter requires mipmap"):(g(gn(K)&&gn(j),"texture must be a square power of 2 to support mipmapping"),g(s.mipmask===(K<<1)-1,"missing or incomplete mipmap data")),s.type===nu&&(y.extensions.indexOf("oes_texture_float_linear")<0&&g(r.minFilter===Je&&r.magFilter===Je,"filter not supported, must enable oes_texture_float_linear"),g(!r.genMipmaps,"mipmap generation not supported with float textures"));var ae=s.images;for(z=0;z<16;++z)if(ae[z]){var ue=K>>z,de=j>>z;g(s.mipmask&1<<z,"missing mipmap data");var oe=ae[z];if(g(oe.width===ue&&oe.height===de,"invalid shape for mip images"),g(oe.format===s.format&&oe.internalformat===s.internalformat&&oe.type===s.type,"incompatible type for mip image"),!oe.compressed)if(oe.data){var le=Math.ceil(fu(oe.type,V)*ue/oe.unpackAlignment)*oe.unpackAlignment;g(oe.data.byteLength===le*de,"invalid data for image, buffer size is inconsistent with image format")}else oe.element||oe.copy}else r.genMipmaps||g((s.mipmask&1<<z)===0,"extra mipmap data");s.compressed&&g(!r.genMipmaps,"mipmap generation for compressed images not supported")}function Fs(r,s,y,z){var K=r.width,j=r.height,V=r.channels;g(K>0&&K<=z.maxTextureSize&&j>0&&j<=z.maxTextureSize,"invalid texture shape"),g(K===j,"cube map must be square"),g(s.wrapS===ot&&s.wrapT===ot,"wrap mode not supported by cube map");for(var ae=0;ae<y.length;++ae){var ue=y[ae];g(ue.width===K&&ue.height===j,"inconsistent cube map face shape"),s.genMipmaps&&(g(!ue.compressed,"can not generate mipmap for compressed textures"),g(ue.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var de=ue.images,oe=0;oe<16;++oe){var le=de[oe];if(le){var be=K>>oe,ie=j>>oe;g(ue.mipmask&1<<oe,"missing mipmap data"),g(le.width===be&&le.height===ie,"invalid shape for mip images"),g(le.format===r.format&&le.internalformat===r.internalformat&&le.type===r.type,"incompatible type for mip image"),le.compressed||(le.data?g(le.data.byteLength===be*ie*Math.max(fu(le.type,V),le.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):le.element||le.copy)}}}}var m=i(g,{optional:Me,raise:c,commandRaise:Se,command:Le,parameter:b,commandParameter:Ge,constructor:ne,type:R,commandType:Ue,isTypedArray:G,nni:A,oneOf:O,shaderError:W,linkError:re,callSite:P,saveCommandRef:Ie,saveDrawInfo:Oe,framebufferFormat:Ct,guessCommand:rt,texture2D:Os,textureCube:Fs}),Ds=0,ks=0,Ms=5,Gs=6;function fr(r,s){this.id=Ds++,this.type=r,this.data=s}function su(r){return r.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function Hr(r){if(r.length===0)return[];var s=r.charAt(0),y=r.charAt(r.length-1);if(r.length>1&&s===y&&(s==='"'||s==="'"))return['"'+su(r.substr(1,r.length-2))+'"'];var z=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(r);if(z)return Hr(r.substr(0,z.index)).concat(Hr(z[1])).concat(Hr(r.substr(z.index+z[0].length)));var K=r.split(".");if(K.length===1)return['"'+su(r)+'"'];for(var j=[],V=0;V<K.length;++V)j=j.concat(Hr(K[V]));return j}function du(r){return"["+Hr(r).join("][")+"]"}function Is(r,s){return new fr(r,du(s+""))}function Ns(r){return typeof r=="function"&&!r._reglType||r instanceof fr}function cu(r,s){if(typeof r=="function")return new fr(ks,r);if(typeof r=="number"||typeof r=="boolean")return new fr(Ms,r);if(Array.isArray(r))return new fr(Gs,r.map((y,z)=>cu(y,s+"["+z+"]")));if(r instanceof fr)return r;m(!1,"invalid option type in uniform "+s)}var Pt={DynamicVariable:fr,define:Is,isDynamic:Ns,unbox:cu,accessor:du},sa={next:typeof requestAnimationFrame=="function"?function(r){return requestAnimationFrame(r)}:function(r){return setTimeout(r,16)},cancel:typeof cancelAnimationFrame=="function"?function(r){return cancelAnimationFrame(r)}:clearTimeout},lu=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Bs(){var r={"":0},s=[""];return{id:function(y){var z=r[y];return z||(z=r[y]=s.length,s.push(y),z)},str:function(y){return s[y]}}}function Ps(r,s,y){var z=document.createElement("canvas");i(z.style,{border:0,margin:0,padding:0,top:0,left:0}),r.appendChild(z),r===document.body&&(z.style.position="absolute",i(r.style,{margin:0,padding:0}));function K(){var ae=window.innerWidth,ue=window.innerHeight;if(r!==document.body){var de=r.getBoundingClientRect();ae=de.right-de.left,ue=de.bottom-de.top}z.width=y*ae,z.height=y*ue,i(z.style,{width:ae+"px",height:ue+"px"})}var j;r!==document.body&&typeof ResizeObserver=="function"?(j=new ResizeObserver(function(){setTimeout(K)}),j.observe(r)):window.addEventListener("resize",K,!1);function V(){j?j.disconnect():window.removeEventListener("resize",K),r.removeChild(z)}return K(),{canvas:z,onDestroy:V}}function $s(r,s){function y(z){try{return r.getContext(z,s)}catch{return null}}return y("webgl")||y("experimental-webgl")||y("webgl-experimental")}function js(r){return typeof r.nodeName=="string"&&typeof r.appendChild=="function"&&typeof r.getBoundingClientRect=="function"}function zs(r){return typeof r.drawArrays=="function"||typeof r.drawElements=="function"}function hu(r){return typeof r=="string"?r.split():(m(Array.isArray(r),"invalid extension array"),r)}function mu(r){return typeof r=="string"?(m(typeof document<"u","not supported outside of DOM"),document.querySelector(r)):r}function Us(r){var s=r||{},y,z,K,j,V={},ae=[],ue=[],de=typeof window>"u"?1:window.devicePixelRatio,oe=!1,le=function(he){he&&m.raise(he)},be=function(){};if(typeof s=="string"?(m(typeof document<"u","selector queries only supported in DOM enviroments"),y=document.querySelector(s),m(y,"invalid query string for element")):typeof s=="object"?js(s)?y=s:zs(s)?(j=s,K=j.canvas):(m.constructor(s),"gl"in s?j=s.gl:"canvas"in s?K=mu(s.canvas):"container"in s&&(z=mu(s.container)),"attributes"in s&&(V=s.attributes,m.type(V,"object","invalid context attributes")),"extensions"in s&&(ae=hu(s.extensions)),"optionalExtensions"in s&&(ue=hu(s.optionalExtensions)),"onDone"in s&&(m.type(s.onDone,"function","invalid or missing onDone callback"),le=s.onDone),"profile"in s&&(oe=!!s.profile),"pixelRatio"in s&&(de=+s.pixelRatio,m(de>0,"invalid pixel ratio"))):m.raise("invalid arguments to regl"),y&&(y.nodeName.toLowerCase()==="canvas"?K=y:z=y),!j){if(!K){m(typeof document<"u","must manually specify webgl context outside of DOM environments");var ie=Ps(z||document.body,le,de);if(!ie)return null;K=ie.canvas,be=ie.onDestroy}V.premultipliedAlpha===void 0&&(V.premultipliedAlpha=!0),j=$s(K,V)}return j?{gl:j,canvas:K,container:z,extensions:ae,optionalExtensions:ue,pixelRatio:de,profile:oe,onDone:le,onDestroy:be}:(be(),le("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function qs(r,s){var y={};function z(V){m.type(V,"string","extension name must be string");var ae=V.toLowerCase(),ue;try{ue=y[ae]=r.getExtension(ae)}catch{}return!!ue}for(var K=0;K<s.extensions.length;++K){var j=s.extensions[K];if(!z(j))return s.onDestroy(),s.onDone('"'+j+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return s.optionalExtensions.forEach(z),{extensions:y,restore:function(){Object.keys(y).forEach(function(V){if(y[V]&&!z(V))throw new Error("(regl): error restoring extension "+V)})}}}function Gt(r,s){for(var y=Array(r),z=0;z<r;++z)y[z]=s(z);return y}var Vs=5120,Hs=5121,Xs=5122,Ws=5123,Ys=5124,Ks=5125,Qs=5126;function Zs(r){for(var s=16;s<=1<<28;s*=16)if(r<=s)return s;return 0}function pu(r){var s,y;return s=(r>65535)<<4,r>>>=s,y=(r>255)<<3,r>>>=y,s|=y,y=(r>15)<<2,r>>>=y,s|=y,y=(r>3)<<1,r>>>=y,s|=y,s|r>>1}function vu(){var r=Gt(8,function(){return[]});function s(j){var V=Zs(j),ae=r[pu(V)>>2];return ae.length>0?ae.pop():new ArrayBuffer(V)}function y(j){r[pu(j.byteLength)>>2].push(j)}function z(j,V){var ae=null;switch(j){case Vs:ae=new Int8Array(s(V),0,V);break;case Hs:ae=new Uint8Array(s(V),0,V);break;case Xs:ae=new Int16Array(s(2*V),0,V);break;case Ws:ae=new Uint16Array(s(2*V),0,V);break;case Ys:ae=new Int32Array(s(4*V),0,V);break;case Ks:ae=new Uint32Array(s(4*V),0,V);break;case Qs:ae=new Float32Array(s(4*V),0,V);break;default:return null}return ae.length!==V?ae.subarray(0,V):ae}function K(j){y(j.buffer)}return{alloc:s,free:y,allocType:z,freeType:K}}var ht=vu();ht.zero=vu();var Js=3408,ed=3410,td=3411,rd=3412,nd=3413,ad=3414,id=3415,ud=33901,od=33902,fd=3379,sd=3386,dd=34921,cd=36347,ld=36348,hd=35661,md=35660,pd=34930,vd=36349,bd=34076,yd=34024,gd=7936,_d=7937,xd=7938,wd=35724,Ed=34047,Ad=36063,Td=34852,_n=3553,bu=34067,Sd=34069,Rd=33984,Xr=6408,da=5126,yu=5121,ca=36160,Ld=36053,Cd=36064,Od=16384,Fd=function(r,s){var y=1;s.ext_texture_filter_anisotropic&&(y=r.getParameter(Ed));var z=1,K=1;s.webgl_draw_buffers&&(z=r.getParameter(Td),K=r.getParameter(Ad));var j=!!s.oes_texture_float;if(j){var V=r.createTexture();r.bindTexture(_n,V),r.texImage2D(_n,0,Xr,1,1,0,Xr,da,null);var ae=r.createFramebuffer();if(r.bindFramebuffer(ca,ae),r.framebufferTexture2D(ca,Cd,_n,V,0),r.bindTexture(_n,null),r.checkFramebufferStatus(ca)!==Ld)j=!1;else{r.viewport(0,0,1,1),r.clearColor(1,0,0,1),r.clear(Od);var ue=ht.allocType(da,4);r.readPixels(0,0,1,1,Xr,da,ue),r.getError()?j=!1:(r.deleteFramebuffer(ae),r.deleteTexture(V),j=ue[0]===1),ht.freeType(ue)}}var de=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),oe=!0;if(!de){var le=r.createTexture(),be=ht.allocType(yu,36);r.activeTexture(Rd),r.bindTexture(bu,le),r.texImage2D(Sd,0,Xr,3,3,0,Xr,yu,be),ht.freeType(be),r.bindTexture(bu,null),r.deleteTexture(le),oe=!r.getError()}return{colorBits:[r.getParameter(ed),r.getParameter(td),r.getParameter(rd),r.getParameter(nd)],depthBits:r.getParameter(ad),stencilBits:r.getParameter(id),subpixelBits:r.getParameter(Js),extensions:Object.keys(s).filter(function(ie){return!!s[ie]}),maxAnisotropic:y,maxDrawbuffers:z,maxColorAttachments:K,pointSizeDims:r.getParameter(ud),lineWidthDims:r.getParameter(od),maxViewportDims:r.getParameter(sd),maxCombinedTextureUnits:r.getParameter(hd),maxCubeMapSize:r.getParameter(bd),maxRenderbufferSize:r.getParameter(yd),maxTextureUnits:r.getParameter(pd),maxTextureSize:r.getParameter(fd),maxAttributes:r.getParameter(dd),maxVertexUniforms:r.getParameter(cd),maxVertexTextureUnits:r.getParameter(md),maxVaryingVectors:r.getParameter(ld),maxFragmentUniforms:r.getParameter(vd),glsl:r.getParameter(wd),renderer:r.getParameter(_d),vendor:r.getParameter(gd),version:r.getParameter(xd),readFloat:j,npotTextureCube:oe}};function Vt(r){return!!r&&typeof r=="object"&&Array.isArray(r.shape)&&Array.isArray(r.stride)&&typeof r.offset=="number"&&r.shape.length===r.stride.length&&(Array.isArray(r.data)||n(r.data))}var $t=function(r){return Object.keys(r).map(function(s){return r[s]})},xn={shape:Gd,flatten:Md};function Dd(r,s,y){for(var z=0;z<s;++z)y[z]=r[z]}function kd(r,s,y,z){for(var K=0,j=0;j<s;++j)for(var V=r[j],ae=0;ae<y;++ae)z[K++]=V[ae]}function gu(r,s,y,z,K,j){for(var V=j,ae=0;ae<s;++ae)for(var ue=r[ae],de=0;de<y;++de)for(var oe=ue[de],le=0;le<z;++le)K[V++]=oe[le]}function _u(r,s,y,z,K){for(var j=1,V=y+1;V<s.length;++V)j*=s[V];var ae=s[y];if(s.length-y===4){var ue=s[y+1],de=s[y+2],oe=s[y+3];for(V=0;V<ae;++V)gu(r[V],ue,de,oe,z,K),K+=j}else for(V=0;V<ae;++V)_u(r[V],s,y+1,z,K),K+=j}function Md(r,s,y,z){var K=1;if(s.length)for(var j=0;j<s.length;++j)K*=s[j];else K=0;var V=z||ht.allocType(y,K);switch(s.length){case 0:break;case 1:Dd(r,s[0],V);break;case 2:kd(r,s[0],s[1],V);break;case 3:gu(r,s[0],s[1],s[2],V,0);break;default:_u(r,s,0,V,0)}return V}function Gd(r){for(var s=[],y=r;y.length;y=y[0])s.push(y.length);return s}var la={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Id=5120,Nd=5122,Bd=5124,Pd=5121,$d=5123,jd=5125,zd=5126,Ud=5126,sr={int8:Id,int16:Nd,int32:Bd,uint8:Pd,uint16:$d,uint32:jd,float:zd,float32:Ud},qd=35048,Vd=35040,wn={dynamic:qd,stream:Vd,static:35044},ha=xn.flatten,xu=xn.shape,wu=35044,Hd=35040,ma=5121,pa=5126,rr=[];rr[5120]=1,rr[5122]=2,rr[5124]=4,rr[5121]=1,rr[5123]=2,rr[5125]=4,rr[5126]=4;function En(r){return la[Object.prototype.toString.call(r)]|0}function Eu(r,s){for(var y=0;y<s.length;++y)r[y]=s[y]}function Au(r,s,y,z,K,j,V){for(var ae=0,ue=0;ue<y;++ue)for(var de=0;de<z;++de)r[ae++]=s[K*ue+j*de+V]}function Xd(r,s,y,z){var K=0,j={};function V(M){this.id=K++,this.buffer=r.createBuffer(),this.type=M,this.usage=wu,this.byteLength=0,this.dimension=1,this.dtype=ma,this.persistentData=null,y.profile&&(this.stats={size:0})}V.prototype.bind=function(){r.bindBuffer(this.type,this.buffer)},V.prototype.destroy=function(){be(this)};var ae=[];function ue(M,H){var se=ae.pop();return se||(se=new V(M)),se.bind(),le(se,H,Hd,0,1,!1),se}function de(M){ae.push(M)}function oe(M,H,se){M.byteLength=H.byteLength,r.bufferData(M.type,H,se)}function le(M,H,se,ge,J,xe){var te;if(M.usage=se,Array.isArray(H)){if(M.dtype=ge||pa,H.length>0){var pe;if(Array.isArray(H[0])){te=xu(H);for(var ee=1,ve=1;ve<te.length;++ve)ee*=te[ve];M.dimension=ee,pe=ha(H,te,M.dtype),oe(M,pe,se),xe?M.persistentData=pe:ht.freeType(pe)}else if(typeof H[0]=="number"){M.dimension=J;var Ce=ht.allocType(M.dtype,H.length);Eu(Ce,H),oe(M,Ce,se),xe?M.persistentData=Ce:ht.freeType(Ce)}else n(H[0])?(M.dimension=H[0].length,M.dtype=ge||En(H[0])||pa,pe=ha(H,[H.length,H[0].length],M.dtype),oe(M,pe,se),xe?M.persistentData=pe:ht.freeType(pe)):m.raise("invalid buffer data")}}else if(n(H))M.dtype=ge||En(H),M.dimension=J,oe(M,H,se),xe&&(M.persistentData=new Uint8Array(new Uint8Array(H.buffer)));else if(Vt(H)){te=H.shape;var Ne=H.stride,ye=H.offset,ce=0,Z=0,ke=0,$e=0;te.length===1?(ce=te[0],Z=1,ke=Ne[0],$e=0):te.length===2?(ce=te[0],Z=te[1],ke=Ne[0],$e=Ne[1]):m.raise("invalid shape"),M.dtype=ge||En(H.data)||pa,M.dimension=Z;var Ae=ht.allocType(M.dtype,ce*Z);Au(Ae,H.data,ce,Z,ke,$e,ye),oe(M,Ae,se),xe?M.persistentData=Ae:ht.freeType(Ae)}else H instanceof ArrayBuffer?(M.dtype=ma,M.dimension=J,oe(M,H,se),xe&&(M.persistentData=new Uint8Array(new Uint8Array(H)))):m.raise("invalid buffer data")}function be(M){s.bufferCount--,z(M);var H=M.buffer;m(H,"buffer must not be deleted already"),r.deleteBuffer(H),M.buffer=null,delete j[M.id]}function ie(M,H,se,ge){s.bufferCount++;var J=new V(H);j[J.id]=J;function xe(ee){var ve=wu,Ce=null,Ne=0,ye=0,ce=1;return Array.isArray(ee)||n(ee)||Vt(ee)||ee instanceof ArrayBuffer?Ce=ee:typeof ee=="number"?Ne=ee|0:ee&&(m.type(ee,"object","buffer arguments must be an object, a number or an array"),"data"in ee&&(m(Ce===null||Array.isArray(Ce)||n(Ce)||Vt(Ce),"invalid data for buffer"),Ce=ee.data),"usage"in ee&&(m.parameter(ee.usage,wn,"invalid buffer usage"),ve=wn[ee.usage]),"type"in ee&&(m.parameter(ee.type,sr,"invalid buffer type"),ye=sr[ee.type]),"dimension"in ee&&(m.type(ee.dimension,"number","invalid dimension"),ce=ee.dimension|0),"length"in ee&&(m.nni(Ne,"buffer length must be a nonnegative integer"),Ne=ee.length|0)),J.bind(),Ce?le(J,Ce,ve,ye,ce,ge):(Ne&&r.bufferData(J.type,Ne,ve),J.dtype=ye||ma,J.usage=ve,J.dimension=ce,J.byteLength=Ne),y.profile&&(J.stats.size=J.byteLength*rr[J.dtype]),xe}function te(ee,ve){m(ve+ee.byteLength<=J.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+ee.byteLength+" starting from offset "+ve+" to a buffer of size "+J.byteLength),r.bufferSubData(J.type,ve,ee)}function pe(ee,ve){var Ce=(ve||0)|0,Ne;if(J.bind(),n(ee)||ee instanceof ArrayBuffer)te(ee,Ce);else if(Array.isArray(ee)){if(ee.length>0)if(typeof ee[0]=="number"){var ye=ht.allocType(J.dtype,ee.length);Eu(ye,ee),te(ye,Ce),ht.freeType(ye)}else if(Array.isArray(ee[0])||n(ee[0])){Ne=xu(ee);var ce=ha(ee,Ne,J.dtype);te(ce,Ce),ht.freeType(ce)}else m.raise("invalid buffer data")}else if(Vt(ee)){Ne=ee.shape;var Z=ee.stride,ke=0,$e=0,Ae=0,He=0;Ne.length===1?(ke=Ne[0],$e=1,Ae=Z[0],He=0):Ne.length===2?(ke=Ne[0],$e=Ne[1],Ae=Z[0],He=Z[1]):m.raise("invalid shape");var Be=Array.isArray(ee.data)?J.dtype:En(ee.data),qe=ht.allocType(Be,ke*$e);Au(qe,ee.data,ke,$e,Ae,He,ee.offset),te(qe,Ce),ht.freeType(qe)}else m.raise("invalid data for buffer subdata");return xe}return se||xe(M),xe._reglType="buffer",xe._buffer=J,xe.subdata=pe,y.profile&&(xe.stats=J.stats),xe.destroy=function(){be(J)},xe}function he(){$t(j).forEach(function(M){M.buffer=r.createBuffer(),r.bindBuffer(M.type,M.buffer),r.bufferData(M.type,M.persistentData||M.byteLength,M.usage)})}return y.profile&&(s.getTotalBufferSize=function(){var M=0;return Object.keys(j).forEach(function(H){M+=j[H].stats.size}),M}),{create:ie,createStream:ue,destroyStream:de,clear:function(){$t(j).forEach(be),ae.forEach(be)},getBuffer:function(M){return M&&M._buffer instanceof V?M._buffer:null},restore:he,_initBuffer:le}}var Wd=0,Yd=0,Kd=1,Qd=1,Zd=4,Jd=4,Tr={points:Wd,point:Yd,lines:Kd,line:Qd,triangles:Zd,triangle:Jd,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},ec=0,tc=1,Wr=4,rc=5120,Sr=5121,Tu=5122,Rr=5123,Su=5124,dr=5125,va=34963,nc=35040,ac=35044;function ic(r,s,y,z){var K={},j=0,V={uint8:Sr,uint16:Rr};s.oes_element_index_uint&&(V.uint32=dr);function ae(he){this.id=j++,K[this.id]=this,this.buffer=he,this.primType=Wr,this.vertCount=0,this.type=0}ae.prototype.bind=function(){this.buffer.bind()};var ue=[];function de(he){var M=ue.pop();return M||(M=new ae(y.create(null,va,!0,!1)._buffer)),le(M,he,nc,-1,-1,0,0),M}function oe(he){ue.push(he)}function le(he,M,H,se,ge,J,xe){he.buffer.bind();var te;if(M){var pe=xe;!xe&&(!n(M)||Vt(M)&&!n(M.data))&&(pe=s.oes_element_index_uint?dr:Rr),y._initBuffer(he.buffer,M,H,pe,3)}else r.bufferData(va,J,H),he.buffer.dtype=te||Sr,he.buffer.usage=H,he.buffer.dimension=3,he.buffer.byteLength=J;if(te=xe,!xe){switch(he.buffer.dtype){case Sr:case rc:te=Sr;break;case Rr:case Tu:te=Rr;break;case dr:case Su:te=dr;break;default:m.raise("unsupported type for element array")}he.buffer.dtype=te}he.type=te,m(te!==dr||!!s.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var ee=ge;ee<0&&(ee=he.buffer.byteLength,te===Rr?ee>>=1:te===dr&&(ee>>=2)),he.vertCount=ee;var ve=se;if(se<0){ve=Wr;var Ce=he.buffer.dimension;Ce===1&&(ve=ec),Ce===2&&(ve=tc),Ce===3&&(ve=Wr)}he.primType=ve}function be(he){z.elementsCount--,m(he.buffer!==null,"must not double destroy elements"),delete K[he.id],he.buffer.destroy(),he.buffer=null}function ie(he,M){var H=y.create(null,va,!0),se=new ae(H._buffer);z.elementsCount++;function ge(J){if(!J)H(),se.primType=Wr,se.vertCount=0,se.type=Sr;else if(typeof J=="number")H(J),se.primType=Wr,se.vertCount=J|0,se.type=Sr;else{var xe=null,te=ac,pe=-1,ee=-1,ve=0,Ce=0;Array.isArray(J)||n(J)||Vt(J)?xe=J:(m.type(J,"object","invalid arguments for elements"),"data"in J&&(xe=J.data,m(Array.isArray(xe)||n(xe)||Vt(xe),"invalid data for element buffer")),"usage"in J&&(m.parameter(J.usage,wn,"invalid element buffer usage"),te=wn[J.usage]),"primitive"in J&&(m.parameter(J.primitive,Tr,"invalid element buffer primitive"),pe=Tr[J.primitive]),"count"in J&&(m(typeof J.count=="number"&&J.count>=0,"invalid vertex count for elements"),ee=J.count|0),"type"in J&&(m.parameter(J.type,V,"invalid buffer type"),Ce=V[J.type]),"length"in J?ve=J.length|0:(ve=ee,Ce===Rr||Ce===Tu?ve*=2:(Ce===dr||Ce===Su)&&(ve*=4))),le(se,xe,te,pe,ee,ve,Ce)}return ge}return ge(he),ge._reglType="elements",ge._elements=se,ge.subdata=function(J,xe){return H.subdata(J,xe),ge},ge.destroy=function(){be(se)},ge}return{create:ie,createStream:de,destroyStream:oe,getElements:function(he){return typeof he=="function"&&he._elements instanceof ae?he._elements:null},clear:function(){$t(K).forEach(be)}}}var Ru=new Float32Array(1),uc=new Uint32Array(Ru.buffer),oc=5123;function Lu(r){for(var s=ht.allocType(oc,r.length),y=0;y<r.length;++y)if(isNaN(r[y]))s[y]=65535;else if(r[y]===1/0)s[y]=31744;else if(r[y]===-1/0)s[y]=64512;else{Ru[0]=r[y];var z=uc[0],K=z>>>31<<15,j=(z<<1>>>24)-127,V=z>>13&1023;if(j<-24)s[y]=K;else if(j<-14){var ae=-14-j;s[y]=K+(V+1024>>ae)}else j>15?s[y]=K+31744:s[y]=K+(j+15<<10)+V}return s}function dt(r){return Array.isArray(r)||n(r)}var Cu=function(r){return!(r&r-1)&&!!r},fc=34467,Wt=3553,ba=34067,An=34069,cr=6408,ya=6406,Tn=6407,Yr=6409,Sn=6410,Ou=32854,ga=32855,Fu=36194,sc=32819,dc=32820,cc=33635,lc=34042,_a=6402,Rn=34041,xa=35904,wa=35906,Lr=36193,Ea=33776,Aa=33777,Ta=33778,Sa=33779,Du=35986,ku=35987,Mu=34798,Gu=35840,Iu=35841,Nu=35842,Bu=35843,Pu=36196,Cr=5121,Ra=5123,La=5125,Kr=5126,hc=10242,mc=10243,pc=10497,Ca=33071,vc=33648,bc=10240,yc=10241,Oa=9728,gc=9729,Fa=9984,$u=9985,ju=9986,Da=9987,_c=33170,Ln=4352,xc=4353,wc=4354,Ec=34046,Ac=3317,Tc=37440,Sc=37441,Rc=37443,zu=37444,Qr=33984,Lc=[Fa,ju,$u,Da],Cn=[0,Yr,Sn,Tn,cr],zt={};zt[Yr]=zt[ya]=zt[_a]=1,zt[Rn]=zt[Sn]=2,zt[Tn]=zt[xa]=3,zt[cr]=zt[wa]=4;function Or(r){return"[object "+r+"]"}var Uu=Or("HTMLCanvasElement"),qu=Or("OffscreenCanvas"),Vu=Or("CanvasRenderingContext2D"),Hu=Or("ImageBitmap"),Xu=Or("HTMLImageElement"),Wu=Or("HTMLVideoElement"),Cc=Object.keys(la).concat([Uu,qu,Vu,Hu,Xu,Wu]),Fr=[];Fr[Cr]=1,Fr[Kr]=4,Fr[Lr]=2,Fr[Ra]=2,Fr[La]=4;var At=[];At[Ou]=2,At[ga]=2,At[Fu]=2,At[Rn]=4,At[Ea]=.5,At[Aa]=.5,At[Ta]=1,At[Sa]=1,At[Du]=.5,At[ku]=1,At[Mu]=1,At[Gu]=.5,At[Iu]=.25,At[Nu]=.5,At[Bu]=.25,At[Pu]=.5;function Yu(r){return Array.isArray(r)&&(r.length===0||typeof r[0]=="number")}function Ku(r){if(!Array.isArray(r))return!1;var s=r.length;return!(s===0||!dt(r[0]))}function lr(r){return Object.prototype.toString.call(r)}function Qu(r){return lr(r)===Uu}function Zu(r){return lr(r)===qu}function Oc(r){return lr(r)===Vu}function Fc(r){return lr(r)===Hu}function Dc(r){return lr(r)===Xu}function kc(r){return lr(r)===Wu}function ka(r){if(!r)return!1;var s=lr(r);return Cc.indexOf(s)>=0?!0:Yu(r)||Ku(r)||Vt(r)}function Ju(r){return la[Object.prototype.toString.call(r)]|0}function Mc(r,s){var y=s.length;switch(r.type){case Cr:case Ra:case La:case Kr:var z=ht.allocType(r.type,y);z.set(s),r.data=z;break;case Lr:r.data=Lu(s);break;default:m.raise("unsupported texture type, must specify a typed array")}}function eo(r,s){return ht.allocType(r.type===Lr?Kr:r.type,s)}function to(r,s){r.type===Lr?(r.data=Lu(s),ht.freeType(s)):r.data=s}function Gc(r,s,y,z,K,j){for(var V=r.width,ae=r.height,ue=r.channels,de=V*ae*ue,oe=eo(r,de),le=0,be=0;be<ae;++be)for(var ie=0;ie<V;++ie)for(var he=0;he<ue;++he)oe[le++]=s[y*ie+z*be+K*he+j];to(r,oe)}function On(r,s,y,z,K,j){var V;if(typeof At[r]<"u"?V=At[r]:V=zt[r]*Fr[s],j&&(V*=6),K){for(var ae=0,ue=y;ue>=1;)ae+=V*ue*ue,ue/=2;return ae}else return V*y*z}function Ic(r,s,y,z,K,j,V){var ae={"don't care":Ln,"dont care":Ln,nice:wc,fast:xc},ue={repeat:pc,clamp:Ca,mirror:vc},de={nearest:Oa,linear:gc},oe=i({mipmap:Da,"nearest mipmap nearest":Fa,"linear mipmap nearest":$u,"nearest mipmap linear":ju,"linear mipmap linear":Da},de),le={none:0,browser:zu},be={uint8:Cr,rgba4:sc,rgb565:cc,"rgb5 a1":dc},ie={alpha:ya,luminance:Yr,"luminance alpha":Sn,rgb:Tn,rgba:cr,rgba4:Ou,"rgb5 a1":ga,rgb565:Fu},he={};s.ext_srgb&&(ie.srgb=xa,ie.srgba=wa),s.oes_texture_float&&(be.float32=be.float=Kr),s.oes_texture_half_float&&(be.float16=be["half float"]=Lr),s.webgl_depth_texture&&(i(ie,{depth:_a,"depth stencil":Rn}),i(be,{uint16:Ra,uint32:La,"depth stencil":lc})),s.webgl_compressed_texture_s3tc&&i(he,{"rgb s3tc dxt1":Ea,"rgba s3tc dxt1":Aa,"rgba s3tc dxt3":Ta,"rgba s3tc dxt5":Sa}),s.webgl_compressed_texture_atc&&i(he,{"rgb atc":Du,"rgba atc explicit alpha":ku,"rgba atc interpolated alpha":Mu}),s.webgl_compressed_texture_pvrtc&&i(he,{"rgb pvrtc 4bppv1":Gu,"rgb pvrtc 2bppv1":Iu,"rgba pvrtc 4bppv1":Nu,"rgba pvrtc 2bppv1":Bu}),s.webgl_compressed_texture_etc1&&(he["rgb etc1"]=Pu);var M=Array.prototype.slice.call(r.getParameter(fc));Object.keys(he).forEach(function(v){var U=he[v];M.indexOf(U)>=0&&(ie[v]=U)});var H=Object.keys(ie);y.textureFormats=H;var se=[];Object.keys(ie).forEach(function(v){var U=ie[v];se[U]=v});var ge=[];Object.keys(be).forEach(function(v){var U=be[v];ge[U]=v});var J=[];Object.keys(de).forEach(function(v){var U=de[v];J[U]=v});var xe=[];Object.keys(oe).forEach(function(v){var U=oe[v];xe[U]=v});var te=[];Object.keys(ue).forEach(function(v){var U=ue[v];te[U]=v});var pe=H.reduce(function(v,U){var B=ie[U];return B===Yr||B===ya||B===Yr||B===Sn||B===_a||B===Rn||s.ext_srgb&&(B===xa||B===wa)?v[B]=B:B===ga||U.indexOf("rgba")>=0?v[B]=cr:v[B]=Tn,v},{});function ee(){this.internalformat=cr,this.format=cr,this.type=Cr,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=zu,this.width=0,this.height=0,this.channels=0}function ve(v,U){v.internalformat=U.internalformat,v.format=U.format,v.type=U.type,v.compressed=U.compressed,v.premultiplyAlpha=U.premultiplyAlpha,v.flipY=U.flipY,v.unpackAlignment=U.unpackAlignment,v.colorSpace=U.colorSpace,v.width=U.width,v.height=U.height,v.channels=U.channels}function Ce(v,U){if(!(typeof U!="object"||!U)){if("premultiplyAlpha"in U&&(m.type(U.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),v.premultiplyAlpha=U.premultiplyAlpha),"flipY"in U&&(m.type(U.flipY,"boolean","invalid texture flip"),v.flipY=U.flipY),"alignment"in U&&(m.oneOf(U.alignment,[1,2,4,8],"invalid texture unpack alignment"),v.unpackAlignment=U.alignment),"colorSpace"in U&&(m.parameter(U.colorSpace,le,"invalid colorSpace"),v.colorSpace=le[U.colorSpace]),"type"in U){var B=U.type;m(s.oes_texture_float||!(B==="float"||B==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),m(s.oes_texture_half_float||!(B==="half float"||B==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),m(s.webgl_depth_texture||!(B==="uint16"||B==="uint32"||B==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),m.parameter(B,be,"invalid texture type"),v.type=be[B]}var we=v.width,Xe=v.height,l=v.channels,f=!1;"shape"in U?(m(Array.isArray(U.shape)&&U.shape.length>=2,"shape must be an array"),we=U.shape[0],Xe=U.shape[1],U.shape.length===3&&(l=U.shape[2],m(l>0&&l<=4,"invalid number of channels"),f=!0),m(we>=0&&we<=y.maxTextureSize,"invalid width"),m(Xe>=0&&Xe<=y.maxTextureSize,"invalid height")):("radius"in U&&(we=Xe=U.radius,m(we>=0&&we<=y.maxTextureSize,"invalid radius")),"width"in U&&(we=U.width,m(we>=0&&we<=y.maxTextureSize,"invalid width")),"height"in U&&(Xe=U.height,m(Xe>=0&&Xe<=y.maxTextureSize,"invalid height")),"channels"in U&&(l=U.channels,m(l>0&&l<=4,"invalid number of channels"),f=!0)),v.width=we|0,v.height=Xe|0,v.channels=l|0;var w=!1;if("format"in U){var D=U.format;m(s.webgl_depth_texture||!(D==="depth"||D==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),m.parameter(D,ie,"invalid texture format");var I=v.internalformat=ie[D];v.format=pe[I],D in be&&("type"in U||(v.type=be[D])),D in he&&(v.compressed=!0),w=!0}!f&&w?v.channels=zt[v.format]:f&&!w?v.channels!==Cn[v.format]&&(v.format=v.internalformat=Cn[v.channels]):w&&f&&m(v.channels===zt[v.format],"number of channels inconsistent with specified format")}}function Ne(v){r.pixelStorei(Tc,v.flipY),r.pixelStorei(Sc,v.premultiplyAlpha),r.pixelStorei(Rc,v.colorSpace),r.pixelStorei(Ac,v.unpackAlignment)}function ye(){ee.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function ce(v,U){var B=null;if(ka(U)?B=U:U&&(m.type(U,"object","invalid pixel data type"),Ce(v,U),"x"in U&&(v.xOffset=U.x|0),"y"in U&&(v.yOffset=U.y|0),ka(U.data)&&(B=U.data)),m(!v.compressed||B instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),U.copy){m(!B,"can not specify copy and data field for the same texture");var we=K.viewportWidth,Xe=K.viewportHeight;v.width=v.width||we-v.xOffset,v.height=v.height||Xe-v.yOffset,v.needsCopy=!0,m(v.xOffset>=0&&v.xOffset<we&&v.yOffset>=0&&v.yOffset<Xe&&v.width>0&&v.width<=we&&v.height>0&&v.height<=Xe,"copy texture read out of bounds")}else if(!B)v.width=v.width||1,v.height=v.height||1,v.channels=v.channels||4;else if(n(B))v.channels=v.channels||4,v.data=B,!("type"in U)&&v.type===Cr&&(v.type=Ju(B));else if(Yu(B))v.channels=v.channels||4,Mc(v,B),v.alignment=1,v.needsFree=!0;else if(Vt(B)){var l=B.data;!Array.isArray(l)&&v.type===Cr&&(v.type=Ju(l));var f=B.shape,w=B.stride,D,I,T,E,L,h;f.length===3?(T=f[2],h=w[2]):(m(f.length===2,"invalid ndarray pixel data, must be 2 or 3D"),T=1,h=1),D=f[0],I=f[1],E=w[0],L=w[1],v.alignment=1,v.width=D,v.height=I,v.channels=T,v.format=v.internalformat=Cn[T],v.needsFree=!0,Gc(v,l,E,L,h,B.offset)}else if(Qu(B)||Zu(B)||Oc(B))Qu(B)||Zu(B)?v.element=B:v.element=B.canvas,v.width=v.element.width,v.height=v.element.height,v.channels=4;else if(Fc(B))v.element=B,v.width=B.width,v.height=B.height,v.channels=4;else if(Dc(B))v.element=B,v.width=B.naturalWidth,v.height=B.naturalHeight,v.channels=4;else if(kc(B))v.element=B,v.width=B.videoWidth,v.height=B.videoHeight,v.channels=4;else if(Ku(B)){var _=v.width||B[0].length,d=v.height||B.length,F=v.channels;dt(B[0][0])?F=F||B[0][0].length:F=F||1;for(var N=xn.shape(B),Y=1,Q=0;Q<N.length;++Q)Y*=N[Q];var X=eo(v,Y);xn.flatten(B,N,"",X),to(v,X),v.alignment=1,v.width=_,v.height=d,v.channels=F,v.format=v.internalformat=Cn[F],v.needsFree=!0}v.type===Kr?m(y.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):v.type===Lr&&m(y.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Z(v,U,B){var we=v.element,Xe=v.data,l=v.internalformat,f=v.format,w=v.type,D=v.width,I=v.height;Ne(v),we?r.texImage2D(U,B,f,f,w,we):v.compressed?r.compressedTexImage2D(U,B,l,D,I,0,Xe):v.needsCopy?(z(),r.copyTexImage2D(U,B,f,v.xOffset,v.yOffset,D,I,0)):r.texImage2D(U,B,f,D,I,0,f,w,Xe||null)}function ke(v,U,B,we,Xe){var l=v.element,f=v.data,w=v.internalformat,D=v.format,I=v.type,T=v.width,E=v.height;Ne(v),l?r.texSubImage2D(U,Xe,B,we,D,I,l):v.compressed?r.compressedTexSubImage2D(U,Xe,B,we,w,T,E,f):v.needsCopy?(z(),r.copyTexSubImage2D(U,Xe,B,we,v.xOffset,v.yOffset,T,E)):r.texSubImage2D(U,Xe,B,we,T,E,D,I,f)}var $e=[];function Ae(){return $e.pop()||new ye}function He(v){v.needsFree&&ht.freeType(v.data),ye.call(v),$e.push(v)}function Be(){ee.call(this),this.genMipmaps=!1,this.mipmapHint=Ln,this.mipmask=0,this.images=Array(16)}function qe(v,U,B){var we=v.images[0]=Ae();v.mipmask=1,we.width=v.width=U,we.height=v.height=B,we.channels=v.channels=4}function Qe(v,U){var B=null;if(ka(U))B=v.images[0]=Ae(),ve(B,v),ce(B,U),v.mipmask=1;else if(Ce(v,U),Array.isArray(U.mipmap))for(var we=U.mipmap,Xe=0;Xe<we.length;++Xe)B=v.images[Xe]=Ae(),ve(B,v),B.width>>=Xe,B.height>>=Xe,ce(B,we[Xe]),v.mipmask|=1<<Xe;else B=v.images[0]=Ae(),ve(B,v),ce(B,U),v.mipmask=1;ve(v,v.images[0]),v.compressed&&(v.internalformat===Ea||v.internalformat===Aa||v.internalformat===Ta||v.internalformat===Sa)&&m(v.width%4===0&&v.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function pt(v,U){for(var B=v.images,we=0;we<B.length;++we){if(!B[we])return;Z(B[we],U,we)}}var xt=[];function Ye(){var v=xt.pop()||new Be;ee.call(v),v.mipmask=0;for(var U=0;U<16;++U)v.images[U]=null;return v}function bt(v){for(var U=v.images,B=0;B<U.length;++B)U[B]&&He(U[B]),U[B]=null;xt.push(v)}function it(){this.minFilter=Oa,this.magFilter=Oa,this.wrapS=Ca,this.wrapT=Ca,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Ln}function vt(v,U){if("min"in U){var B=U.min;m.parameter(B,oe),v.minFilter=oe[B],Lc.indexOf(v.minFilter)>=0&&!("faces"in U)&&(v.genMipmaps=!0)}if("mag"in U){var we=U.mag;m.parameter(we,de),v.magFilter=de[we]}var Xe=v.wrapS,l=v.wrapT;if("wrap"in U){var f=U.wrap;typeof f=="string"?(m.parameter(f,ue),Xe=l=ue[f]):Array.isArray(f)&&(m.parameter(f[0],ue),m.parameter(f[1],ue),Xe=ue[f[0]],l=ue[f[1]])}else{if("wrapS"in U){var w=U.wrapS;m.parameter(w,ue),Xe=ue[w]}if("wrapT"in U){var D=U.wrapT;m.parameter(D,ue),l=ue[D]}}if(v.wrapS=Xe,v.wrapT=l,"anisotropic"in U){var I=U.anisotropic;m(typeof I=="number"&&I>=1&&I<=y.maxAnisotropic,"aniso samples must be between 1 and "),v.anisotropic=U.anisotropic}if("mipmap"in U){var T=!1;switch(typeof U.mipmap){case"string":m.parameter(U.mipmap,ae,"invalid mipmap hint"),v.mipmapHint=ae[U.mipmap],v.genMipmaps=!0,T=!0;break;case"boolean":T=v.genMipmaps=U.mipmap;break;case"object":m(Array.isArray(U.mipmap),"invalid mipmap type"),v.genMipmaps=!1,T=!0;break;default:m.raise("invalid mipmap type")}T&&!("min"in U)&&(v.minFilter=Fa)}}function yt(v,U){r.texParameteri(U,yc,v.minFilter),r.texParameteri(U,bc,v.magFilter),r.texParameteri(U,hc,v.wrapS),r.texParameteri(U,mc,v.wrapT),s.ext_texture_filter_anisotropic&&r.texParameteri(U,Ec,v.anisotropic),v.genMipmaps&&(r.hint(_c,v.mipmapHint),r.generateMipmap(U))}var gt=0,Et={},Tt=y.maxTextureUnits,ct=Array(Tt).map(function(){return null});function je(v){ee.call(this),this.mipmask=0,this.internalformat=cr,this.id=gt++,this.refCount=1,this.target=v,this.texture=r.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new it,V.profile&&(this.stats={size:0})}function St(v){r.activeTexture(Qr),r.bindTexture(v.target,v.texture)}function et(){var v=ct[0];v?r.bindTexture(v.target,v.texture):r.bindTexture(Wt,null)}function Fe(v){var U=v.texture;m(U,"must not double destroy texture");var B=v.unit,we=v.target;B>=0&&(r.activeTexture(Qr+B),r.bindTexture(we,null),ct[B]=null),r.deleteTexture(U),v.texture=null,v.params=null,v.pixels=null,v.refCount=0,delete Et[v.id],j.textureCount--}i(je.prototype,{bind:function(){var v=this;v.bindCount+=1;var U=v.unit;if(U<0){for(var B=0;B<Tt;++B){var we=ct[B];if(we){if(we.bindCount>0)continue;we.unit=-1}ct[B]=v,U=B;break}U>=Tt&&m.raise("insufficient number of texture units"),V.profile&&j.maxTextureUnits<U+1&&(j.maxTextureUnits=U+1),v.unit=U,r.activeTexture(Qr+U),r.bindTexture(v.target,v.texture)}return U},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Fe(this)}});function We(v,U){var B=new je(Wt);Et[B.id]=B,j.textureCount++;function we(f,w){var D=B.texInfo;it.call(D);var I=Ye();return typeof f=="number"?typeof w=="number"?qe(I,f|0,w|0):qe(I,f|0,f|0):f?(m.type(f,"object","invalid arguments to regl.texture"),vt(D,f),Qe(I,f)):qe(I,1,1),D.genMipmaps&&(I.mipmask=(I.width<<1)-1),B.mipmask=I.mipmask,ve(B,I),m.texture2D(D,I,y),B.internalformat=I.internalformat,we.width=I.width,we.height=I.height,St(B),pt(I,Wt),yt(D,Wt),et(),bt(I),V.profile&&(B.stats.size=On(B.internalformat,B.type,I.width,I.height,D.genMipmaps,!1)),we.format=se[B.internalformat],we.type=ge[B.type],we.mag=J[D.magFilter],we.min=xe[D.minFilter],we.wrapS=te[D.wrapS],we.wrapT=te[D.wrapT],we}function Xe(f,w,D,I){m(!!f,"must specify image data");var T=w|0,E=D|0,L=I|0,h=Ae();return ve(h,B),h.width=0,h.height=0,ce(h,f),h.width=h.width||(B.width>>L)-T,h.height=h.height||(B.height>>L)-E,m(B.type===h.type&&B.format===h.format&&B.internalformat===h.internalformat,"incompatible format for texture.subimage"),m(T>=0&&E>=0&&T+h.width<=B.width&&E+h.height<=B.height,"texture.subimage write out of bounds"),m(B.mipmask&1<<L,"missing mipmap data"),m(h.data||h.element||h.needsCopy,"missing image data"),St(B),ke(h,Wt,T,E,L),et(),He(h),we}function l(f,w){var D=f|0,I=w|0||D;if(D===B.width&&I===B.height)return we;we.width=B.width=D,we.height=B.height=I,St(B);for(var T=0;B.mipmask>>T;++T){var E=D>>T,L=I>>T;if(!E||!L)break;r.texImage2D(Wt,T,B.format,E,L,0,B.format,B.type,null)}return et(),V.profile&&(B.stats.size=On(B.internalformat,B.type,D,I,!1,!1)),we}return we(v,U),we.subimage=Xe,we.resize=l,we._reglType="texture2d",we._texture=B,V.profile&&(we.stats=B.stats),we.destroy=function(){B.decRef()},we}function Ke(v,U,B,we,Xe,l){var f=new je(ba);Et[f.id]=f,j.cubeCount++;var w=new Array(6);function D(E,L,h,_,d,F){var N,Y=f.texInfo;for(it.call(Y),N=0;N<6;++N)w[N]=Ye();if(typeof E=="number"||!E){var Q=E|0||1;for(N=0;N<6;++N)qe(w[N],Q,Q)}else if(typeof E=="object")if(L)Qe(w[0],E),Qe(w[1],L),Qe(w[2],h),Qe(w[3],_),Qe(w[4],d),Qe(w[5],F);else if(vt(Y,E),Ce(f,E),"faces"in E){var X=E.faces;for(m(Array.isArray(X)&&X.length===6,"cube faces must be a length 6 array"),N=0;N<6;++N)m(typeof X[N]=="object"&&!!X[N],"invalid input for cube map face"),ve(w[N],f),Qe(w[N],X[N])}else for(N=0;N<6;++N)Qe(w[N],E);else m.raise("invalid arguments to cube map");for(ve(f,w[0]),y.npotTextureCube||m(Cu(f.width)&&Cu(f.height),"your browser does not support non power or two texture dimensions"),Y.genMipmaps?f.mipmask=(w[0].width<<1)-1:f.mipmask=w[0].mipmask,m.textureCube(f,Y,w,y),f.internalformat=w[0].internalformat,D.width=w[0].width,D.height=w[0].height,St(f),N=0;N<6;++N)pt(w[N],An+N);for(yt(Y,ba),et(),V.profile&&(f.stats.size=On(f.internalformat,f.type,D.width,D.height,Y.genMipmaps,!0)),D.format=se[f.internalformat],D.type=ge[f.type],D.mag=J[Y.magFilter],D.min=xe[Y.minFilter],D.wrapS=te[Y.wrapS],D.wrapT=te[Y.wrapT],N=0;N<6;++N)bt(w[N]);return D}function I(E,L,h,_,d){m(!!L,"must specify image data"),m(typeof E=="number"&&E===(E|0)&&E>=0&&E<6,"invalid face");var F=h|0,N=_|0,Y=d|0,Q=Ae();return ve(Q,f),Q.width=0,Q.height=0,ce(Q,L),Q.width=Q.width||(f.width>>Y)-F,Q.height=Q.height||(f.height>>Y)-N,m(f.type===Q.type&&f.format===Q.format&&f.internalformat===Q.internalformat,"incompatible format for texture.subimage"),m(F>=0&&N>=0&&F+Q.width<=f.width&&N+Q.height<=f.height,"texture.subimage write out of bounds"),m(f.mipmask&1<<Y,"missing mipmap data"),m(Q.data||Q.element||Q.needsCopy,"missing image data"),St(f),ke(Q,An+E,F,N,Y),et(),He(Q),D}function T(E){var L=E|0;if(L!==f.width){D.width=f.width=L,D.height=f.height=L,St(f);for(var h=0;h<6;++h)for(var _=0;f.mipmask>>_;++_)r.texImage2D(An+h,_,f.format,L>>_,L>>_,0,f.format,f.type,null);return et(),V.profile&&(f.stats.size=On(f.internalformat,f.type,D.width,D.height,!1,!0)),D}}return D(v,U,B,we,Xe,l),D.subimage=I,D.resize=T,D._reglType="textureCube",D._texture=f,V.profile&&(D.stats=f.stats),D.destroy=function(){f.decRef()},D}function lt(){for(var v=0;v<Tt;++v)r.activeTexture(Qr+v),r.bindTexture(Wt,null),ct[v]=null;$t(Et).forEach(Fe),j.cubeCount=0,j.textureCount=0}V.profile&&(j.getTotalTextureSize=function(){var v=0;return Object.keys(Et).forEach(function(U){v+=Et[U].stats.size}),v});function Kt(){for(var v=0;v<Tt;++v){var U=ct[v];U&&(U.bindCount=0,U.unit=-1,ct[v]=null)}$t(Et).forEach(function(B){B.texture=r.createTexture(),r.bindTexture(B.target,B.texture);for(var we=0;we<32;++we)if((B.mipmask&1<<we)!==0)if(B.target===Wt)r.texImage2D(Wt,we,B.internalformat,B.width>>we,B.height>>we,0,B.internalformat,B.type,null);else for(var Xe=0;Xe<6;++Xe)r.texImage2D(An+Xe,we,B.internalformat,B.width>>we,B.height>>we,0,B.internalformat,B.type,null);yt(B.texInfo,B.target)})}function gr(){for(var v=0;v<Tt;++v){var U=ct[v];U&&(U.bindCount=0,U.unit=-1,ct[v]=null),r.activeTexture(Qr+v),r.bindTexture(Wt,null),r.bindTexture(ba,null)}}return{create2D:We,createCube:Ke,clear:lt,getTexture:function(v){return null},restore:Kt,refresh:gr}}var nr=36161,Fn=32854,ro=32855,no=36194,ao=33189,io=36168,uo=34041,oo=35907,fo=34836,so=34842,co=34843,Ht=[];Ht[Fn]=2,Ht[ro]=2,Ht[no]=2,Ht[ao]=2,Ht[io]=1,Ht[uo]=4,Ht[oo]=4,Ht[fo]=16,Ht[so]=8,Ht[co]=6;function lo(r,s,y){return Ht[r]*s*y}var Nc=function(r,s,y,z,K){var j={rgba4:Fn,rgb565:no,"rgb5 a1":ro,depth:ao,stencil:io,"depth stencil":uo};s.ext_srgb&&(j.srgba=oo),s.ext_color_buffer_half_float&&(j.rgba16f=so,j.rgb16f=co),s.webgl_color_buffer_float&&(j.rgba32f=fo);var V=[];Object.keys(j).forEach(function(ie){var he=j[ie];V[he]=ie});var ae=0,ue={};function de(ie){this.id=ae++,this.refCount=1,this.renderbuffer=ie,this.format=Fn,this.width=0,this.height=0,K.profile&&(this.stats={size:0})}de.prototype.decRef=function(){--this.refCount<=0&&oe(this)};function oe(ie){var he=ie.renderbuffer;m(he,"must not double destroy renderbuffer"),r.bindRenderbuffer(nr,null),r.deleteRenderbuffer(he),ie.renderbuffer=null,ie.refCount=0,delete ue[ie.id],z.renderbufferCount--}function le(ie,he){var M=new de(r.createRenderbuffer());ue[M.id]=M,z.renderbufferCount++;function H(ge,J){var xe=0,te=0,pe=Fn;if(typeof ge=="object"&&ge){var ee=ge;if("shape"in ee){var ve=ee.shape;m(Array.isArray(ve)&&ve.length>=2,"invalid renderbuffer shape"),xe=ve[0]|0,te=ve[1]|0}else"radius"in ee&&(xe=te=ee.radius|0),"width"in ee&&(xe=ee.width|0),"height"in ee&&(te=ee.height|0);"format"in ee&&(m.parameter(ee.format,j,"invalid renderbuffer format"),pe=j[ee.format])}else typeof ge=="number"?(xe=ge|0,typeof J=="number"?te=J|0:te=xe):ge?m.raise("invalid arguments to renderbuffer constructor"):xe=te=1;if(m(xe>0&&te>0&&xe<=y.maxRenderbufferSize&&te<=y.maxRenderbufferSize,"invalid renderbuffer size"),!(xe===M.width&&te===M.height&&pe===M.format))return H.width=M.width=xe,H.height=M.height=te,M.format=pe,r.bindRenderbuffer(nr,M.renderbuffer),r.renderbufferStorage(nr,pe,xe,te),m(r.getError()===0,"invalid render buffer format"),K.profile&&(M.stats.size=lo(M.format,M.width,M.height)),H.format=V[M.format],H}function se(ge,J){var xe=ge|0,te=J|0||xe;return xe===M.width&&te===M.height||(m(xe>0&&te>0&&xe<=y.maxRenderbufferSize&&te<=y.maxRenderbufferSize,"invalid renderbuffer size"),H.width=M.width=xe,H.height=M.height=te,r.bindRenderbuffer(nr,M.renderbuffer),r.renderbufferStorage(nr,M.format,xe,te),m(r.getError()===0,"invalid render buffer format"),K.profile&&(M.stats.size=lo(M.format,M.width,M.height))),H}return H(ie,he),H.resize=se,H._reglType="renderbuffer",H._renderbuffer=M,K.profile&&(H.stats=M.stats),H.destroy=function(){M.decRef()},H}K.profile&&(z.getTotalRenderbufferSize=function(){var ie=0;return Object.keys(ue).forEach(function(he){ie+=ue[he].stats.size}),ie});function be(){$t(ue).forEach(function(ie){ie.renderbuffer=r.createRenderbuffer(),r.bindRenderbuffer(nr,ie.renderbuffer),r.renderbufferStorage(nr,ie.format,ie.width,ie.height)}),r.bindRenderbuffer(nr,null)}return{create:le,clear:function(){$t(ue).forEach(oe)},restore:be}},Jt=36160,Ma=36161,hr=3553,Dn=34069,ho=36064,mo=36096,po=36128,vo=33306,bo=36053,Bc=36054,Pc=36055,$c=36057,jc=36061,zc=36193,Uc=5121,qc=5126,yo=6407,go=6408,Vc=6402,Hc=[yo,go],Ga=[];Ga[go]=4,Ga[yo]=3;var kn=[];kn[Uc]=1,kn[qc]=4,kn[zc]=2;var Xc=32854,Wc=32855,Yc=36194,Kc=33189,Qc=36168,_o=34041,Zc=35907,Jc=34836,el=34842,tl=34843,rl=[Xc,Wc,Yc,Zc,el,tl,Jc],Dr={};Dr[bo]="complete",Dr[Bc]="incomplete attachment",Dr[$c]="incomplete dimensions",Dr[Pc]="incomplete, missing attachment",Dr[jc]="unsupported";function nl(r,s,y,z,K,j){var V={cur:null,next:null,dirty:!1,setFBO:null},ae=["rgba"],ue=["rgba4","rgb565","rgb5 a1"];s.ext_srgb&&ue.push("srgba"),s.ext_color_buffer_half_float&&ue.push("rgba16f","rgb16f"),s.webgl_color_buffer_float&&ue.push("rgba32f");var de=["uint8"];s.oes_texture_half_float&&de.push("half float","float16"),s.oes_texture_float&&de.push("float","float32");function oe(ye,ce,Z){this.target=ye,this.texture=ce,this.renderbuffer=Z;var ke=0,$e=0;ce?(ke=ce.width,$e=ce.height):Z&&(ke=Z.width,$e=Z.height),this.width=ke,this.height=$e}function le(ye){ye&&(ye.texture&&ye.texture._texture.decRef(),ye.renderbuffer&&ye.renderbuffer._renderbuffer.decRef())}function be(ye,ce,Z){if(ye)if(ye.texture){var ke=ye.texture._texture,$e=Math.max(1,ke.width),Ae=Math.max(1,ke.height);m($e===ce&&Ae===Z,"inconsistent width/height for supplied texture"),ke.refCount+=1}else{var He=ye.renderbuffer._renderbuffer;m(He.width===ce&&He.height===Z,"inconsistent width/height for renderbuffer"),He.refCount+=1}}function ie(ye,ce){ce&&(ce.texture?r.framebufferTexture2D(Jt,ye,ce.target,ce.texture._texture.texture,0):r.framebufferRenderbuffer(Jt,ye,Ma,ce.renderbuffer._renderbuffer.renderbuffer))}function he(ye){var ce=hr,Z=null,ke=null,$e=ye;typeof ye=="object"&&($e=ye.data,"target"in ye&&(ce=ye.target|0)),m.type($e,"function","invalid attachment data");var Ae=$e._reglType;return Ae==="texture2d"?(Z=$e,m(ce===hr)):Ae==="textureCube"?(Z=$e,m(ce>=Dn&&ce<Dn+6,"invalid cube map target")):Ae==="renderbuffer"?(ke=$e,ce=Ma):m.raise("invalid regl object for attachment"),new oe(ce,Z,ke)}function M(ye,ce,Z,ke,$e){if(Z){var Ae=z.create2D({width:ye,height:ce,format:ke,type:$e});return Ae._texture.refCount=0,new oe(hr,Ae,null)}else{var He=K.create({width:ye,height:ce,format:ke});return He._renderbuffer.refCount=0,new oe(Ma,null,He)}}function H(ye){return ye&&(ye.texture||ye.renderbuffer)}function se(ye,ce,Z){ye&&(ye.texture?ye.texture.resize(ce,Z):ye.renderbuffer&&ye.renderbuffer.resize(ce,Z),ye.width=ce,ye.height=Z)}var ge=0,J={};function xe(){this.id=ge++,J[this.id]=this,this.framebuffer=r.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function te(ye){ye.colorAttachments.forEach(le),le(ye.depthAttachment),le(ye.stencilAttachment),le(ye.depthStencilAttachment)}function pe(ye){var ce=ye.framebuffer;m(ce,"must not double destroy framebuffer"),r.deleteFramebuffer(ce),ye.framebuffer=null,j.framebufferCount--,delete J[ye.id]}function ee(ye){var ce;r.bindFramebuffer(Jt,ye.framebuffer);var Z=ye.colorAttachments;for(ce=0;ce<Z.length;++ce)ie(ho+ce,Z[ce]);for(ce=Z.length;ce<y.maxColorAttachments;++ce)r.framebufferTexture2D(Jt,ho+ce,hr,null,0);r.framebufferTexture2D(Jt,vo,hr,null,0),r.framebufferTexture2D(Jt,mo,hr,null,0),r.framebufferTexture2D(Jt,po,hr,null,0),ie(mo,ye.depthAttachment),ie(po,ye.stencilAttachment),ie(vo,ye.depthStencilAttachment);var ke=r.checkFramebufferStatus(Jt);!r.isContextLost()&&ke!==bo&&m.raise("framebuffer configuration not supported, status = "+Dr[ke]),r.bindFramebuffer(Jt,V.next?V.next.framebuffer:null),V.cur=V.next,r.getError()}function ve(ye,ce){var Z=new xe;j.framebufferCount++;function ke(Ae,He){var Be;m(V.next!==Z,"can not update framebuffer which is currently in use");var qe=0,Qe=0,pt=!0,xt=!0,Ye=null,bt=!0,it="rgba",vt="uint8",yt=1,gt=null,Et=null,Tt=null,ct=!1;if(typeof Ae=="number")qe=Ae|0,Qe=He|0||qe;else if(!Ae)qe=Qe=1;else{m.type(Ae,"object","invalid arguments for framebuffer");var je=Ae;if("shape"in je){var St=je.shape;m(Array.isArray(St)&&St.length>=2,"invalid shape for framebuffer"),qe=St[0],Qe=St[1]}else"radius"in je&&(qe=Qe=je.radius),"width"in je&&(qe=je.width),"height"in je&&(Qe=je.height);("color"in je||"colors"in je)&&(Ye=je.color||je.colors,Array.isArray(Ye)&&m(Ye.length===1||s.webgl_draw_buffers,"multiple render targets not supported")),Ye||("colorCount"in je&&(yt=je.colorCount|0,m(yt>0,"invalid color buffer count")),"colorTexture"in je&&(bt=!!je.colorTexture,it="rgba4"),"colorType"in je&&(vt=je.colorType,bt?(m(s.oes_texture_float||!(vt==="float"||vt==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),m(s.oes_texture_half_float||!(vt==="half float"||vt==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):vt==="half float"||vt==="float16"?(m(s.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),it="rgba16f"):(vt==="float"||vt==="float32")&&(m(s.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),it="rgba32f"),m.oneOf(vt,de,"invalid color type")),"colorFormat"in je&&(it=je.colorFormat,ae.indexOf(it)>=0?bt=!0:ue.indexOf(it)>=0?bt=!1:bt?m.oneOf(je.colorFormat,ae,"invalid color format for texture"):m.oneOf(je.colorFormat,ue,"invalid color format for renderbuffer"))),("depthTexture"in je||"depthStencilTexture"in je)&&(ct=!!(je.depthTexture||je.depthStencilTexture),m(!ct||s.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in je&&(typeof je.depth=="boolean"?pt=je.depth:(gt=je.depth,xt=!1)),"stencil"in je&&(typeof je.stencil=="boolean"?xt=je.stencil:(Et=je.stencil,pt=!1)),"depthStencil"in je&&(typeof je.depthStencil=="boolean"?pt=xt=je.depthStencil:(Tt=je.depthStencil,pt=!1,xt=!1))}var et=null,Fe=null,We=null,Ke=null;if(Array.isArray(Ye))et=Ye.map(he);else if(Ye)et=[he(Ye)];else for(et=new Array(yt),Be=0;Be<yt;++Be)et[Be]=M(qe,Qe,bt,it,vt);m(s.webgl_draw_buffers||et.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),m(et.length<=y.maxColorAttachments,"too many color attachments, not supported"),qe=qe||et[0].width,Qe=Qe||et[0].height,gt?Fe=he(gt):pt&&!xt&&(Fe=M(qe,Qe,ct,"depth","uint32")),Et?We=he(Et):xt&&!pt&&(We=M(qe,Qe,!1,"stencil","uint8")),Tt?Ke=he(Tt):!gt&&!Et&&xt&&pt&&(Ke=M(qe,Qe,ct,"depth stencil","depth stencil")),m(!!gt+!!Et+!!Tt<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var lt=null;for(Be=0;Be<et.length;++Be)if(be(et[Be],qe,Qe),m(!et[Be]||et[Be].texture&&Hc.indexOf(et[Be].texture._texture.format)>=0||et[Be].renderbuffer&&rl.indexOf(et[Be].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Be+" is invalid"),et[Be]&&et[Be].texture){var Kt=Ga[et[Be].texture._texture.format]*kn[et[Be].texture._texture.type];lt===null?lt=Kt:m(lt===Kt,"all color attachments much have the same number of bits per pixel.")}return be(Fe,qe,Qe),m(!Fe||Fe.texture&&Fe.texture._texture.format===Vc||Fe.renderbuffer&&Fe.renderbuffer._renderbuffer.format===Kc,"invalid depth attachment for framebuffer object"),be(We,qe,Qe),m(!We||We.renderbuffer&&We.renderbuffer._renderbuffer.format===Qc,"invalid stencil attachment for framebuffer object"),be(Ke,qe,Qe),m(!Ke||Ke.texture&&Ke.texture._texture.format===_o||Ke.renderbuffer&&Ke.renderbuffer._renderbuffer.format===_o,"invalid depth-stencil attachment for framebuffer object"),te(Z),Z.width=qe,Z.height=Qe,Z.colorAttachments=et,Z.depthAttachment=Fe,Z.stencilAttachment=We,Z.depthStencilAttachment=Ke,ke.color=et.map(H),ke.depth=H(Fe),ke.stencil=H(We),ke.depthStencil=H(Ke),ke.width=Z.width,ke.height=Z.height,ee(Z),ke}function $e(Ae,He){m(V.next!==Z,"can not resize a framebuffer which is currently in use");var Be=Math.max(Ae|0,1),qe=Math.max(He|0||Be,1);if(Be===Z.width&&qe===Z.height)return ke;for(var Qe=Z.colorAttachments,pt=0;pt<Qe.length;++pt)se(Qe[pt],Be,qe);return se(Z.depthAttachment,Be,qe),se(Z.stencilAttachment,Be,qe),se(Z.depthStencilAttachment,Be,qe),Z.width=ke.width=Be,Z.height=ke.height=qe,ee(Z),ke}return ke(ye,ce),i(ke,{resize:$e,_reglType:"framebuffer",_framebuffer:Z,destroy:function(){pe(Z),te(Z)},use:function(Ae){V.setFBO({framebuffer:ke},Ae)}})}function Ce(ye){var ce=Array(6);function Z($e){var Ae;m(ce.indexOf(V.next)<0,"can not update framebuffer which is currently in use");var He={color:null},Be=0,qe=null,Qe="rgba",pt="uint8",xt=1;if(typeof $e=="number")Be=$e|0;else if(!$e)Be=1;else{m.type($e,"object","invalid arguments for framebuffer");var Ye=$e;if("shape"in Ye){var bt=Ye.shape;m(Array.isArray(bt)&&bt.length>=2,"invalid shape for framebuffer"),m(bt[0]===bt[1],"cube framebuffer must be square"),Be=bt[0]}else"radius"in Ye&&(Be=Ye.radius|0),"width"in Ye?(Be=Ye.width|0,"height"in Ye&&m(Ye.height===Be,"must be square")):"height"in Ye&&(Be=Ye.height|0);("color"in Ye||"colors"in Ye)&&(qe=Ye.color||Ye.colors,Array.isArray(qe)&&m(qe.length===1||s.webgl_draw_buffers,"multiple render targets not supported")),qe||("colorCount"in Ye&&(xt=Ye.colorCount|0,m(xt>0,"invalid color buffer count")),"colorType"in Ye&&(m.oneOf(Ye.colorType,de,"invalid color type"),pt=Ye.colorType),"colorFormat"in Ye&&(Qe=Ye.colorFormat,m.oneOf(Ye.colorFormat,ae,"invalid color format for texture"))),"depth"in Ye&&(He.depth=Ye.depth),"stencil"in Ye&&(He.stencil=Ye.stencil),"depthStencil"in Ye&&(He.depthStencil=Ye.depthStencil)}var it;if(qe)if(Array.isArray(qe))for(it=[],Ae=0;Ae<qe.length;++Ae)it[Ae]=qe[Ae];else it=[qe];else{it=Array(xt);var vt={radius:Be,format:Qe,type:pt};for(Ae=0;Ae<xt;++Ae)it[Ae]=z.createCube(vt)}for(He.color=Array(it.length),Ae=0;Ae<it.length;++Ae){var yt=it[Ae];m(typeof yt=="function"&&yt._reglType==="textureCube","invalid cube map"),Be=Be||yt.width,m(yt.width===Be&&yt.height===Be,"invalid cube map shape"),He.color[Ae]={target:Dn,data:it[Ae]}}for(Ae=0;Ae<6;++Ae){for(var gt=0;gt<it.length;++gt)He.color[gt].target=Dn+Ae;Ae>0&&(He.depth=ce[0].depth,He.stencil=ce[0].stencil,He.depthStencil=ce[0].depthStencil),ce[Ae]?ce[Ae](He):ce[Ae]=ve(He)}return i(Z,{width:Be,height:Be,color:it})}function ke($e){var Ae,He=$e|0;if(m(He>0&&He<=y.maxCubeMapSize,"invalid radius for cube fbo"),He===Z.width)return Z;var Be=Z.color;for(Ae=0;Ae<Be.length;++Ae)Be[Ae].resize(He);for(Ae=0;Ae<6;++Ae)ce[Ae].resize(He);return Z.width=Z.height=He,Z}return Z(ye),i(Z,{faces:ce,resize:ke,_reglType:"framebufferCube",destroy:function(){ce.forEach(function($e){$e.destroy()})}})}function Ne(){V.cur=null,V.next=null,V.dirty=!0,$t(J).forEach(function(ye){ye.framebuffer=r.createFramebuffer(),ee(ye)})}return i(V,{getFramebuffer:function(ye){if(typeof ye=="function"&&ye._reglType==="framebuffer"){var ce=ye._framebuffer;if(ce instanceof xe)return ce}return null},create:ve,createCube:Ce,clear:function(){$t(J).forEach(pe)},restore:Ne})}var al=5126,xo=34962;function Ia(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=al,this.offset=0,this.stride=0,this.divisor=0}function il(r,s,y,z,K){for(var j=y.maxAttributes,V=new Array(j),ae=0;ae<j;++ae)V[ae]=new Ia;var ue=0,de={},oe={Record:Ia,scope:{},state:V,currentVAO:null,targetVAO:null,restore:be()?J:function(){},createVAO:xe,getVAO:he,destroyBuffer:le,setVAO:be()?M:H,clear:be()?se:function(){}};function le(te){for(var pe=0;pe<V.length;++pe){var ee=V[pe];ee.buffer===te&&(r.disableVertexAttribArray(pe),ee.buffer=null)}}function be(){return s.oes_vertex_array_object}function ie(){return s.angle_instanced_arrays}function he(te){return typeof te=="function"&&te._vao?te._vao:null}function M(te){if(te!==oe.currentVAO){var pe=be();te?pe.bindVertexArrayOES(te.vao):pe.bindVertexArrayOES(null),oe.currentVAO=te}}function H(te){if(te!==oe.currentVAO){if(te)te.bindAttrs();else for(var pe=ie(),ee=0;ee<V.length;++ee){var ve=V[ee];ve.buffer?(r.enableVertexAttribArray(ee),r.vertexAttribPointer(ee,ve.size,ve.type,ve.normalized,ve.stride,ve.offfset),pe&&ve.divisor&&pe.vertexAttribDivisorANGLE(ee,ve.divisor)):(r.disableVertexAttribArray(ee),r.vertexAttrib4f(ee,ve.x,ve.y,ve.z,ve.w))}oe.currentVAO=te}}function se(){$t(de).forEach(function(te){te.destroy()})}function ge(){this.id=++ue,this.attributes=[];var te=be();te?this.vao=te.createVertexArrayOES():this.vao=null,de[this.id]=this,this.buffers=[]}ge.prototype.bindAttrs=function(){for(var te=ie(),pe=this.attributes,ee=0;ee<pe.length;++ee){var ve=pe[ee];ve.buffer?(r.enableVertexAttribArray(ee),r.bindBuffer(xo,ve.buffer.buffer),r.vertexAttribPointer(ee,ve.size,ve.type,ve.normalized,ve.stride,ve.offset),te&&ve.divisor&&te.vertexAttribDivisorANGLE(ee,ve.divisor)):(r.disableVertexAttribArray(ee),r.vertexAttrib4f(ee,ve.x,ve.y,ve.z,ve.w))}for(var Ce=pe.length;Ce<j;++Ce)r.disableVertexAttribArray(Ce)},ge.prototype.refresh=function(){var te=be();te&&(te.bindVertexArrayOES(this.vao),this.bindAttrs(),oe.currentVAO=this)},ge.prototype.destroy=function(){if(this.vao){var te=be();this===oe.currentVAO&&(oe.currentVAO=null,te.bindVertexArrayOES(null)),te.deleteVertexArrayOES(this.vao),this.vao=null}de[this.id]&&(delete de[this.id],z.vaoCount-=1)};function J(){var te=be();te&&$t(de).forEach(function(pe){pe.refresh()})}function xe(te){var pe=new ge;z.vaoCount+=1;function ee(ve){m(Array.isArray(ve),"arguments to vertex array constructor must be an array"),m(ve.length<j,"too many attributes"),m(ve.length>0,"must specify at least one attribute");var Ce={},Ne=pe.attributes;Ne.length=ve.length;for(var ye=0;ye<ve.length;++ye){var ce=ve[ye],Z=Ne[ye]=new Ia,ke=ce.data||ce;if(Array.isArray(ke)||n(ke)||Vt(ke)){var $e;pe.buffers[ye]&&($e=pe.buffers[ye],n(ke)&&$e._buffer.byteLength>=ke.byteLength?$e.subdata(ke):($e.destroy(),pe.buffers[ye]=null)),pe.buffers[ye]||($e=pe.buffers[ye]=K.create(ce,xo,!1,!0)),Z.buffer=K.getBuffer($e),Z.size=Z.buffer.dimension|0,Z.normalized=!1,Z.type=Z.buffer.dtype,Z.offset=0,Z.stride=0,Z.divisor=0,Z.state=1,Ce[ye]=1}else K.getBuffer(ce)?(Z.buffer=K.getBuffer(ce),Z.size=Z.buffer.dimension|0,Z.normalized=!1,Z.type=Z.buffer.dtype,Z.offset=0,Z.stride=0,Z.divisor=0,Z.state=1):K.getBuffer(ce.buffer)?(Z.buffer=K.getBuffer(ce.buffer),Z.size=(+ce.size||Z.buffer.dimension)|0,Z.normalized=!!ce.normalized||!1,"type"in ce?(m.parameter(ce.type,sr,"invalid buffer type"),Z.type=sr[ce.type]):Z.type=Z.buffer.dtype,Z.offset=(ce.offset||0)|0,Z.stride=(ce.stride||0)|0,Z.divisor=(ce.divisor||0)|0,Z.state=1,m(Z.size>=1&&Z.size<=4,"size must be between 1 and 4"),m(Z.offset>=0,"invalid offset"),m(Z.stride>=0&&Z.stride<=255,"stride must be between 0 and 255"),m(Z.divisor>=0,"divisor must be positive"),m(!Z.divisor||!!s.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in ce?(m(ye>0,"first attribute must not be a constant"),Z.x=+ce.x||0,Z.y=+ce.y||0,Z.z=+ce.z||0,Z.w=+ce.w||0,Z.state=2):m(!1,"invalid attribute spec for location "+ye)}for(var Ae=0;Ae<pe.buffers.length;++Ae)!Ce[Ae]&&pe.buffers[Ae]&&(pe.buffers[Ae].destroy(),pe.buffers[Ae]=null);return pe.refresh(),ee}return ee.destroy=function(){for(var ve=0;ve<pe.buffers.length;++ve)pe.buffers[ve]&&pe.buffers[ve].destroy();pe.buffers.length=0,pe.destroy()},ee._vao=pe,ee._reglType="vao",ee(te)}return oe}var wo=35632,ul=35633,ol=35718,fl=35721;function sl(r,s,y,z){var K={},j={};function V(M,H,se,ge){this.name=M,this.id=H,this.location=se,this.info=ge}function ae(M,H){for(var se=0;se<M.length;++se)if(M[se].id===H.id){M[se].location=H.location;return}M.push(H)}function ue(M,H,se){var ge=M===wo?K:j,J=ge[H];if(!J){var xe=s.str(H);J=r.createShader(M),r.shaderSource(J,xe),r.compileShader(J),m.shaderError(r,J,xe,M,se),ge[H]=J}return J}var de={},oe=[],le=0;function be(M,H){this.id=le++,this.fragId=M,this.vertId=H,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,z.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function ie(M,H,se){var ge,J,xe=ue(wo,M.fragId),te=ue(ul,M.vertId),pe=M.program=r.createProgram();if(r.attachShader(pe,xe),r.attachShader(pe,te),se)for(ge=0;ge<se.length;++ge){var ee=se[ge];r.bindAttribLocation(pe,ee[0],ee[1])}r.linkProgram(pe),m.linkError(r,pe,s.str(M.fragId),s.str(M.vertId),H);var ve=r.getProgramParameter(pe,ol);z.profile&&(M.stats.uniformsCount=ve);var Ce=M.uniforms;for(ge=0;ge<ve;++ge)if(J=r.getActiveUniform(pe,ge),J)if(J.size>1)for(var Ne=0;Ne<J.size;++Ne){var ye=J.name.replace("[0]","["+Ne+"]");ae(Ce,new V(ye,s.id(ye),r.getUniformLocation(pe,ye),J))}else ae(Ce,new V(J.name,s.id(J.name),r.getUniformLocation(pe,J.name),J));var ce=r.getProgramParameter(pe,fl);z.profile&&(M.stats.attributesCount=ce);var Z=M.attributes;for(ge=0;ge<ce;++ge)J=r.getActiveAttrib(pe,ge),J&&ae(Z,new V(J.name,s.id(J.name),r.getAttribLocation(pe,J.name),J))}z.profile&&(y.getMaxUniformsCount=function(){var M=0;return oe.forEach(function(H){H.stats.uniformsCount>M&&(M=H.stats.uniformsCount)}),M},y.getMaxAttributesCount=function(){var M=0;return oe.forEach(function(H){H.stats.attributesCount>M&&(M=H.stats.attributesCount)}),M});function he(){K={},j={};for(var M=0;M<oe.length;++M)ie(oe[M],null,oe[M].attributes.map(function(H){return[H.location,H.name]}))}return{clear:function(){var M=r.deleteShader.bind(r);$t(K).forEach(M),K={},$t(j).forEach(M),j={},oe.forEach(function(H){r.deleteProgram(H.program)}),oe.length=0,de={},y.shaderCount=0},program:function(M,H,se,ge){m.command(M>=0,"missing vertex shader",se),m.command(H>=0,"missing fragment shader",se);var J=de[H];J||(J=de[H]={});var xe=J[M];if(xe&&(xe.refCount++,!ge))return xe;var te=new be(H,M);return y.shaderCount++,ie(te,se,ge),xe||(J[M]=te),oe.push(te),i(te,{destroy:function(){if(te.refCount--,te.refCount<=0){r.deleteProgram(te.program);var pe=oe.indexOf(te);oe.splice(pe,1),y.shaderCount--}J[te.vertId].refCount<=0&&(r.deleteShader(j[te.vertId]),delete j[te.vertId],delete de[te.fragId][te.vertId]),Object.keys(de[te.fragId]).length||(r.deleteShader(K[te.fragId]),delete K[te.fragId],delete de[te.fragId])}})},restore:he,shader:ue,frag:-1,vert:-1}}var dl=6408,Zr=5121,cl=3333,Mn=5126;function ll(r,s,y,z,K,j,V){function ae(oe){var le;s.next===null?(m(K.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),le=Zr):(m(s.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),le=s.next.colorAttachments[0].texture._texture.type,j.oes_texture_float?(m(le===Zr||le===Mn,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),le===Mn&&m(V.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):m(le===Zr,"Reading from a framebuffer is only allowed for the type 'uint8'"));var be=0,ie=0,he=z.framebufferWidth,M=z.framebufferHeight,H=null;n(oe)?H=oe:oe&&(m.type(oe,"object","invalid arguments to regl.read()"),be=oe.x|0,ie=oe.y|0,m(be>=0&&be<z.framebufferWidth,"invalid x offset for regl.read"),m(ie>=0&&ie<z.framebufferHeight,"invalid y offset for regl.read"),he=(oe.width||z.framebufferWidth-be)|0,M=(oe.height||z.framebufferHeight-ie)|0,H=oe.data||null),H&&(le===Zr?m(H instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):le===Mn&&m(H instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),m(he>0&&he+be<=z.framebufferWidth,"invalid width for read pixels"),m(M>0&&M+ie<=z.framebufferHeight,"invalid height for read pixels"),y();var se=he*M*4;return H||(le===Zr?H=new Uint8Array(se):le===Mn&&(H=H||new Float32Array(se))),m.isTypedArray(H,"data buffer for regl.read() must be a typedarray"),m(H.byteLength>=se,"data buffer for regl.read() too small"),r.pixelStorei(cl,4),r.readPixels(be,ie,he,M,dl,le,H),H}function ue(oe){var le;return s.setFBO({framebuffer:oe.framebuffer},function(){le=ae(oe)}),le}function de(oe){return!oe||!("framebuffer"in oe)?ae(oe):ue(oe)}return de}function kr(r){return Array.prototype.slice.call(r)}function Mr(r){return kr(r).join("")}function hl(){var r=0,s=[],y=[];function z(le){for(var be=0;be<y.length;++be)if(y[be]===le)return s[be];var ie="g"+r++;return s.push(ie),y.push(le),ie}function K(){var le=[];function be(){le.push.apply(le,kr(arguments))}var ie=[];function he(){var M="v"+r++;return ie.push(M),arguments.length>0&&(le.push(M,"="),le.push.apply(le,kr(arguments)),le.push(";")),M}return i(be,{def:he,toString:function(){return Mr([ie.length>0?"var "+ie.join(",")+";":"",Mr(le)])}})}function j(){var le=K(),be=K(),ie=le.toString,he=be.toString;function M(H,se){be(H,se,"=",le.def(H,se),";")}return i(function(){le.apply(le,kr(arguments))},{def:le.def,entry:le,exit:be,save:M,set:function(H,se,ge){M(H,se),le(H,se,"=",ge,";")},toString:function(){return ie()+he()}})}function V(){var le=Mr(arguments),be=j(),ie=j(),he=be.toString,M=ie.toString;return i(be,{then:function(){return be.apply(be,kr(arguments)),this},else:function(){return ie.apply(ie,kr(arguments)),this},toString:function(){var H=M();return H&&(H="else{"+H+"}"),Mr(["if(",le,"){",he(),"}",H])}})}var ae=K(),ue={};function de(le,be){var ie=[];function he(){var J="a"+ie.length;return ie.push(J),J}be=be||0;for(var M=0;M<be;++M)he();var H=j(),se=H.toString,ge=ue[le]=i(H,{arg:he,toString:function(){return Mr(["function(",ie.join(),"){",se(),"}"])}});return ge}function oe(){var le=['"use strict";',ae,"return {"];Object.keys(ue).forEach(function(he){le.push('"',he,'":',ue[he].toString(),",")}),le.push("}");var be=Mr(le).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),ie=Function.apply(null,s.concat(be));return ie.apply(null,y)}return{global:ae,link:z,block:K,proc:de,scope:j,cond:V,compile:oe}}var Gr="xyzw".split(""),Eo=5121,Ir=1,Na=2,Ba=0,Pa=1,$a=2,ja=3,Gn=4,Ao=5,To=6,So="dither",Ro="blend.enable",Lo="blend.color",za="blend.equation",Ua="blend.func",Co="depth.enable",Oo="depth.func",Fo="depth.range",Do="depth.mask",qa="colorMask",ko="cull.enable",Mo="cull.face",Va="frontFace",Ha="lineWidth",Go="polygonOffset.enable",Xa="polygonOffset.offset",Io="sample.alpha",No="sample.enable",Wa="sample.coverage",Bo="stencil.enable",Po="stencil.mask",Ya="stencil.func",Ka="stencil.opFront",Jr="stencil.opBack",$o="scissor.enable",In="scissor.box",er="viewport",en="profile",mr="framebuffer",tn="vert",rn="frag",pr="elements",vr="primitive",br="count",Nn="offset",Bn="instances",nn="vao",Qa="Width",Za="Height",Nr=mr+Qa,Br=mr+Za,ml=er+Qa,pl=er+Za,jo="drawingBuffer",zo=jo+Qa,Uo=jo+Za,vl=[Ua,za,Ya,Ka,Jr,Wa,er,In,Xa],Pr=34962,bl=34963,yl=35632,gl=35633,qo=3553,_l=34067,xl=2884,wl=3042,El=3024,Al=2960,Tl=2929,Sl=3089,Rl=32823,Ll=32926,Cl=32928,Ja=5126,Pn=35664,$n=35665,jn=35666,ei=5124,zn=35667,Un=35668,qn=35669,ti=35670,Vn=35671,Hn=35672,Xn=35673,an=35674,un=35675,on=35676,fn=35678,sn=35680,Vo=4,dn=1028,yr=1029,Ho=2304,ri=2305,Ol=32775,Fl=32776,Dl=519,ar=7680,Xo=0,Wo=1,Yo=32774,kl=513,Ko=36160,Ml=36064,Yt={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Qo=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],$r={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},ir={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Zo={frag:yl,vert:gl},ni={cw:Ho,ccw:ri};function Wn(r){return Array.isArray(r)||n(r)||Vt(r)}function Jo(r){return r.sort(function(s,y){return s===er?-1:y===er?1:s<y?-1:1})}function Dt(r,s,y,z){this.thisDep=r,this.contextDep=s,this.propDep=y,this.append=z}function ur(r){return r&&!(r.thisDep||r.contextDep||r.propDep)}function mt(r){return new Dt(!1,!1,!1,r)}function It(r,s){var y=r.type;if(y===Ba){var z=r.data.length;return new Dt(!0,z>=1,z>=2,s)}else if(y===Gn){var K=r.data;return new Dt(K.thisDep,K.contextDep,K.propDep,s)}else{if(y===Ao)return new Dt(!1,!1,!1,s);if(y===To){for(var j=!1,V=!1,ae=!1,ue=0;ue<r.data.length;++ue){var de=r.data[ue];if(de.type===Pa)ae=!0;else if(de.type===$a)V=!0;else if(de.type===ja)j=!0;else if(de.type===Ba){j=!0;var oe=de.data;oe>=1&&(V=!0),oe>=2&&(ae=!0)}else de.type===Gn&&(j=j||de.data.thisDep,V=V||de.data.contextDep,ae=ae||de.data.propDep)}return new Dt(j,V,ae,s)}else return new Dt(y===ja,y===$a,y===Pa,s)}}var ef=new Dt(!1,!1,!1,function(){});function Gl(r,s,y,z,K,j,V,ae,ue,de,oe,le,be,ie,he){var M=de.Record,H={add:32774,subtract:32778,"reverse subtract":32779};y.ext_blend_minmax&&(H.min=Ol,H.max=Fl);var se=y.angle_instanced_arrays,ge=y.webgl_draw_buffers,J={dirty:!0,profile:he.profile},xe={},te=[],pe={},ee={};function ve(l){return l.replace(".","_")}function Ce(l,f,w){var D=ve(l);te.push(l),xe[D]=J[D]=!!w,pe[D]=f}function Ne(l,f,w){var D=ve(l);te.push(l),Array.isArray(w)?(J[D]=w.slice(),xe[D]=w.slice()):J[D]=xe[D]=w,ee[D]=f}Ce(So,El),Ce(Ro,wl),Ne(Lo,"blendColor",[0,0,0,0]),Ne(za,"blendEquationSeparate",[Yo,Yo]),Ne(Ua,"blendFuncSeparate",[Wo,Xo,Wo,Xo]),Ce(Co,Tl,!0),Ne(Oo,"depthFunc",kl),Ne(Fo,"depthRange",[0,1]),Ne(Do,"depthMask",!0),Ne(qa,qa,[!0,!0,!0,!0]),Ce(ko,xl),Ne(Mo,"cullFace",yr),Ne(Va,Va,ri),Ne(Ha,Ha,1),Ce(Go,Rl),Ne(Xa,"polygonOffset",[0,0]),Ce(Io,Ll),Ce(No,Cl),Ne(Wa,"sampleCoverage",[1,!1]),Ce(Bo,Al),Ne(Po,"stencilMask",-1),Ne(Ya,"stencilFunc",[Dl,0,-1]),Ne(Ka,"stencilOpSeparate",[dn,ar,ar,ar]),Ne(Jr,"stencilOpSeparate",[yr,ar,ar,ar]),Ce($o,Sl),Ne(In,"scissor",[0,0,r.drawingBufferWidth,r.drawingBufferHeight]),Ne(er,er,[0,0,r.drawingBufferWidth,r.drawingBufferHeight]);var ye={gl:r,context:be,strings:s,next:xe,current:J,draw:le,elements:j,buffer:K,shader:oe,attributes:de.state,vao:de,uniforms:ue,framebuffer:ae,extensions:y,timer:ie,isBufferArgs:Wn},ce={primTypes:Tr,compareFuncs:$r,blendFuncs:Yt,blendEquations:H,stencilOps:ir,glTypes:sr,orientationType:ni};m.optional(function(){ye.isArrayLike=dt}),ge&&(ce.backBuffer=[yr],ce.drawBuffer=Gt(z.maxDrawbuffers,function(l){return l===0?[0]:Gt(l,function(f){return Ml+f})}));var Z=0;function ke(){var l=hl(),f=l.link,w=l.global;l.id=Z++,l.batchId="0";var D=f(ye),I=l.shared={props:"a0"};Object.keys(ye).forEach(function(_){I[_]=w.def(D,".",_)}),m.optional(function(){l.CHECK=f(m),l.commandStr=m.guessCommand(),l.command=f(l.commandStr),l.assert=function(_,d,F){_("if(!(",d,"))",this.CHECK,".commandRaise(",f(F),",",this.command,");")},ce.invalidBlendCombinations=Qo});var T=l.next={},E=l.current={};Object.keys(ee).forEach(function(_){Array.isArray(J[_])&&(T[_]=w.def(I.next,".",_),E[_]=w.def(I.current,".",_))});var L=l.constants={};Object.keys(ce).forEach(function(_){L[_]=w.def(JSON.stringify(ce[_]))}),l.invoke=function(_,d){switch(d.type){case Ba:var F=["this",I.context,I.props,l.batchId];return _.def(f(d.data),".call(",F.slice(0,Math.max(d.data.length+1,4)),")");case Pa:return _.def(I.props,d.data);case $a:return _.def(I.context,d.data);case ja:return _.def("this",d.data);case Gn:return d.data.append(l,_),d.data.ref;case Ao:return d.data.toString();case To:return d.data.map(function(N){return l.invoke(_,N)})}},l.attribCache={};var h={};return l.scopeAttrib=function(_){var d=s.id(_);if(d in h)return h[d];var F=de.scope[d];F||(F=de.scope[d]=new M);var N=h[d]=f(F);return N},l}function $e(l){var f=l.static,w=l.dynamic,D;if(en in f){var I=!!f[en];D=mt(function(E,L){return I}),D.enable=I}else if(en in w){var T=w[en];D=It(T,function(E,L){return E.invoke(L,T)})}return D}function Ae(l,f){var w=l.static,D=l.dynamic;if(mr in w){var I=w[mr];return I?(I=ae.getFramebuffer(I),m.command(I,"invalid framebuffer object"),mt(function(E,L){var h=E.link(I),_=E.shared;L.set(_.framebuffer,".next",h);var d=_.context;return L.set(d,"."+Nr,h+".width"),L.set(d,"."+Br,h+".height"),h})):mt(function(E,L){var h=E.shared;L.set(h.framebuffer,".next","null");var _=h.context;return L.set(_,"."+Nr,_+"."+zo),L.set(_,"."+Br,_+"."+Uo),"null"})}else if(mr in D){var T=D[mr];return It(T,function(E,L){var h=E.invoke(L,T),_=E.shared,d=_.framebuffer,F=L.def(d,".getFramebuffer(",h,")");m.optional(function(){E.assert(L,"!"+h+"||"+F,"invalid framebuffer object")}),L.set(d,".next",F);var N=_.context;return L.set(N,"."+Nr,F+"?"+F+".width:"+N+"."+zo),L.set(N,"."+Br,F+"?"+F+".height:"+N+"."+Uo),F})}else return null}function He(l,f,w){var D=l.static,I=l.dynamic;function T(h){if(h in D){var _=D[h];m.commandType(_,"object","invalid "+h,w.commandStr);var d=!0,F=_.x|0,N=_.y|0,Y,Q;return"width"in _?(Y=_.width|0,m.command(Y>=0,"invalid "+h,w.commandStr)):d=!1,"height"in _?(Q=_.height|0,m.command(Q>=0,"invalid "+h,w.commandStr)):d=!1,new Dt(!d&&f&&f.thisDep,!d&&f&&f.contextDep,!d&&f&&f.propDep,function(Re,ze){var Te=Re.shared.context,De=Y;"width"in _||(De=ze.def(Te,".",Nr,"-",F));var Pe=Q;return"height"in _||(Pe=ze.def(Te,".",Br,"-",N)),[F,N,De,Pe]})}else if(h in I){var X=I[h],fe=It(X,function(Re,ze){var Te=Re.invoke(ze,X);m.optional(function(){Re.assert(ze,Te+"&&typeof "+Te+'==="object"',"invalid "+h)});var De=Re.shared.context,Pe=ze.def(Te,".x|0"),Ze=ze.def(Te,".y|0"),st=ze.def('"width" in ',Te,"?",Te,".width|0:","(",De,".",Nr,"-",Pe,")"),kt=ze.def('"height" in ',Te,"?",Te,".height|0:","(",De,".",Br,"-",Ze,")");return m.optional(function(){Re.assert(ze,st+">=0&&"+kt+">=0","invalid "+h)}),[Pe,Ze,st,kt]});return f&&(fe.thisDep=fe.thisDep||f.thisDep,fe.contextDep=fe.contextDep||f.contextDep,fe.propDep=fe.propDep||f.propDep),fe}else return f?new Dt(f.thisDep,f.contextDep,f.propDep,function(Re,ze){var Te=Re.shared.context;return[0,0,ze.def(Te,".",Nr),ze.def(Te,".",Br)]}):null}var E=T(er);if(E){var L=E;E=new Dt(E.thisDep,E.contextDep,E.propDep,function(h,_){var d=L.append(h,_),F=h.shared.context;return _.set(F,"."+ml,d[2]),_.set(F,"."+pl,d[3]),d})}return{viewport:E,scissor_box:T(In)}}function Be(l,f){var w=l.static,D=typeof w[rn]=="string"&&typeof w[tn]=="string";if(D){if(Object.keys(f.dynamic).length>0)return null;var I=f.static,T=Object.keys(I);if(T.length>0&&typeof I[T[0]]=="number"){for(var E=[],L=0;L<T.length;++L)m(typeof I[T[L]]=="number","must specify all vertex attribute locations when using vaos"),E.push([I[T[L]]|0,T[L]]);return E}}return null}function qe(l,f,w){var D=l.static,I=l.dynamic;function T(d){if(d in D){var F=s.id(D[d]);m.optional(function(){oe.shader(Zo[d],F,m.guessCommand())});var N=mt(function(){return F});return N.id=F,N}else if(d in I){var Y=I[d];return It(Y,function(Q,X){var fe=Q.invoke(X,Y),Re=X.def(Q.shared.strings,".id(",fe,")");return m.optional(function(){X(Q.shared.shader,".shader(",Zo[d],",",Re,",",Q.command,");")}),Re})}return null}var E=T(rn),L=T(tn),h=null,_;return ur(E)&&ur(L)?(h=oe.program(L.id,E.id,null,w),_=mt(function(d,F){return d.link(h)})):_=new Dt(E&&E.thisDep||L&&L.thisDep,E&&E.contextDep||L&&L.contextDep,E&&E.propDep||L&&L.propDep,function(d,F){var N=d.shared.shader,Y;E?Y=E.append(d,F):Y=F.def(N,".",rn);var Q;L?Q=L.append(d,F):Q=F.def(N,".",tn);var X=N+".program("+Q+","+Y;return m.optional(function(){X+=","+d.command}),F.def(X+")")}),{frag:E,vert:L,progVar:_,program:h}}function Qe(l,f){var w=l.static,D=l.dynamic;function I(){if(pr in w){var d=w[pr];Wn(d)?d=j.getElements(j.create(d,!0)):d&&(d=j.getElements(d),m.command(d,"invalid elements",f.commandStr));var F=mt(function(Y,Q){if(d){var X=Y.link(d);return Y.ELEMENTS=X,X}return Y.ELEMENTS=null,null});return F.value=d,F}else if(pr in D){var N=D[pr];return It(N,function(Y,Q){var X=Y.shared,fe=X.isBufferArgs,Re=X.elements,ze=Y.invoke(Q,N),Te=Q.def("null"),De=Q.def(fe,"(",ze,")"),Pe=Y.cond(De).then(Te,"=",Re,".createStream(",ze,");").else(Te,"=",Re,".getElements(",ze,");");return m.optional(function(){Y.assert(Pe.else,"!"+ze+"||"+Te,"invalid elements")}),Q.entry(Pe),Q.exit(Y.cond(De).then(Re,".destroyStream(",Te,");")),Y.ELEMENTS=Te,Te})}return null}var T=I();function E(){if(vr in w){var d=w[vr];return m.commandParameter(d,Tr,"invalid primitve",f.commandStr),mt(function(N,Y){return Tr[d]})}else if(vr in D){var F=D[vr];return It(F,function(N,Y){var Q=N.constants.primTypes,X=N.invoke(Y,F);return m.optional(function(){N.assert(Y,X+" in "+Q,"invalid primitive, must be one of "+Object.keys(Tr))}),Y.def(Q,"[",X,"]")})}else if(T)return ur(T)?T.value?mt(function(N,Y){return Y.def(N.ELEMENTS,".primType")}):mt(function(){return Vo}):new Dt(T.thisDep,T.contextDep,T.propDep,function(N,Y){var Q=N.ELEMENTS;return Y.def(Q,"?",Q,".primType:",Vo)});return null}function L(d,F){if(d in w){var N=w[d]|0;return m.command(!F||N>=0,"invalid "+d,f.commandStr),mt(function(Q,X){return F&&(Q.OFFSET=N),N})}else if(d in D){var Y=D[d];return It(Y,function(Q,X){var fe=Q.invoke(X,Y);return F&&(Q.OFFSET=fe,m.optional(function(){Q.assert(X,fe+">=0","invalid "+d)})),fe})}else if(F&&T)return mt(function(Q,X){return Q.OFFSET="0",0});return null}var h=L(Nn,!0);function _(){if(br in w){var d=w[br]|0;return m.command(typeof d=="number"&&d>=0,"invalid vertex count",f.commandStr),mt(function(){return d})}else if(br in D){var F=D[br];return It(F,function(Q,X){var fe=Q.invoke(X,F);return m.optional(function(){Q.assert(X,"typeof "+fe+'==="number"&&'+fe+">=0&&"+fe+"===("+fe+"|0)","invalid vertex count")}),fe})}else if(T)if(ur(T)){if(T)return h?new Dt(h.thisDep,h.contextDep,h.propDep,function(Q,X){var fe=X.def(Q.ELEMENTS,".vertCount-",Q.OFFSET);return m.optional(function(){Q.assert(X,fe+">=0","invalid vertex offset/element buffer too small")}),fe}):mt(function(Q,X){return X.def(Q.ELEMENTS,".vertCount")});var N=mt(function(){return-1});return m.optional(function(){N.MISSING=!0}),N}else{var Y=new Dt(T.thisDep||h.thisDep,T.contextDep||h.contextDep,T.propDep||h.propDep,function(Q,X){var fe=Q.ELEMENTS;return Q.OFFSET?X.def(fe,"?",fe,".vertCount-",Q.OFFSET,":-1"):X.def(fe,"?",fe,".vertCount:-1")});return m.optional(function(){Y.DYNAMIC=!0}),Y}return null}return{elements:T,primitive:E(),count:_(),instances:L(Bn,!1),offset:h}}function pt(l,f){var w=l.static,D=l.dynamic,I={};return te.forEach(function(T){var E=ve(T);function L(h,_){if(T in w){var d=h(w[T]);I[E]=mt(function(){return d})}else if(T in D){var F=D[T];I[E]=It(F,function(N,Y){return _(N,Y,N.invoke(Y,F))})}}switch(T){case ko:case Ro:case So:case Bo:case Co:case $o:case Go:case Io:case No:case Do:return L(function(h){return m.commandType(h,"boolean",T,f.commandStr),h},function(h,_,d){return m.optional(function(){h.assert(_,"typeof "+d+'==="boolean"',"invalid flag "+T,h.commandStr)}),d});case Oo:return L(function(h){return m.commandParameter(h,$r,"invalid "+T,f.commandStr),$r[h]},function(h,_,d){var F=h.constants.compareFuncs;return m.optional(function(){h.assert(_,d+" in "+F,"invalid "+T+", must be one of "+Object.keys($r))}),_.def(F,"[",d,"]")});case Fo:return L(function(h){return m.command(dt(h)&&h.length===2&&typeof h[0]=="number"&&typeof h[1]=="number"&&h[0]<=h[1],"depth range is 2d array",f.commandStr),h},function(h,_,d){m.optional(function(){h.assert(_,h.shared.isArrayLike+"("+d+")&&"+d+".length===2&&typeof "+d+'[0]==="number"&&typeof '+d+'[1]==="number"&&'+d+"[0]<="+d+"[1]","depth range must be a 2d array")});var F=_.def("+",d,"[0]"),N=_.def("+",d,"[1]");return[F,N]});case Ua:return L(function(h){m.commandType(h,"object","blend.func",f.commandStr);var _="srcRGB"in h?h.srcRGB:h.src,d="srcAlpha"in h?h.srcAlpha:h.src,F="dstRGB"in h?h.dstRGB:h.dst,N="dstAlpha"in h?h.dstAlpha:h.dst;return m.commandParameter(_,Yt,E+".srcRGB",f.commandStr),m.commandParameter(d,Yt,E+".srcAlpha",f.commandStr),m.commandParameter(F,Yt,E+".dstRGB",f.commandStr),m.commandParameter(N,Yt,E+".dstAlpha",f.commandStr),m.command(Qo.indexOf(_+", "+F)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+_+", "+F+")",f.commandStr),[Yt[_],Yt[F],Yt[d],Yt[N]]},function(h,_,d){var F=h.constants.blendFuncs;m.optional(function(){h.assert(_,d+"&&typeof "+d+'==="object"',"invalid blend func, must be an object")});function N(Te,De){var Pe=_.def('"',Te,De,'" in ',d,"?",d,".",Te,De,":",d,".",Te);return m.optional(function(){h.assert(_,Pe+" in "+F,"invalid "+T+"."+Te+De+", must be one of "+Object.keys(Yt))}),Pe}var Y=N("src","RGB"),Q=N("dst","RGB");m.optional(function(){var Te=h.constants.invalidBlendCombinations;h.assert(_,Te+".indexOf("+Y+'+", "+'+Q+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var X=_.def(F,"[",Y,"]"),fe=_.def(F,"[",N("src","Alpha"),"]"),Re=_.def(F,"[",Q,"]"),ze=_.def(F,"[",N("dst","Alpha"),"]");return[X,Re,fe,ze]});case za:return L(function(h){if(typeof h=="string")return m.commandParameter(h,H,"invalid "+T,f.commandStr),[H[h],H[h]];if(typeof h=="object")return m.commandParameter(h.rgb,H,T+".rgb",f.commandStr),m.commandParameter(h.alpha,H,T+".alpha",f.commandStr),[H[h.rgb],H[h.alpha]];m.commandRaise("invalid blend.equation",f.commandStr)},function(h,_,d){var F=h.constants.blendEquations,N=_.def(),Y=_.def(),Q=h.cond("typeof ",d,'==="string"');return m.optional(function(){function X(fe,Re,ze){h.assert(fe,ze+" in "+F,"invalid "+Re+", must be one of "+Object.keys(H))}X(Q.then,T,d),h.assert(Q.else,d+"&&typeof "+d+'==="object"',"invalid "+T),X(Q.else,T+".rgb",d+".rgb"),X(Q.else,T+".alpha",d+".alpha")}),Q.then(N,"=",Y,"=",F,"[",d,"];"),Q.else(N,"=",F,"[",d,".rgb];",Y,"=",F,"[",d,".alpha];"),_(Q),[N,Y]});case Lo:return L(function(h){return m.command(dt(h)&&h.length===4,"blend.color must be a 4d array",f.commandStr),Gt(4,function(_){return+h[_]})},function(h,_,d){return m.optional(function(){h.assert(_,h.shared.isArrayLike+"("+d+")&&"+d+".length===4","blend.color must be a 4d array")}),Gt(4,function(F){return _.def("+",d,"[",F,"]")})});case Po:return L(function(h){return m.commandType(h,"number",E,f.commandStr),h|0},function(h,_,d){return m.optional(function(){h.assert(_,"typeof "+d+'==="number"',"invalid stencil.mask")}),_.def(d,"|0")});case Ya:return L(function(h){m.commandType(h,"object",E,f.commandStr);var _=h.cmp||"keep",d=h.ref||0,F="mask"in h?h.mask:-1;return m.commandParameter(_,$r,T+".cmp",f.commandStr),m.commandType(d,"number",T+".ref",f.commandStr),m.commandType(F,"number",T+".mask",f.commandStr),[$r[_],d,F]},function(h,_,d){var F=h.constants.compareFuncs;m.optional(function(){function X(){h.assert(_,Array.prototype.join.call(arguments,""),"invalid stencil.func")}X(d+"&&typeof ",d,'==="object"'),X('!("cmp" in ',d,")||(",d,".cmp in ",F,")")});var N=_.def('"cmp" in ',d,"?",F,"[",d,".cmp]",":",ar),Y=_.def(d,".ref|0"),Q=_.def('"mask" in ',d,"?",d,".mask|0:-1");return[N,Y,Q]});case Ka:case Jr:return L(function(h){m.commandType(h,"object",E,f.commandStr);var _=h.fail||"keep",d=h.zfail||"keep",F=h.zpass||"keep";return m.commandParameter(_,ir,T+".fail",f.commandStr),m.commandParameter(d,ir,T+".zfail",f.commandStr),m.commandParameter(F,ir,T+".zpass",f.commandStr),[T===Jr?yr:dn,ir[_],ir[d],ir[F]]},function(h,_,d){var F=h.constants.stencilOps;m.optional(function(){h.assert(_,d+"&&typeof "+d+'==="object"',"invalid "+T)});function N(Y){return m.optional(function(){h.assert(_,'!("'+Y+'" in '+d+")||("+d+"."+Y+" in "+F+")","invalid "+T+"."+Y+", must be one of "+Object.keys(ir))}),_.def('"',Y,'" in ',d,"?",F,"[",d,".",Y,"]:",ar)}return[T===Jr?yr:dn,N("fail"),N("zfail"),N("zpass")]});case Xa:return L(function(h){m.commandType(h,"object",E,f.commandStr);var _=h.factor|0,d=h.units|0;return m.commandType(_,"number",E+".factor",f.commandStr),m.commandType(d,"number",E+".units",f.commandStr),[_,d]},function(h,_,d){m.optional(function(){h.assert(_,d+"&&typeof "+d+'==="object"',"invalid "+T)});var F=_.def(d,".factor|0"),N=_.def(d,".units|0");return[F,N]});case Mo:return L(function(h){var _=0;return h==="front"?_=dn:h==="back"&&(_=yr),m.command(!!_,E,f.commandStr),_},function(h,_,d){return m.optional(function(){h.assert(_,d+'==="front"||'+d+'==="back"',"invalid cull.face")}),_.def(d,'==="front"?',dn,":",yr)});case Ha:return L(function(h){return m.command(typeof h=="number"&&h>=z.lineWidthDims[0]&&h<=z.lineWidthDims[1],"invalid line width, must be a positive number between "+z.lineWidthDims[0]+" and "+z.lineWidthDims[1],f.commandStr),h},function(h,_,d){return m.optional(function(){h.assert(_,"typeof "+d+'==="number"&&'+d+">="+z.lineWidthDims[0]+"&&"+d+"<="+z.lineWidthDims[1],"invalid line width")}),d});case Va:return L(function(h){return m.commandParameter(h,ni,E,f.commandStr),ni[h]},function(h,_,d){return m.optional(function(){h.assert(_,d+'==="cw"||'+d+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),_.def(d+'==="cw"?'+Ho+":"+ri)});case qa:return L(function(h){return m.command(dt(h)&&h.length===4,"color.mask must be length 4 array",f.commandStr),h.map(function(_){return!!_})},function(h,_,d){return m.optional(function(){h.assert(_,h.shared.isArrayLike+"("+d+")&&"+d+".length===4","invalid color.mask")}),Gt(4,function(F){return"!!"+d+"["+F+"]"})});case Wa:return L(function(h){m.command(typeof h=="object"&&h,E,f.commandStr);var _="value"in h?h.value:1,d=!!h.invert;return m.command(typeof _=="number"&&_>=0&&_<=1,"sample.coverage.value must be a number between 0 and 1",f.commandStr),[_,d]},function(h,_,d){m.optional(function(){h.assert(_,d+"&&typeof "+d+'==="object"',"invalid sample.coverage")});var F=_.def('"value" in ',d,"?+",d,".value:1"),N=_.def("!!",d,".invert");return[F,N]})}}),I}function xt(l,f){var w=l.static,D=l.dynamic,I={};return Object.keys(w).forEach(function(T){var E=w[T],L;if(typeof E=="number"||typeof E=="boolean")L=mt(function(){return E});else if(typeof E=="function"){var h=E._reglType;h==="texture2d"||h==="textureCube"?L=mt(function(_){return _.link(E)}):h==="framebuffer"||h==="framebufferCube"?(m.command(E.color.length>0,'missing color attachment for framebuffer sent to uniform "'+T+'"',f.commandStr),L=mt(function(_){return _.link(E.color[0])})):m.commandRaise('invalid data for uniform "'+T+'"',f.commandStr)}else dt(E)?L=mt(function(_){var d=_.global.def("[",Gt(E.length,function(F){return m.command(typeof E[F]=="number"||typeof E[F]=="boolean","invalid uniform "+T,_.commandStr),E[F]}),"]");return d}):m.commandRaise('invalid or missing data for uniform "'+T+'"',f.commandStr);L.value=E,I[T]=L}),Object.keys(D).forEach(function(T){var E=D[T];I[T]=It(E,function(L,h){return L.invoke(h,E)})}),I}function Ye(l,f){var w=l.static,D=l.dynamic,I={};return Object.keys(w).forEach(function(T){var E=w[T],L=s.id(T),h=new M;if(Wn(E))h.state=Ir,h.buffer=K.getBuffer(K.create(E,Pr,!1,!0)),h.type=0;else{var _=K.getBuffer(E);if(_)h.state=Ir,h.buffer=_,h.type=0;else if(m.command(typeof E=="object"&&E,"invalid data for attribute "+T,f.commandStr),"constant"in E){var d=E.constant;h.buffer="null",h.state=Na,typeof d=="number"?h.x=d:(m.command(dt(d)&&d.length>0&&d.length<=4,"invalid constant for attribute "+T,f.commandStr),Gr.forEach(function(Re,ze){ze<d.length&&(h[Re]=d[ze])}))}else{Wn(E.buffer)?_=K.getBuffer(K.create(E.buffer,Pr,!1,!0)):_=K.getBuffer(E.buffer),m.command(!!_,'missing buffer for attribute "'+T+'"',f.commandStr);var F=E.offset|0;m.command(F>=0,'invalid offset for attribute "'+T+'"',f.commandStr);var N=E.stride|0;m.command(N>=0&&N<256,'invalid stride for attribute "'+T+'", must be integer betweeen [0, 255]',f.commandStr);var Y=E.size|0;m.command(!("size"in E)||Y>0&&Y<=4,'invalid size for attribute "'+T+'", must be 1,2,3,4',f.commandStr);var Q=!!E.normalized,X=0;"type"in E&&(m.commandParameter(E.type,sr,"invalid type for attribute "+T,f.commandStr),X=sr[E.type]);var fe=E.divisor|0;"divisor"in E&&(m.command(fe===0||se,'cannot specify divisor for attribute "'+T+'", instancing not supported',f.commandStr),m.command(fe>=0,'invalid divisor for attribute "'+T+'"',f.commandStr)),m.optional(function(){var Re=f.commandStr,ze=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(E).forEach(function(Te){m.command(ze.indexOf(Te)>=0,'unknown parameter "'+Te+'" for attribute pointer "'+T+'" (valid parameters are '+ze+")",Re)})}),h.buffer=_,h.state=Ir,h.size=Y,h.normalized=Q,h.type=X||_.dtype,h.offset=F,h.stride=N,h.divisor=fe}}I[T]=mt(function(Re,ze){var Te=Re.attribCache;if(L in Te)return Te[L];var De={isStream:!1};return Object.keys(h).forEach(function(Pe){De[Pe]=h[Pe]}),h.buffer&&(De.buffer=Re.link(h.buffer),De.type=De.type||De.buffer+".dtype"),Te[L]=De,De})}),Object.keys(D).forEach(function(T){var E=D[T];function L(h,_){var d=h.invoke(_,E),F=h.shared,N=h.constants,Y=F.isBufferArgs,Q=F.buffer;m.optional(function(){h.assert(_,d+"&&(typeof "+d+'==="object"||typeof '+d+'==="function")&&('+Y+"("+d+")||"+Q+".getBuffer("+d+")||"+Q+".getBuffer("+d+".buffer)||"+Y+"("+d+'.buffer)||("constant" in '+d+"&&(typeof "+d+'.constant==="number"||'+F.isArrayLike+"("+d+".constant))))",'invalid dynamic attribute "'+T+'"')});var X={isStream:_.def(!1)},fe=new M;fe.state=Ir,Object.keys(fe).forEach(function(De){X[De]=_.def(""+fe[De])});var Re=X.buffer,ze=X.type;_("if(",Y,"(",d,")){",X.isStream,"=true;",Re,"=",Q,".createStream(",Pr,",",d,");",ze,"=",Re,".dtype;","}else{",Re,"=",Q,".getBuffer(",d,");","if(",Re,"){",ze,"=",Re,".dtype;",'}else if("constant" in ',d,"){",X.state,"=",Na,";","if(typeof "+d+'.constant === "number"){',X[Gr[0]],"=",d,".constant;",Gr.slice(1).map(function(De){return X[De]}).join("="),"=0;","}else{",Gr.map(function(De,Pe){return X[De]+"="+d+".constant.length>"+Pe+"?"+d+".constant["+Pe+"]:0;"}).join(""),"}}else{","if(",Y,"(",d,".buffer)){",Re,"=",Q,".createStream(",Pr,",",d,".buffer);","}else{",Re,"=",Q,".getBuffer(",d,".buffer);","}",ze,'="type" in ',d,"?",N.glTypes,"[",d,".type]:",Re,".dtype;",X.normalized,"=!!",d,".normalized;");function Te(De){_(X[De],"=",d,".",De,"|0;")}return Te("size"),Te("offset"),Te("stride"),Te("divisor"),_("}}"),_.exit("if(",X.isStream,"){",Q,".destroyStream(",Re,");","}"),X}I[T]=It(E,L)}),I}function bt(l,f){var w=l.static,D=l.dynamic;if(nn in w){var I=w[nn];return I!==null&&de.getVAO(I)===null&&(I=de.createVAO(I)),mt(function(E){return E.link(de.getVAO(I))})}else if(nn in D){var T=D[nn];return It(T,function(E,L){var h=E.invoke(L,T);return L.def(E.shared.vao+".getVAO("+h+")")})}return null}function it(l){var f=l.static,w=l.dynamic,D={};return Object.keys(f).forEach(function(I){var T=f[I];D[I]=mt(function(E,L){return typeof T=="number"||typeof T=="boolean"?""+T:E.link(T)})}),Object.keys(w).forEach(function(I){var T=w[I];D[I]=It(T,function(E,L){return E.invoke(L,T)})}),D}function vt(l,f,w,D,I){var T=l.static,E=l.dynamic;m.optional(function(){var Te=[mr,tn,rn,pr,vr,Nn,br,Bn,en,nn].concat(te);function De(Pe){Object.keys(Pe).forEach(function(Ze){m.command(Te.indexOf(Ze)>=0,'unknown parameter "'+Ze+'"',I.commandStr)})}De(T),De(E)});var L=Be(l,f),h=Ae(l),_=He(l,h,I),d=Qe(l,I),F=pt(l,I),N=qe(l,I,L);function Y(Te){var De=_[Te];De&&(F[Te]=De)}Y(er),Y(ve(In));var Q=Object.keys(F).length>0,X={framebuffer:h,draw:d,shader:N,state:F,dirty:Q,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(X.profile=$e(l),X.uniforms=xt(w,I),X.drawVAO=X.scopeVAO=bt(l),!X.drawVAO&&N.program&&!L&&y.angle_instanced_arrays){var fe=!0,Re=N.program.attributes.map(function(Te){var De=f.static[Te];return fe=fe&&!!De,De});if(fe&&Re.length>0){var ze=de.getVAO(de.createVAO(Re));X.drawVAO=new Dt(null,null,null,function(Te,De){return Te.link(ze)}),X.useVAO=!0}}return L?X.useVAO=!0:X.attributes=Ye(f,I),X.context=it(D),X}function yt(l,f,w){var D=l.shared,I=D.context,T=l.scope();Object.keys(w).forEach(function(E){f.save(I,"."+E);var L=w[E],h=L.append(l,f);Array.isArray(h)?T(I,".",E,"=[",h.join(),"];"):T(I,".",E,"=",h,";")}),f(T)}function gt(l,f,w,D){var I=l.shared,T=I.gl,E=I.framebuffer,L;ge&&(L=f.def(I.extensions,".webgl_draw_buffers"));var h=l.constants,_=h.drawBuffer,d=h.backBuffer,F;w?F=w.append(l,f):F=f.def(E,".next"),D||f("if(",F,"!==",E,".cur){"),f("if(",F,"){",T,".bindFramebuffer(",Ko,",",F,".framebuffer);"),ge&&f(L,".drawBuffersWEBGL(",_,"[",F,".colorAttachments.length]);"),f("}else{",T,".bindFramebuffer(",Ko,",null);"),ge&&f(L,".drawBuffersWEBGL(",d,");"),f("}",E,".cur=",F,";"),D||f("}")}function Et(l,f,w){var D=l.shared,I=D.gl,T=l.current,E=l.next,L=D.current,h=D.next,_=l.cond(L,".dirty");te.forEach(function(d){var F=ve(d);if(!(F in w.state)){var N,Y;if(F in E){N=E[F],Y=T[F];var Q=Gt(J[F].length,function(fe){return _.def(N,"[",fe,"]")});_(l.cond(Q.map(function(fe,Re){return fe+"!=="+Y+"["+Re+"]"}).join("||")).then(I,".",ee[F],"(",Q,");",Q.map(function(fe,Re){return Y+"["+Re+"]="+fe}).join(";"),";"))}else{N=_.def(h,".",F);var X=l.cond(N,"!==",L,".",F);_(X),F in pe?X(l.cond(N).then(I,".enable(",pe[F],");").else(I,".disable(",pe[F],");"),L,".",F,"=",N,";"):X(I,".",ee[F],"(",N,");",L,".",F,"=",N,";")}}}),Object.keys(w.state).length===0&&_(L,".dirty=false;"),f(_)}function Tt(l,f,w,D){var I=l.shared,T=l.current,E=I.current,L=I.gl;Jo(Object.keys(w)).forEach(function(h){var _=w[h];if(!(D&&!D(_))){var d=_.append(l,f);if(pe[h]){var F=pe[h];ur(_)?d?f(L,".enable(",F,");"):f(L,".disable(",F,");"):f(l.cond(d).then(L,".enable(",F,");").else(L,".disable(",F,");")),f(E,".",h,"=",d,";")}else if(dt(d)){var N=T[h];f(L,".",ee[h],"(",d,");",d.map(function(Y,Q){return N+"["+Q+"]="+Y}).join(";"),";")}else f(L,".",ee[h],"(",d,");",E,".",h,"=",d,";")}})}function ct(l,f){se&&(l.instancing=f.def(l.shared.extensions,".angle_instanced_arrays"))}function je(l,f,w,D,I){var T=l.shared,E=l.stats,L=T.current,h=T.timer,_=w.profile;function d(){return typeof performance>"u"?"Date.now()":"performance.now()"}var F,N;function Y(Te){F=f.def(),Te(F,"=",d(),";"),typeof I=="string"?Te(E,".count+=",I,";"):Te(E,".count++;"),ie&&(D?(N=f.def(),Te(N,"=",h,".getNumPendingQueries();")):Te(h,".beginQuery(",E,");"))}function Q(Te){Te(E,".cpuTime+=",d(),"-",F,";"),ie&&(D?Te(h,".pushScopeStats(",N,",",h,".getNumPendingQueries(),",E,");"):Te(h,".endQuery();"))}function X(Te){var De=f.def(L,".profile");f(L,".profile=",Te,";"),f.exit(L,".profile=",De,";")}var fe;if(_){if(ur(_)){_.enable?(Y(f),Q(f.exit),X("true")):X("false");return}fe=_.append(l,f),X(fe)}else fe=f.def(L,".profile");var Re=l.block();Y(Re),f("if(",fe,"){",Re,"}");var ze=l.block();Q(ze),f.exit("if(",fe,"){",ze,"}")}function St(l,f,w,D,I){var T=l.shared;function E(h){switch(h){case Pn:case zn:case Vn:return 2;case $n:case Un:case Hn:return 3;case jn:case qn:case Xn:return 4;default:return 1}}function L(h,_,d){var F=T.gl,N=f.def(h,".location"),Y=f.def(T.attributes,"[",N,"]"),Q=d.state,X=d.buffer,fe=[d.x,d.y,d.z,d.w],Re=["buffer","normalized","offset","stride"];function ze(){f("if(!",Y,".buffer){",F,".enableVertexAttribArray(",N,");}");var De=d.type,Pe;if(d.size?Pe=f.def(d.size,"||",_):Pe=_,f("if(",Y,".type!==",De,"||",Y,".size!==",Pe,"||",Re.map(function(st){return Y+"."+st+"!=="+d[st]}).join("||"),"){",F,".bindBuffer(",Pr,",",X,".buffer);",F,".vertexAttribPointer(",[N,Pe,De,d.normalized,d.stride,d.offset],");",Y,".type=",De,";",Y,".size=",Pe,";",Re.map(function(st){return Y+"."+st+"="+d[st]+";"}).join(""),"}"),se){var Ze=d.divisor;f("if(",Y,".divisor!==",Ze,"){",l.instancing,".vertexAttribDivisorANGLE(",[N,Ze],");",Y,".divisor=",Ze,";}")}}function Te(){f("if(",Y,".buffer){",F,".disableVertexAttribArray(",N,");",Y,".buffer=null;","}if(",Gr.map(function(De,Pe){return Y+"."+De+"!=="+fe[Pe]}).join("||"),"){",F,".vertexAttrib4f(",N,",",fe,");",Gr.map(function(De,Pe){return Y+"."+De+"="+fe[Pe]+";"}).join(""),"}")}Q===Ir?ze():Q===Na?Te():(f("if(",Q,"===",Ir,"){"),ze(),f("}else{"),Te(),f("}"))}D.forEach(function(h){var _=h.name,d=w.attributes[_],F;if(d){if(!I(d))return;F=d.append(l,f)}else{if(!I(ef))return;var N=l.scopeAttrib(_);m.optional(function(){l.assert(f,N+".state","missing attribute "+_)}),F={},Object.keys(new M).forEach(function(Y){F[Y]=f.def(N,".",Y)})}L(l.link(h),E(h.info.type),F)})}function et(l,f,w,D,I){for(var T=l.shared,E=T.gl,L,h=0;h<D.length;++h){var _=D[h],d=_.name,F=_.info.type,N=w.uniforms[d],Y=l.link(_),Q=Y+".location",X;if(N){if(!I(N))continue;if(ur(N)){var fe=N.value;if(m.command(fe!==null&&typeof fe<"u",'missing uniform "'+d+'"',l.commandStr),F===fn||F===sn){m.command(typeof fe=="function"&&(F===fn&&(fe._reglType==="texture2d"||fe._reglType==="framebuffer")||F===sn&&(fe._reglType==="textureCube"||fe._reglType==="framebufferCube")),"invalid texture for uniform "+d,l.commandStr);var Re=l.link(fe._texture||fe.color[0]._texture);f(E,".uniform1i(",Q,",",Re+".bind());"),f.exit(Re,".unbind();")}else if(F===an||F===un||F===on){m.optional(function(){m.command(dt(fe),"invalid matrix for uniform "+d,l.commandStr),m.command(F===an&&fe.length===4||F===un&&fe.length===9||F===on&&fe.length===16,"invalid length for matrix uniform "+d,l.commandStr)});var ze=l.global.def("new Float32Array(["+Array.prototype.slice.call(fe)+"])"),Te=2;F===un?Te=3:F===on&&(Te=4),f(E,".uniformMatrix",Te,"fv(",Q,",false,",ze,");")}else{switch(F){case Ja:m.commandType(fe,"number","uniform "+d,l.commandStr),L="1f";break;case Pn:m.command(dt(fe)&&fe.length===2,"uniform "+d,l.commandStr),L="2f";break;case $n:m.command(dt(fe)&&fe.length===3,"uniform "+d,l.commandStr),L="3f";break;case jn:m.command(dt(fe)&&fe.length===4,"uniform "+d,l.commandStr),L="4f";break;case ti:m.commandType(fe,"boolean","uniform "+d,l.commandStr),L="1i";break;case ei:m.commandType(fe,"number","uniform "+d,l.commandStr),L="1i";break;case Vn:m.command(dt(fe)&&fe.length===2,"uniform "+d,l.commandStr),L="2i";break;case zn:m.command(dt(fe)&&fe.length===2,"uniform "+d,l.commandStr),L="2i";break;case Hn:m.command(dt(fe)&&fe.length===3,"uniform "+d,l.commandStr),L="3i";break;case Un:m.command(dt(fe)&&fe.length===3,"uniform "+d,l.commandStr),L="3i";break;case Xn:m.command(dt(fe)&&fe.length===4,"uniform "+d,l.commandStr),L="4i";break;case qn:m.command(dt(fe)&&fe.length===4,"uniform "+d,l.commandStr),L="4i";break}f(E,".uniform",L,"(",Q,",",dt(fe)?Array.prototype.slice.call(fe):fe,");")}continue}else X=N.append(l,f)}else{if(!I(ef))continue;X=f.def(T.uniforms,"[",s.id(d),"]")}F===fn?(m(!Array.isArray(X),"must specify a scalar prop for textures"),f("if(",X,"&&",X,'._reglType==="framebuffer"){',X,"=",X,".color[0];","}")):F===sn&&(m(!Array.isArray(X),"must specify a scalar prop for cube maps"),f("if(",X,"&&",X,'._reglType==="framebufferCube"){',X,"=",X,".color[0];","}")),m.optional(function(){function kt(Xt,ff){l.assert(f,Xt,'bad data or missing for uniform "'+d+'".  '+ff)}function ai(Xt){m(!Array.isArray(X),"must not specify an array type for uniform"),kt("typeof "+X+'==="'+Xt+'"',"invalid type, expected "+Xt)}function Ut(Xt,ff){Array.isArray(X)?m(X.length===Xt,"must have length "+Xt):kt(T.isArrayLike+"("+X+")&&"+X+".length==="+Xt,"invalid vector, should have length "+Xt,l.commandStr)}function of(Xt){m(!Array.isArray(X),"must not specify a value type"),kt("typeof "+X+'==="function"&&'+X+'._reglType==="texture'+(Xt===qo?"2d":"Cube")+'"',"invalid texture type",l.commandStr)}switch(F){case ei:ai("number");break;case zn:Ut(2);break;case Un:Ut(3);break;case qn:Ut(4);break;case Ja:ai("number");break;case Pn:Ut(2);break;case $n:Ut(3);break;case jn:Ut(4);break;case ti:ai("boolean");break;case Vn:Ut(2);break;case Hn:Ut(3);break;case Xn:Ut(4);break;case an:Ut(4);break;case un:Ut(9);break;case on:Ut(16);break;case fn:of(qo);break;case sn:of(_l);break}});var De=1;switch(F){case fn:case sn:var Pe=f.def(X,"._texture");f(E,".uniform1i(",Q,",",Pe,".bind());"),f.exit(Pe,".unbind();");continue;case ei:case ti:L="1i";break;case zn:case Vn:L="2i",De=2;break;case Un:case Hn:L="3i",De=3;break;case qn:case Xn:L="4i",De=4;break;case Ja:L="1f";break;case Pn:L="2f",De=2;break;case $n:L="3f",De=3;break;case jn:L="4f",De=4;break;case an:L="Matrix2fv";break;case un:L="Matrix3fv";break;case on:L="Matrix4fv";break}if(f(E,".uniform",L,"(",Q,","),L.charAt(0)==="M"){var Ze=Math.pow(F-an+2,2),st=l.global.def("new Float32Array(",Ze,")");Array.isArray(X)?f("false,(",Gt(Ze,function(kt){return st+"["+kt+"]="+X[kt]}),",",st,")"):f("false,(Array.isArray(",X,")||",X," instanceof Float32Array)?",X,":(",Gt(Ze,function(kt){return st+"["+kt+"]="+X+"["+kt+"]"}),",",st,")")}else De>1?f(Gt(De,function(kt){return Array.isArray(X)?X[kt]:X+"["+kt+"]"})):(m(!Array.isArray(X),"uniform value must not be an array"),f(X));f(");")}}function Fe(l,f,w,D){var I=l.shared,T=I.gl,E=I.draw,L=D.draw;function h(){var Pe=L.elements,Ze,st=f;return Pe?((Pe.contextDep&&D.contextDynamic||Pe.propDep)&&(st=w),Ze=Pe.append(l,st)):Ze=st.def(E,".",pr),Ze&&st("if("+Ze+")"+T+".bindBuffer("+bl+","+Ze+".buffer.buffer);"),Ze}function _(){var Pe=L.count,Ze,st=f;return Pe?((Pe.contextDep&&D.contextDynamic||Pe.propDep)&&(st=w),Ze=Pe.append(l,st),m.optional(function(){Pe.MISSING&&l.assert(f,"false","missing vertex count"),Pe.DYNAMIC&&l.assert(st,Ze+">=0","missing vertex count")})):(Ze=st.def(E,".",br),m.optional(function(){l.assert(st,Ze+">=0","missing vertex count")})),Ze}var d=h();function F(Pe){var Ze=L[Pe];return Ze?Ze.contextDep&&D.contextDynamic||Ze.propDep?Ze.append(l,w):Ze.append(l,f):f.def(E,".",Pe)}var N=F(vr),Y=F(Nn),Q=_();if(typeof Q=="number"){if(Q===0)return}else w("if(",Q,"){"),w.exit("}");var X,fe;se&&(X=F(Bn),fe=l.instancing);var Re=d+".type",ze=L.elements&&ur(L.elements);function Te(){function Pe(){w(fe,".drawElementsInstancedANGLE(",[N,Q,Re,Y+"<<(("+Re+"-"+Eo+")>>1)",X],");")}function Ze(){w(fe,".drawArraysInstancedANGLE(",[N,Y,Q,X],");")}d?ze?Pe():(w("if(",d,"){"),Pe(),w("}else{"),Ze(),w("}")):Ze()}function De(){function Pe(){w(T+".drawElements("+[N,Q,Re,Y+"<<(("+Re+"-"+Eo+")>>1)"]+");")}function Ze(){w(T+".drawArrays("+[N,Y,Q]+");")}d?ze?Pe():(w("if(",d,"){"),Pe(),w("}else{"),Ze(),w("}")):Ze()}se&&(typeof X!="number"||X>=0)?typeof X=="string"?(w("if(",X,">0){"),Te(),w("}else if(",X,"<0){"),De(),w("}")):Te():De()}function We(l,f,w,D,I){var T=ke(),E=T.proc("body",I);return m.optional(function(){T.commandStr=f.commandStr,T.command=T.link(f.commandStr)}),se&&(T.instancing=E.def(T.shared.extensions,".angle_instanced_arrays")),l(T,E,w,D),T.compile().body}function Ke(l,f,w,D){ct(l,f),w.useVAO?w.drawVAO?f(l.shared.vao,".setVAO(",w.drawVAO.append(l,f),");"):f(l.shared.vao,".setVAO(",l.shared.vao,".targetVAO);"):(f(l.shared.vao,".setVAO(null);"),St(l,f,w,D.attributes,function(){return!0})),et(l,f,w,D.uniforms,function(){return!0}),Fe(l,f,f,w)}function lt(l,f){var w=l.proc("draw",1);ct(l,w),yt(l,w,f.context),gt(l,w,f.framebuffer),Et(l,w,f),Tt(l,w,f.state),je(l,w,f,!1,!0);var D=f.shader.progVar.append(l,w);if(w(l.shared.gl,".useProgram(",D,".program);"),f.shader.program)Ke(l,w,f,f.shader.program);else{w(l.shared.vao,".setVAO(null);");var I=l.global.def("{}"),T=w.def(D,".id"),E=w.def(I,"[",T,"]");w(l.cond(E).then(E,".call(this,a0);").else(E,"=",I,"[",T,"]=",l.link(function(L){return We(Ke,l,f,L,1)}),"(",D,");",E,".call(this,a0);"))}Object.keys(f.state).length>0&&w(l.shared.current,".dirty=true;")}function Kt(l,f,w,D){l.batchId="a1",ct(l,f);function I(){return!0}St(l,f,w,D.attributes,I),et(l,f,w,D.uniforms,I),Fe(l,f,f,w)}function gr(l,f,w,D){ct(l,f);var I=w.contextDep,T=f.def(),E="a0",L="a1",h=f.def();l.shared.props=h,l.batchId=T;var _=l.scope(),d=l.scope();f(_.entry,"for(",T,"=0;",T,"<",L,";++",T,"){",h,"=",E,"[",T,"];",d,"}",_.exit);function F(Re){return Re.contextDep&&I||Re.propDep}function N(Re){return!F(Re)}if(w.needsContext&&yt(l,d,w.context),w.needsFramebuffer&&gt(l,d,w.framebuffer),Tt(l,d,w.state,F),w.profile&&F(w.profile)&&je(l,d,w,!1,!0),D)w.useVAO?w.drawVAO?F(w.drawVAO)?d(l.shared.vao,".setVAO(",w.drawVAO.append(l,d),");"):_(l.shared.vao,".setVAO(",w.drawVAO.append(l,_),");"):_(l.shared.vao,".setVAO(",l.shared.vao,".targetVAO);"):(_(l.shared.vao,".setVAO(null);"),St(l,_,w,D.attributes,N),St(l,d,w,D.attributes,F)),et(l,_,w,D.uniforms,N),et(l,d,w,D.uniforms,F),Fe(l,_,d,w);else{var Y=l.global.def("{}"),Q=w.shader.progVar.append(l,d),X=d.def(Q,".id"),fe=d.def(Y,"[",X,"]");d(l.shared.gl,".useProgram(",Q,".program);","if(!",fe,"){",fe,"=",Y,"[",X,"]=",l.link(function(Re){return We(Kt,l,w,Re,2)}),"(",Q,");}",fe,".call(this,a0[",T,"],",T,");")}}function v(l,f){var w=l.proc("batch",2);l.batchId="0",ct(l,w);var D=!1,I=!0;Object.keys(f.context).forEach(function(Y){D=D||f.context[Y].propDep}),D||(yt(l,w,f.context),I=!1);var T=f.framebuffer,E=!1;T?(T.propDep?D=E=!0:T.contextDep&&D&&(E=!0),E||gt(l,w,T)):gt(l,w,null),f.state.viewport&&f.state.viewport.propDep&&(D=!0);function L(Y){return Y.contextDep&&D||Y.propDep}Et(l,w,f),Tt(l,w,f.state,function(Y){return!L(Y)}),(!f.profile||!L(f.profile))&&je(l,w,f,!1,"a1"),f.contextDep=D,f.needsContext=I,f.needsFramebuffer=E;var h=f.shader.progVar;if(h.contextDep&&D||h.propDep)gr(l,w,f,null);else{var _=h.append(l,w);if(w(l.shared.gl,".useProgram(",_,".program);"),f.shader.program)gr(l,w,f,f.shader.program);else{w(l.shared.vao,".setVAO(null);");var d=l.global.def("{}"),F=w.def(_,".id"),N=w.def(d,"[",F,"]");w(l.cond(N).then(N,".call(this,a0,a1);").else(N,"=",d,"[",F,"]=",l.link(function(Y){return We(gr,l,f,Y,2)}),"(",_,");",N,".call(this,a0,a1);"))}}Object.keys(f.state).length>0&&w(l.shared.current,".dirty=true;")}function U(l,f){var w=l.proc("scope",3);l.batchId="a2";var D=l.shared,I=D.current;yt(l,w,f.context),f.framebuffer&&f.framebuffer.append(l,w),Jo(Object.keys(f.state)).forEach(function(E){var L=f.state[E],h=L.append(l,w);dt(h)?h.forEach(function(_,d){w.set(l.next[E],"["+d+"]",_)}):w.set(D.next,"."+E,h)}),je(l,w,f,!0,!0),[pr,Nn,br,Bn,vr].forEach(function(E){var L=f.draw[E];L&&w.set(D.draw,"."+E,""+L.append(l,w))}),Object.keys(f.uniforms).forEach(function(E){var L=f.uniforms[E].append(l,w);Array.isArray(L)&&(L="["+L.join()+"]"),w.set(D.uniforms,"["+s.id(E)+"]",L)}),Object.keys(f.attributes).forEach(function(E){var L=f.attributes[E].append(l,w),h=l.scopeAttrib(E);Object.keys(new M).forEach(function(_){w.set(h,"."+_,L[_])})}),f.scopeVAO&&w.set(D.vao,".targetVAO",f.scopeVAO.append(l,w));function T(E){var L=f.shader[E];L&&w.set(D.shader,"."+E,L.append(l,w))}T(tn),T(rn),Object.keys(f.state).length>0&&(w(I,".dirty=true;"),w.exit(I,".dirty=true;")),w("a1(",l.shared.context,",a0,",l.batchId,");")}function B(l){if(!(typeof l!="object"||dt(l))){for(var f=Object.keys(l),w=0;w<f.length;++w)if(Pt.isDynamic(l[f[w]]))return!0;return!1}}function we(l,f,w){var D=f.static[w];if(!D||!B(D))return;var I=l.global,T=Object.keys(D),E=!1,L=!1,h=!1,_=l.global.def("{}");T.forEach(function(F){var N=D[F];if(Pt.isDynamic(N)){typeof N=="function"&&(N=D[F]=Pt.unbox(N));var Y=It(N,null);E=E||Y.thisDep,h=h||Y.propDep,L=L||Y.contextDep}else{switch(I(_,".",F,"="),typeof N){case"number":I(N);break;case"string":I('"',N,'"');break;case"object":Array.isArray(N)&&I("[",N.join(),"]");break;default:I(l.link(N));break}I(";")}});function d(F,N){T.forEach(function(Y){var Q=D[Y];if(Pt.isDynamic(Q)){var X=F.invoke(N,Q);N(_,".",Y,"=",X,";")}})}f.dynamic[w]=new Pt.DynamicVariable(Gn,{thisDep:E,contextDep:L,propDep:h,ref:_,append:d}),delete f.static[w]}function Xe(l,f,w,D,I){var T=ke();T.stats=T.link(I),Object.keys(f.static).forEach(function(L){we(T,f,L)}),vl.forEach(function(L){we(T,l,L)});var E=vt(l,f,w,D,T);return lt(T,E),U(T,E),v(T,E),i(T.compile(),{destroy:function(){E.shader.program.destroy()}})}return{next:xe,current:J,procs:function(){var l=ke(),f=l.proc("poll"),w=l.proc("refresh"),D=l.block();f(D),w(D);var I=l.shared,T=I.gl,E=I.next,L=I.current;D(L,".dirty=false;"),gt(l,f),gt(l,w,null,!0);var h;se&&(h=l.link(se)),y.oes_vertex_array_object&&w(l.link(y.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var _=0;_<z.maxAttributes;++_){var d=w.def(I.attributes,"[",_,"]"),F=l.cond(d,".buffer");F.then(T,".enableVertexAttribArray(",_,");",T,".bindBuffer(",Pr,",",d,".buffer.buffer);",T,".vertexAttribPointer(",_,",",d,".size,",d,".type,",d,".normalized,",d,".stride,",d,".offset);").else(T,".disableVertexAttribArray(",_,");",T,".vertexAttrib4f(",_,",",d,".x,",d,".y,",d,".z,",d,".w);",d,".buffer=null;"),w(F),se&&w(h,".vertexAttribDivisorANGLE(",_,",",d,".divisor);")}return w(l.shared.vao,".currentVAO=null;",l.shared.vao,".setVAO(",l.shared.vao,".targetVAO);"),Object.keys(pe).forEach(function(N){var Y=pe[N],Q=D.def(E,".",N),X=l.block();X("if(",Q,"){",T,".enable(",Y,")}else{",T,".disable(",Y,")}",L,".",N,"=",Q,";"),w(X),f("if(",Q,"!==",L,".",N,"){",X,"}")}),Object.keys(ee).forEach(function(N){var Y=ee[N],Q=J[N],X,fe,Re=l.block();if(Re(T,".",Y,"("),dt(Q)){var ze=Q.length;X=l.global.def(E,".",N),fe=l.global.def(L,".",N),Re(Gt(ze,function(Te){return X+"["+Te+"]"}),");",Gt(ze,function(Te){return fe+"["+Te+"]="+X+"["+Te+"];"}).join("")),f("if(",Gt(ze,function(Te){return X+"["+Te+"]!=="+fe+"["+Te+"]"}).join("||"),"){",Re,"}")}else X=D.def(E,".",N),fe=D.def(L,".",N),Re(X,");",L,".",N,"=",X,";"),f("if(",X,"!==",fe,"){",Re,"}");w(Re)}),l.compile()}(),compile:Xe}}function Il(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Nl=34918,Bl=34919,tf=35007,Pl=function(r,s){if(!s.ext_disjoint_timer_query)return null;var y=[];function z(){return y.pop()||s.ext_disjoint_timer_query.createQueryEXT()}function K(se){y.push(se)}var j=[];function V(se){var ge=z();s.ext_disjoint_timer_query.beginQueryEXT(tf,ge),j.push(ge),ie(j.length-1,j.length,se)}function ae(){s.ext_disjoint_timer_query.endQueryEXT(tf)}function ue(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var de=[];function oe(){return de.pop()||new ue}function le(se){de.push(se)}var be=[];function ie(se,ge,J){var xe=oe();xe.startQueryIndex=se,xe.endQueryIndex=ge,xe.sum=0,xe.stats=J,be.push(xe)}var he=[],M=[];function H(){var se,ge,J=j.length;if(J!==0){M.length=Math.max(M.length,J+1),he.length=Math.max(he.length,J+1),he[0]=0,M[0]=0;var xe=0;for(se=0,ge=0;ge<j.length;++ge){var te=j[ge];s.ext_disjoint_timer_query.getQueryObjectEXT(te,Bl)?(xe+=s.ext_disjoint_timer_query.getQueryObjectEXT(te,Nl),K(te)):j[se++]=te,he[ge+1]=xe,M[ge+1]=se}for(j.length=se,se=0,ge=0;ge<be.length;++ge){var pe=be[ge],ee=pe.startQueryIndex,ve=pe.endQueryIndex;pe.sum+=he[ve]-he[ee];var Ce=M[ee],Ne=M[ve];Ne===Ce?(pe.stats.gpuTime+=pe.sum/1e6,le(pe)):(pe.startQueryIndex=Ce,pe.endQueryIndex=Ne,be[se++]=pe)}be.length=se}}return{beginQuery:V,endQuery:ae,pushScopeStats:ie,update:H,getNumPendingQueries:function(){return j.length},clear:function(){y.push.apply(y,j);for(var se=0;se<y.length;se++)s.ext_disjoint_timer_query.deleteQueryEXT(y[se]);j.length=0,y.length=0},restore:function(){j.length=0,y.length=0}}},$l=16384,jl=256,zl=1024,Ul=34962,rf="webglcontextlost",nf="webglcontextrestored",af=1,ql=2,Vl=3;function uf(r,s){for(var y=0;y<r.length;++y)if(r[y]===s)return y;return-1}function Hl(r){var s=Us(r);if(!s)return null;var y=s.gl,z=y.getContextAttributes(),K=y.isContextLost(),j=qs(y,s);if(!j)return null;var V=Bs(),ae=Il(),ue=j.extensions,de=Pl(y,ue),oe=lu(),le=y.drawingBufferWidth,be=y.drawingBufferHeight,ie={tick:0,time:0,viewportWidth:le,viewportHeight:be,framebufferWidth:le,framebufferHeight:be,drawingBufferWidth:le,drawingBufferHeight:be,pixelRatio:s.pixelRatio},he={},M={elements:null,primitive:4,count:-1,offset:0,instances:-1},H=Fd(y,ue),se=Xd(y,ae,s,J),ge=il(y,ue,H,ae,se);function J(Fe){return ge.destroyBuffer(Fe)}var xe=ic(y,ue,se,ae),te=sl(y,V,ae,s),pe=Ic(y,ue,H,function(){Ce.procs.poll()},ie,ae,s),ee=Nc(y,ue,H,ae,s),ve=nl(y,ue,H,pe,ee,ae),Ce=Gl(y,V,ue,H,se,xe,pe,ve,he,ge,te,M,ie,de,s),Ne=ll(y,ve,Ce.procs.poll,ie,z,ue,H),ye=Ce.next,ce=y.canvas,Z=[],ke=[],$e=[],Ae=[s.onDestroy],He=null;function Be(){if(Z.length===0){de&&de.update(),He=null;return}He=sa.next(Be),Tt();for(var Fe=Z.length-1;Fe>=0;--Fe){var We=Z[Fe];We&&We(ie,null,0)}y.flush(),de&&de.update()}function qe(){!He&&Z.length>0&&(He=sa.next(Be))}function Qe(){He&&(sa.cancel(Be),He=null)}function pt(Fe){Fe.preventDefault(),K=!0,Qe(),ke.forEach(function(We){We()})}function xt(Fe){y.getError(),K=!1,j.restore(),te.restore(),se.restore(),pe.restore(),ee.restore(),ve.restore(),ge.restore(),de&&de.restore(),Ce.procs.refresh(),qe(),$e.forEach(function(We){We()})}ce&&(ce.addEventListener(rf,pt,!1),ce.addEventListener(nf,xt,!1));function Ye(){Z.length=0,Qe(),ce&&(ce.removeEventListener(rf,pt),ce.removeEventListener(nf,xt)),te.clear(),ve.clear(),ee.clear(),pe.clear(),xe.clear(),se.clear(),ge.clear(),de&&de.clear(),Ae.forEach(function(Fe){Fe()})}function bt(Fe){m(!!Fe,"invalid args to regl({...})"),m.type(Fe,"object","invalid args to regl({...})");function We(I){var T=i({},I);delete T.uniforms,delete T.attributes,delete T.context,delete T.vao,"stencil"in T&&T.stencil.op&&(T.stencil.opBack=T.stencil.opFront=T.stencil.op,delete T.stencil.op);function E(L){if(L in T){var h=T[L];delete T[L],Object.keys(h).forEach(function(_){T[L+"."+_]=h[_]})}}return E("blend"),E("depth"),E("cull"),E("stencil"),E("polygonOffset"),E("scissor"),E("sample"),"vao"in I&&(T.vao=I.vao),T}function Ke(I,T){var E={},L={};return Object.keys(I).forEach(function(h){var _=I[h];if(Pt.isDynamic(_)){L[h]=Pt.unbox(_,h);return}else if(T&&Array.isArray(_)){for(var d=0;d<_.length;++d)if(Pt.isDynamic(_[d])){L[h]=Pt.unbox(_,h);return}}E[h]=_}),{dynamic:L,static:E}}var lt=Ke(Fe.context||{},!0),Kt=Ke(Fe.uniforms||{},!0),gr=Ke(Fe.attributes||{},!1),v=Ke(We(Fe),!1),U={gpuTime:0,cpuTime:0,count:0},B=Ce.compile(v,gr,Kt,lt,U),we=B.draw,Xe=B.batch,l=B.scope,f=[];function w(I){for(;f.length<I;)f.push(null);return f}function D(I,T){var E;if(K&&m.raise("context lost"),typeof I=="function")return l.call(this,null,I,0);if(typeof T=="function")if(typeof I=="number")for(E=0;E<I;++E)l.call(this,null,T,E);else if(Array.isArray(I))for(E=0;E<I.length;++E)l.call(this,I[E],T,E);else return l.call(this,I,T,0);else if(typeof I=="number"){if(I>0)return Xe.call(this,w(I|0),I|0)}else if(Array.isArray(I)){if(I.length)return Xe.call(this,I,I.length)}else return we.call(this,I)}return i(D,{stats:U,destroy:function(){B.destroy()}})}var it=ve.setFBO=bt({framebuffer:Pt.define.call(null,af,"framebuffer")});function vt(Fe,We){var Ke=0;Ce.procs.poll();var lt=We.color;lt&&(y.clearColor(+lt[0]||0,+lt[1]||0,+lt[2]||0,+lt[3]||0),Ke|=$l),"depth"in We&&(y.clearDepth(+We.depth),Ke|=jl),"stencil"in We&&(y.clearStencil(We.stencil|0),Ke|=zl),m(!!Ke,"called regl.clear with no buffer specified"),y.clear(Ke)}function yt(Fe){if(m(typeof Fe=="object"&&Fe,"regl.clear() takes an object as input"),"framebuffer"in Fe)if(Fe.framebuffer&&Fe.framebuffer_reglType==="framebufferCube")for(var We=0;We<6;++We)it(i({framebuffer:Fe.framebuffer.faces[We]},Fe),vt);else it(Fe,vt);else vt(null,Fe)}function gt(Fe){m.type(Fe,"function","regl.frame() callback must be a function"),Z.push(Fe);function We(){var Ke=uf(Z,Fe);m(Ke>=0,"cannot cancel a frame twice");function lt(){var Kt=uf(Z,lt);Z[Kt]=Z[Z.length-1],Z.length-=1,Z.length<=0&&Qe()}Z[Ke]=lt}return qe(),{cancel:We}}function Et(){var Fe=ye.viewport,We=ye.scissor_box;Fe[0]=Fe[1]=We[0]=We[1]=0,ie.viewportWidth=ie.framebufferWidth=ie.drawingBufferWidth=Fe[2]=We[2]=y.drawingBufferWidth,ie.viewportHeight=ie.framebufferHeight=ie.drawingBufferHeight=Fe[3]=We[3]=y.drawingBufferHeight}function Tt(){ie.tick+=1,ie.time=je(),Et(),Ce.procs.poll()}function ct(){pe.refresh(),Et(),Ce.procs.refresh(),de&&de.update()}function je(){return(lu()-oe)/1e3}ct();function St(Fe,We){m.type(We,"function","listener callback must be a function");var Ke;switch(Fe){case"frame":return gt(We);case"lost":Ke=ke;break;case"restore":Ke=$e;break;case"destroy":Ke=Ae;break;default:m.raise("invalid event, must be one of frame,lost,restore,destroy")}return Ke.push(We),{cancel:function(){for(var lt=0;lt<Ke.length;++lt)if(Ke[lt]===We){Ke[lt]=Ke[Ke.length-1],Ke.pop();return}}}}var et=i(bt,{clear:yt,prop:Pt.define.bind(null,af),context:Pt.define.bind(null,ql),this:Pt.define.bind(null,Vl),draw:bt({}),buffer:function(Fe){return se.create(Fe,Ul,!1,!1)},elements:function(Fe){return xe.create(Fe,!1)},texture:pe.create2D,cube:pe.createCube,renderbuffer:ee.create,framebuffer:ve.create,framebufferCube:ve.createCube,vao:ge.createVAO,attributes:z,frame:gt,on:St,limits:H,hasExtension:function(Fe){return H.extensions.indexOf(Fe.toLowerCase())>=0},read:Ne,destroy:Ye,_gl:y,_refresh:ct,poll:function(){Tt(),de&&de.update()},now:je,stats:ae});return s.onDone(null,et),et}return Hl})}(ta)),ta.exports}var sp=fp();const dp=wr(sp),cp=Bm();class lp{constructor({pb:t=null,width:n=1280,height:i=720,numSources:u=4,numOutputs:o=4,makeGlobal:c=!0,autoLoop:g=!0,detectAudio:S=!0,enableStreamCapture:b=!0,canvas:G,precision:k,extendTransforms:R={}}={}){if(Ts.init(),this.pb=t,this.width=n,this.height=i,this.renderAll=!1,this.detectAudio=S,this._initCanvas(G),this.synth={time:0,bpm:30,width:this.width,height:this.height,fps:void 0,stats:{fps:0},speed:1,mouse:cp,render:this._render.bind(this),setResolution:this.setResolution.bind(this),update:O=>{},hush:this.hush.bind(this),tick:this.tick.bind(this)},c&&(window.loadScript=this.loadScript),this.timeSinceLastUpdate=0,this._time=0,k&&["lowp","mediump","highp"].includes(k.toLowerCase()))this.precision=k.toLowerCase();else{let O=(/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1)&&!window.MSStream;this.precision=O?"highp":"mediump"}if(this.extendTransforms=R,this.saveFrame=!1,this.captureStream=null,this.generator=void 0,this._initRegl(),this._initOutputs(o),this._initSources(u),this._generateGlslTransforms(),this.synth.screencap=()=>{this.saveFrame=!0},b)try{this.captureStream=this.canvas.captureStream(25),this.synth.vidRecorder=new Wm(this.captureStream)}catch(O){console.warn(`[hydra-synth warning]
new MediaSource() is not currently supported on iOS.`),console.error(O)}S&&this._initAudio(),g&&Om(this.tick.bind(this)).start(),this.sandbox=new Qm(this.synth,c,["speed","update","bpm","fps"])}eval(t){this.sandbox.eval(t)}getScreenImage(t){this.imageCallback=t,this.saveFrame=!0}hush(){this.s.forEach(t=>{t.clear()}),this.o.forEach(t=>{this.synth.solid(0,0,0,0).out(t)}),this.synth.render(this.o[0]),this.sandbox.set("update",t=>{})}loadScript(t=""){return new Promise((i,u)=>{var o=document.createElement("script");o.onload=function(){console.log(`loaded script ${t}`),i()},o.onerror=c=>{console.log(`error loading script ${t}`,"log-error"),i()},o.src=t,document.head.appendChild(o)})}setResolution(t,n){this.canvas.width=t,this.canvas.height=n,this.width=t,this.height=n,this.sandbox.set("width",t),this.sandbox.set("height",n),console.log(this.width),this.o.forEach(i=>{i.resize(t,n)}),this.s.forEach(i=>{i.resize(t,n)}),this.regl._refresh(),console.log(this.canvas.width)}canvasToImage(t){const n=document.createElement("a");n.style.display="none";let i=new Date;n.download=`hydra-${i.getFullYear()}-${i.getMonth()+1}-${i.getDate()}-${i.getHours()}.${i.getMinutes()}.${i.getSeconds()}.png`,document.body.appendChild(n);var u=this;this.canvas.toBlob(o=>{u.imageCallback?(u.imageCallback(o),delete u.imageCallback):(n.href=URL.createObjectURL(o),console.log(n.href),n.click())},"image/png"),setTimeout(()=>{document.body.removeChild(n),window.URL.revokeObjectURL(n.href)},300)}_initAudio(){this.synth.a=new Xm({numBins:4,parentEl:this.canvas.parentNode})}_initCanvas(t){t?(this.canvas=t,this.width=t.width,this.height=t.height):(this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.imageRendering="pixelated",document.body.appendChild(this.canvas))}_initRegl(){this.regl=dp({canvas:this.canvas,pixelRatio:1}),this.regl.clear({color:[0,0,0,1]}),this.renderAll=this.regl({frag:`
      precision ${this.precision} float;
      varying vec2 uv;
      uniform sampler2D tex0;
      uniform sampler2D tex1;
      uniform sampler2D tex2;
      uniform sampler2D tex3;

      void main () {
        vec2 st = vec2(1.0 - uv.x, uv.y);
        st*= vec2(2);
        vec2 q = floor(st).xy*(vec2(2.0, 1.0));
        int quad = int(q.x) + int(q.y);
        st.x += step(1., mod(st.y,2.0));
        st.y += step(1., mod(st.x,2.0));
        st = fract(st);
        if(quad==0){
          gl_FragColor = texture2D(tex0, st);
        } else if(quad==1){
          gl_FragColor = texture2D(tex1, st);
        } else if (quad==2){
          gl_FragColor = texture2D(tex2, st);
        } else {
          gl_FragColor = texture2D(tex3, st);
        }

      }
      `,vert:`
      precision ${this.precision} float;
      attribute vec2 position;
      varying vec2 uv;

      void main () {
        uv = position;
        gl_Position = vec4(1.0 - 2.0 * position, 0, 1);
      }`,attributes:{position:[[-2,0],[0,-2],[2,2]]},uniforms:{tex0:this.regl.prop("tex0"),tex1:this.regl.prop("tex1"),tex2:this.regl.prop("tex2"),tex3:this.regl.prop("tex3")},count:3,depth:{enable:!1}}),this.renderFbo=this.regl({frag:`
      precision ${this.precision} float;
      varying vec2 uv;
      uniform vec2 resolution;
      uniform sampler2D tex0;

      void main () {
        gl_FragColor = texture2D(tex0, vec2(1.0 - uv.x, uv.y));
      }
      `,vert:`
      precision ${this.precision} float;
      attribute vec2 position;
      varying vec2 uv;

      void main () {
        uv = position;
        gl_Position = vec4(1.0 - 2.0 * position, 0, 1);
      }`,attributes:{position:[[-2,0],[0,-2],[2,2]]},uniforms:{tex0:this.regl.prop("tex0"),resolution:this.regl.prop("resolution")},count:3,depth:{enable:!1}})}_initOutputs(t){const n=this;this.o=Array(t).fill().map((i,u)=>{var o=new Er({regl:this.regl,width:this.width,height:this.height,precision:this.precision,label:`o${u}`});return o.id=u,n.synth["o"+u]=o,o}),this.output=this.o[0]}_initSources(t){this.s=[];for(var n=0;n<t;n++)this.createSource(n)}createSource(t){let n=new km({regl:this.regl,pb:this.pb,width:this.width,height:this.height,label:`s${t}`});return this.synth["s"+this.s.length]=n,this.s.push(n),n}_generateGlslTransforms(){var t=this;this.generator=new ap({defaultOutput:this.o[0],defaultUniforms:this.o[0].uniforms,extendTransforms:this.extendTransforms,changeListener:({type:n,method:i,synth:u})=>{n==="add"&&(t.synth[i]=u.generators[i],t.sandbox&&t.sandbox.add(i))}}),this.synth.setFunction=this.generator.setFunction.bind(this.generator)}_render(t){t?(this.output=t,this.isRenderingAll=!1):this.isRenderingAll=!0}tick(t,n){if(this.sandbox.tick(),this.detectAudio===!0&&this.synth.a.tick(),this.sandbox.set("time",this.synth.time+=t*.001*this.synth.speed),this.timeSinceLastUpdate+=t,!this.synth.fps||this.timeSinceLastUpdate>=1e3/this.synth.fps){if(this.synth.stats.fps=Math.ceil(1e3/this.timeSinceLastUpdate),this.synth.update)try{this.synth.update(this.timeSinceLastUpdate)}catch(i){console.log(i)}for(let i=0;i<this.s.length;i++)this.s[i].tick(this.synth.time);for(let i=0;i<this.o.length;i++)this.o[i].tick({time:this.synth.time,mouse:this.synth.mouse,bpm:this.synth.bpm,resolution:[this.canvas.width,this.canvas.height]});this.isRenderingAll?this.renderAll({tex0:this.o[0].getCurrent(),tex1:this.o[1].getCurrent(),tex2:this.o[2].getCurrent(),tex3:this.o[3].getCurrent(),resolution:[this.canvas.width,this.canvas.height]}):this.renderFbo({tex0:this.output.getCurrent(),resolution:[this.canvas.width,this.canvas.height]}),this.timeSinceLastUpdate=0}this.saveFrame===!0&&(this.canvasToImage(),this.saveFrame=!1)}}const hp=ws`
position: absolute;
top: 0px;
left: 0px;
width: 100%;
height: 100%;
canvas {
  width: 100%;
  height: 100%;
}
`;class mp extends xm{constructor(t,n,i){super(t),this.local=n.components[t]={},this.state=n}load(t){console.log("loading hydra",t,this.canvas);const n=t.querySelector("canvas");n.width=window.innerWidth,n.height=window.innerHeight,this.state.hydra==null&&(this.state.hydra=new lp({canvas:n,detectAudio:!1,width:n.width,height:n.height}))}update(){return!1}createElement(t){return _t`
      <div class="hydra-holder ${hp}">
        <canvas class="hydra-canvas"></canvas>
      </div>
    `}}const jr=300,zr=10,pp=ws`
display: flex;
flex-direction: row;
flex-wrap: nowrap;
justify-content: center;
align-items: center;
align-content: center;
padding: 10px;
img.emoji {
  width: 20px;
  height: 20px;
  margin-right: 5px;
}
.windows {
  // display: flex;
  // flex-direction: row;
  // flex-wrap: wrap;
  // justify-content: flex-start;
  // align-items: baseline;
  // align-content: flex-start;
  @media only screen and (min-width: ${(jr+zr)*2.2}px) {
    -moz-column-count: 2;
    -webkit-column-count: 2;
    column-count: 2;
  }

  @media only screen and (min-width: ${(jr+zr)*3.3}px) {
    -moz-column-count: 3;
    -webkit-column-count: 3;
    column-count: 3;
  }

  @media only screen and (min-width: ${(jr+zr)*4.4}px) {
    -moz-column-count: 4;
    -webkit-column-count: 4;
    column-count: 4;
  }

  @media only screen and (min-width: ${(jr+zr)*5.5}px) {
    -moz-column-count: 5;
    -webkit-column-count: 5;
    column-count: 5;
  }
}
img {
  width: 100%;
}
.title-bar-text {
  .icon {
    width: 20px;
    height: 20px;
    margin-right: 5px;
  }
  display: flex;
	flex-direction: row;
	flex-wrap: nowrap;
	justify-content: flex-start;
	align-items: center;
	align-content: stretch;
  text-overflow: ellipsis;
  overflow: hidden;
  white-space: nowrap;
  padding: 0;
}
.window {
  page-break-inside: avoid;
  margin: ${zr}px;
  width: ${jr}px;
  font-size: 10pt;
  box-sizing: border-box;

	display: flex;
	flex-direction: column;
	flex-wrap: nowrap;
	justify-content: space-between;
	align-items: stretch;
	align-content: stretch;
}
.window-wrap.full {
  position: fixed;
  left: 0;
  top: 0;
  width: 100%;
  height: 100vh;
  margin: 0;
  padding: 0;
  overflow-y: scroll;

	display: flex;
	flex-direction: row;
	flex-wrap: nowrap;
	justify-content: center;
	align-items: center;
	align-content: stretch;
  .window.full {
    position: relative;
    width: 100%;
    max-width: 1024px;
    // height: 100%;
    margin: 0;
    overflow-y: scroll;
    .window-body {
      img {
        max-width: 50%;
      }
      @media only screen and (max-width: 600px) {
        display: inherit;
        img {
          max-width: 100%;
        }
      }
      display: flex;
      flex-direction: column;
      flex-wrap: nowrap;
      justify-content: flex-start;
      align-items: center;
      align-content: stretch;
    }
  }
}
.hydra-holder {
  z-index: -1;
  width: 100%;
  height: 100%;
  position: fixed;
}
.no-display {
  display: none;
}
.status-bar-field.progress {
  display: flex;
	flex-direction: row;
	flex-wrap: nowrap;
	justify-content: center;
	align-items: stretch;
	align-content: stretch;
}
.status-bar-field.year {
  text-align: right;
}
`;class vp{constructor(t){this.params=t,this.minimized=!1;//!!params.featured === false;
this.maximized=!1}toggleMinimize(){this.maximized?(this.minimized=!1,this.maximized=!1):(this.minimized=!this.minimized,this.maximized=!1)}toggleMaximize(){this.maximized=!this.maximized,this.minimized=!1}html(t,n){const i=o=>{this.toggleMinimize(),n("render")},u=o=>{this.toggleMaximize(),n("render")};return _t`
    <div class="window-wrap">
      <div class="window">
        <div class="title-bar">
          <div class="title-bar-text">
            ${this.params.icon?_t`
            <img class="icon" src="${this.params.icon}" />
            `:""}
            ${ls(Es.parse(this.params.title?this.params.title:""))}
          </div>
          <div class="title-bar-controls">
            <!-- <button aria-label="Minimize" onclick=${i}></button> -->
            <button aria-label="Maximize" onclick=${u}></button>
            <button aria-label="Close" class="no-display"></button>
          </div>
        </div>
        <div class="window-body ${this.minimized?"no-display":""}">
          ${this.params.img?_t`<img onclick=${u} alt="${this.alt}" src="${this.params.img}" />`:""}
          ${this.params.text&&(this.maximized||this.params.img==null)?_t`<div>${this.params.text}</div>`:""}
        </div>
        <div class="status-bar">
          <div class="status-bar-field">
            ${this.params.media}
          </div>
          ${this.params.progress?_t`
          <div class="status-bar-field progress">
            <progress></progress>
          </div>`:""}
          <div class="status-bar-field year">
            ${this.params.year}
          </div>
        </div>
      </div>
    </div>
    `}}const bp=[{featured:!1,img:"/img/underconstruction.gif",title:"ð§#UnderConstruction",alt:"under construction 90s banner",media:"GIF",progress:1,year:"2023-",text:_t`
    <div>
      <div>
        The website is currently (and forever) underconstruction. Finally it is upgraded to "XP". But you can find the old "98" version <a href="/2022">here</a> (its contents will not be updated, though).
      </div>
      <div>
        GIF taken from
        <a href="http://www.textfiles.com/underconstruction/" target="_blank">here</a> (beware - many images)
      </div>
    </div>`},{featured:!0,img:"https://img.glitches.me/images/2023/07/26/naoto-new-banner.jpg",title:"New Banner",alt:"banner of closeup of naoto's face displayed outside",icon:"/img/favicon-32-banner.png",media:"Banner",year:"2023",text:_t`
    <div>
      <div>
      <a target="_blank" href="https://new-banner.glitch.me/">New banner</a>
      </div>
      <div>
        First shown at KHM Rundgang 2023, then at Kunstpreis 2024 der Freunde der KHM exhibition.
      </div>
    </div>`},{featured:!0,img:"https://img.glitches.me/images/2023/07/26/cards_sq.jpg",title:"Naoto's Cards",alt:"naoto's cards displayed",icon:"/favicon-32.png",media:"Printed cards",year:"2022-",text:_t`
    <div>
      <div>
        My cards, spawned from the autobiographical project
        <a href="https://soup.glitches.me"
        target="_blank">
        soup.glitches.me</a>.
      </div>
      <div>
        Exhibited at
        <a href="https://www.interposed.de/"
        target="_blank">
        interposed</a> in October 2023, accompanied by
        <a href="https://re-coding.technology/heartbreak-cards/"
          target="_blank">
        a web publication</a>.
        Then at Kunstpreis 2024 der Freunde der KHM exhibition.
      </div>

      </div>
    </div>`},{featured:!1,img:"/J.GUEVARA-N.%20HIEDA-MODINA_urska%20boljkovac%20(72).jpeg",alt:"naoto and jorge on the stage performing in front of a green screen and a projection surface",title:"SFDCANBAC++",icon:"/img/favicon-32-bp.png",media:"Media dance",year:"2024",text:_t`
    <div>
      <p>Currently on tour: <a href="https://cndb.ro/new_events/stage-for-digital-contagious-and-networked-bodies-and-code-sfdcanbac/" target="_blank">CNDB</a> & <a href="https://www.kinosiska.si/en/dogodek/cofestival-2024/" target="_blank">Kino Å iÅ¡ka</a></p>
      <p> Bodies, colorful objects, live-codes and glitter pixels continuously change their constellations on the stage â superimposing and subtracting, grouping and ungrouping â while the abundance of âactorsâ never arrives to a specific form.</p>
      <p> Artists: Jorge Guevara and Naoto Hieda</p>
      <p> Technical Mentorship and development: Andreia Matos, William Primett and Nuno N. Correia</p>
      <p> Tech support: Kino Å iÅ¡ka</p>
      <p>
      Photo: UrÅ¡ka Boljkovac/Kino Å iÅ¡ka
      </p>
      <p> The work is created within the framework of the <a href="https://modina.eu/projects/sfdcanbac/" target="_blank">MODINA</a> project.</p>
      <p>Try the interactive version <a href="https://sfdcanbac-ux.glitch.me/" target="_blank">here</a>!</p>
    </div>`},{featured:!0,title:"ð®Who is Naoto?",alt:"under construction 90s banner",media:"Quote",year:"2024",text:_t`
    <div>
      <blockquote>
Who is Naoto Hieda? Seems to me, is the essential, existential question that Naoto ask themself in every new artistic endeavor they engage into.
      </blockquote>
      <blockquote>
- Camilo Sandoval
      </blockquote>
    </div>`},{featured:!1,img:"https://img.glitches.me/images/2022/02/13/banner.jpg",title:"#NaotoHieda",alt:"hashtag naoto hieda, an artwork of a printed banner",icon:"/img/favicon-32-nh.png",media:"Banner",year:"2022",text:_t`
    <div>
      <div>
        <p>
          #NaotoHieda is an artwork around a computer program and a body. A screenshot of a performance using the artistâs body and a custom-made web editor for live-coding is printed as a 12-meter-wide construction banner, exhibited at Pola Museum Annex in Tokyo, Japan.
        </p>
        <p>
          Details can be found <a href="https://naotohieda.glitch.me/" target="_blank">naotohieda.glitch.me</a> as well as on <a href="https://www.creativeapplications.net/member-submissions/naotohieda-live-coding-on-a-construction-banner/" target="_blank">CreativeApplications.Net</a>.
        </p>
      </div>
    </div>`},{featured:!1,img:"https://img.glitches.me/images/2023/07/26/20230722_KHM_RundgangDSC_0739_c_Doerthe_Boxberg_sq.jpg",title:"Naoto's Nail Salon",icon:"/img/favicon-32-nail.png",media:"Performance",year:"2022-2023",text:_t`
    <div>
      <p>
      Photo: DÃ¶rthe Boxberg
      </p>
      <p>
        <a href="https://nail.glitches.me" target="_blank">Naoto's nail salon log</a>
      </p>
      <p>
        Naotoâs Nail Salon is a nail salon by Naoto. Everyone is invited to have nails done for free. It was founded on 28th September 2022 at the National University of Colombia, BogotÃ¡ during a writing seminar as a response to a topic around hands.
      </p>
    </div>`},{featured:!1,img:"53378405309_445f9d96f6_o.jpg",alt:"media installation with construction fences, prints and projections",title:"Code, Remix, Break & Glitch",icon:"favicon-32-dw.png",media:"Workshop, Exhibition",year:"2023",text:_t`
    <div>
      <p>
      Youth workshop by Naoto Hieda & Franka Osthoff took place at <a href="https://www.digitale-welten.org" target="_blank">Digitale Welten 2023</a>
      </p>
      <p>
      Photo: Lenz aka. Eray Aydin
      </p>
    </div>`},{featured:!1,img:"https://bild.glitches.me/images/2023/03/09/_DSC1986fa8b502b7cfb68e8.jpg",alt:"people sitting around and cutting vegetables",title:"Naoto's Festival",icon:"/img/favicon-32-festival.png",media:"Exhibition, Performance",year:"2023",text:_t`
    <div>
      <p>
        <a href="https://festival.naotohieda.com/" target="_blank">festival.naotohieda.com</a><br />
        Photo by Andrea Gamboa (IG <a href="https://instagram.com/acciondevista" target="_blank">@acciondevista</a>)
      </p>
    </div>`},{featured:!1,img:"/thesis.jpg",title:"ðNeuroqueerness and Decolonization in Media art",alt:"tbd",media:"Publication",year:"2023",text:_t`
    <div>
      <div>
        <a href="https://docs.google.com/document/d/1q2okYdz25a3lfPT4wGKN_CO2bsBR0cZN8vF8MpYPuZ0/edit?usp=sharing">read on google docs</a>
      </div>
    </div>`},{featured:!1,img:"https://bild.glitches.me/images/2022/09/24/naoto_spektrum.gif",alt:"video screened in a station",title:"ð#spektrum",media:"Video",year:"2021",text:_t`
    <div>
      <p>
        10 sec video screened at Cologne Main Station as part of ctrl-space by Christian Sievers
      </p>
      <p>
        #spektrum is a convolution of identity questions that we face, including, but not only, the gender spectrum and autism spectrum. The fingers as an analog, imperfect medium with a color spectrum of nail polish count binary numbers mimicking a self-stimulatory behavior (stimming) to provoke and to challenge the stigma of "binariness" of autism.
      </p>
    </div>`},{featured:!1,title:"ð¼Portfolio",media:"Net art",year:"2014-",text:_t`
    <div>
      You can find a complete list of my work in my <a href="https://naoto-portfolio.glitches.me/">portfolio</a>.
    </div>`},{featured:!0,title:"ð¥Credits",media:"Net art",year:"2025",text:_t`
    <div>
      <div class="center-text">
        <span class="naoto">Naoto Hieda - full stack net artist</span>
      </div>
      <div class="center-text">
        design by <a href="https://glitches.me" target="_blank">glitches.me</a>
      </div>
      <div>
      Emojis from <a href="https://www.npmjs.com/package/@discordapp/twemoji" target="_blank">@discord/twemoji</a>.
      </div>
    </div>`}].map(e=>new vp(e));function yp(e,t){return _t`
    <div class=${pp}>
      <div class="windows">
        <div class="window" style="margin: 0 ${zr}px; width: ${jr}px">
          <div class="title-bar">
            <div class="title-bar-text">
              ${ls(Es.parse("ð"))}Hi!
            </div>
          </div>
          <div class="window-body">
            Welcome to Naoto's homepage! Press image or maximize button on the top right of each window for more information.

          </div>
        </div>
        ${bp.map(n=>n.html(e,t))}
      </div>
      ${e.cache(mp,"my-hydra").render(e,t)}
    </div>
  `}const fa=ch({hash:!0,href:!1});fa.use(Th);fa.route("/*",gp);function gp(){return _t`
    <div>
      <a href="/"> 404 with love â¤ back to top! </a>
    </div>
  `}fa.route("/",yp);fa.mount("#choomount");
